<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Discover mutational signatures — discover_signatures • musicatk</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Discover mutational signatures — discover_signatures"><meta name="description" content='Mutational signatures and exposures will be discovered using
methods such as Latent Dirichlet Allocation (lda) or Non-Negative
Matrix Factorization (nmf). These algorithms will deconvolute a matrix of
counts for mutation types in each sample to two matrices: 1) a "signature"
matrix containing the probability of each mutation type in each sample and
2) an "exposure" matrix containing the estimated counts for each signature
in each sample. Before mutational discovery can be performed, samples first
need to be stored in a musica object using the
create_musica_from_variants or create_musica_from_counts
function and mutation count tables need to be created using functions such as
build_standard_table if create_musica_from_counts was not used.'><meta property="og:description" content='Mutational signatures and exposures will be discovered using
methods such as Latent Dirichlet Allocation (lda) or Non-Negative
Matrix Factorization (nmf). These algorithms will deconvolute a matrix of
counts for mutation types in each sample to two matrices: 1) a "signature"
matrix containing the probability of each mutation type in each sample and
2) an "exposure" matrix containing the estimated counts for each signature
in each sample. Before mutational discovery can be performed, samples first
need to be stored in a musica object using the
create_musica_from_variants or create_musica_from_counts
function and mutation count tables need to be created using functions such as
build_standard_table if create_musica_from_counts was not used.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">musicatk</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="https://www.camplab.net/musicatk" aria-label="Home"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/installation.html">Installation</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/tutorial_tcga_cnsl.html">Analysis in the R console</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_tcga_ui.html">Analysis with the user interface</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/campbio/musicatk" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/camplab1" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Discover mutational signatures</h1>
      <small class="dont-index">Source: <a href="https://github.com/campbio/musicatk/blob/HEAD/R/discovery_prediction.R" class="external-link"><code>R/discovery_prediction.R</code></a></small>
      <div class="d-none name"><code>discover_signatures.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Mutational signatures and exposures will be discovered using
methods such as Latent Dirichlet Allocation (lda) or Non-Negative
Matrix Factorization (nmf). These algorithms will deconvolute a matrix of
counts for mutation types in each sample to two matrices: 1) a "signature"
matrix containing the probability of each mutation type in each sample and
2) an "exposure" matrix containing the estimated counts for each signature
in each sample. Before mutational discovery can be performed, samples first
need to be stored in a <code><a href="musica-class.html">musica</a></code> object using the
<a href="create_musica_from_variants.html">create_musica_from_variants</a> or <a href="create_musica_from_counts.html">create_musica_from_counts</a>
function and mutation count tables need to be created using functions such as
<a href="build_standard_table.html">build_standard_table</a> if <a href="create_musica_from_counts.html">create_musica_from_counts</a> was not used.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">discover_signatures</span><span class="op">(</span></span>
<span>  <span class="va">musica</span>,</span>
<span>  <span class="va">modality</span>,</span>
<span>  <span class="va">num_signatures</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"lda"</span>,</span>
<span>  result_name <span class="op">=</span> <span class="st">"result"</span>,</span>
<span>  model_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nstart <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  par_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  make_copy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  table_name <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-musica">musica<a class="anchor" aria-label="anchor" href="#arg-musica"></a></dt>
<dd><p>A <code><a href="musica-class.html">musica</a></code> object.</p></dd>


<dt id="arg-modality">modality<a class="anchor" aria-label="anchor" href="#arg-modality"></a></dt>
<dd><p>Modality to use for signature discovery. Needs
to be the same name supplied to the table building functions such as
<a href="build_standard_table.html">build_standard_table</a>.</p></dd>


<dt id="arg-num-signatures">num_signatures<a class="anchor" aria-label="anchor" href="#arg-num-signatures"></a></dt>
<dd><p>Number of signatures to discover.</p></dd>


<dt id="arg-algorithm">algorithm<a class="anchor" aria-label="anchor" href="#arg-algorithm"></a></dt>
<dd><p>Method to use for mutational signature discovery. One of
<code>"lda"</code> or <code>"nmf"</code>. Default <code>"lda"</code>.</p></dd>


<dt id="arg-result-name">result_name<a class="anchor" aria-label="anchor" href="#arg-result-name"></a></dt>
<dd><p>Name for result_list entry to save the results to. Default
<code>"result"</code>.</p></dd>


<dt id="arg-model-id">model_id<a class="anchor" aria-label="anchor" href="#arg-model-id"></a></dt>
<dd><p>Identifier for the result. If <code>NULL</code>, will be
automatically set to the algorithm and number of signatures. Default
<code>NULL</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Seed to be used for the random number generators in the
signature discovery algorithms. Default <code>1</code>.</p></dd>


<dt id="arg-nstart">nstart<a class="anchor" aria-label="anchor" href="#arg-nstart"></a></dt>
<dd><p>Number of independent random starts used in the mutational
signature algorithms. Default <code>10</code>.</p></dd>


<dt id="arg-par-cores">par_cores<a class="anchor" aria-label="anchor" href="#arg-par-cores"></a></dt>
<dd><p>Number of parallel cores to use. Only used if
<code>method = "nmf"</code>. Default <code>1</code>.</p></dd>


<dt id="arg-make-copy">make_copy<a class="anchor" aria-label="anchor" href="#arg-make-copy"></a></dt>
<dd><p>If <code>FALSE</code>, the inputted <code><a href="musica-class.html">musica</a></code>
object is updated and nothing is returned. If <code>TRUE</code>, a new
<code><a href="musica-class.html">musica</a></code> object is created and returned. Default
<code>FALSE</code>.</p></dd>


<dt id="arg-table-name">table_name<a class="anchor" aria-label="anchor" href="#arg-table-name"></a></dt>
<dd><p>Use modality instead</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns nothing or a new <code><a href="musica-class.html">musica</a></code> object,
depending on the <code>make_copy</code> parameter.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">musica</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="select_genome.html">select_genome</a></span><span class="op">(</span><span class="st">"19"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="build_standard_table.html">build_standard_table</a></span><span class="op">(</span><span class="va">musica</span>, <span class="va">g</span>, <span class="st">"SBS96"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Building count table from SBS with SBS96 schema</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Overwriting counts table: SBS96</span>
<span class="r-in"><span><span class="fu">discover_signatures</span><span class="op">(</span></span></span>
<span class="r-in"><span>  musica <span class="op">=</span> <span class="va">musica</span>, modality <span class="op">=</span> <span class="st">"SBS96"</span>,</span></span>
<span class="r-in"><span>  num_signatures <span class="op">=</span> <span class="fl">3</span>, algorithm <span class="op">=</span> <span class="st">"lda"</span>, seed <span class="op">=</span> <span class="fl">12345</span>, nstart <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aaron Chevalier, Natasha Gurevich, Tao Guo, Joshua D. Campbell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

