<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Display sample exposures with bar, box, or violin plots — plot_exposures • musicatk</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Display sample exposures with bar, box, or violin plots — plot_exposures"><meta name="description" content="The distributions of mutational signatures can be viewed
with barplots or box/violin plots. Barplots are most useful for viewing
the proportion of signatures within and across samples. The box/violin plots
are most useful for viewing the distributions of signatures with respect to
sample annotations. Samples can be grouped using the group_by
parameter. For barplots, various methods of sorting samples from left
to right can be chosen using the sort_samples parameter."><meta property="og:description" content="The distributions of mutational signatures can be viewed
with barplots or box/violin plots. Barplots are most useful for viewing
the proportion of signatures within and across samples. The box/violin plots
are most useful for viewing the distributions of signatures with respect to
sample annotations. Samples can be grouped using the group_by
parameter. For barplots, various methods of sorting samples from left
to right can be chosen using the sort_samples parameter."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">musicatk</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="https://www.camplab.net/musicatk" aria-label="Home"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/articles/installation.html">Installation</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/articles/tutorial_tcga_cnsl.html">Analysis in the R console</a></li>
    <li><a class="dropdown-item" href="../articles/articles/tutorial_tcga_ui.html">Analysis with the user interface</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/campbio/musicatk" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/camplab1" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Display sample exposures with bar, box, or violin plots</h1>
      <small class="dont-index">Source: <a href="https://github.com/campbio/musicatk/blob/HEAD/R/plot_exposures.R" class="external-link"><code>R/plot_exposures.R</code></a></small>
      <div class="d-none name"><code>plot_exposures.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The distributions of mutational signatures can be viewed
with barplots or box/violin plots. Barplots are most useful for viewing
the proportion of signatures within and across samples. The box/violin plots
are most useful for viewing the distributions of signatures with respect to
sample annotations. Samples can be grouped using the <code>group_by</code>
parameter. For barplots, various methods of sorting samples from left
to right can be chosen using the <code>sort_samples</code> parameter.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_exposures</span><span class="op">(</span></span>
<span>  <span class="va">musica</span>,</span>
<span>  <span class="va">model_name</span>,</span>
<span>  modality <span class="op">=</span> <span class="st">"SBS96"</span>,</span>
<span>  result_name <span class="op">=</span> <span class="st">"result"</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bar"</span>, <span class="st">"box"</span>, <span class="st">"violin"</span><span class="op">)</span>,</span>
<span>  proportional <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group_by <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  color_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"signature"</span>, <span class="st">"annotation"</span><span class="op">)</span>,</span>
<span>  annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num_samples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sort_samples <span class="op">=</span> <span class="st">"total"</span>,</span>
<span>  threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  same_scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add_points <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  point_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  label_x_axis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plotly <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-musica">musica<a class="anchor" aria-label="anchor" href="#arg-musica"></a></dt>
<dd><p>A <code><a href="musica-class.html">musica</a></code> object containing a mutational
discovery or prediction.</p></dd>


<dt id="arg-model-name">model_name<a class="anchor" aria-label="anchor" href="#arg-model-name"></a></dt>
<dd><p>The name of the desired model.</p></dd>


<dt id="arg-modality">modality<a class="anchor" aria-label="anchor" href="#arg-modality"></a></dt>
<dd><p>The modality of the model. Must be "SBS96", "DBS78", or
"IND83". Default <code>"SBS96"</code>.</p></dd>


<dt id="arg-result-name">result_name<a class="anchor" aria-label="anchor" href="#arg-result-name"></a></dt>
<dd><p>Name of the result list entry containing desired model.
Default <code>"result"</code>.</p></dd>


<dt id="arg-plot-type">plot_type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>One of <code>"bar"</code>, <code>"box"</code>, or <code>"violin"</code>.
Default <code>"bar"</code>.</p></dd>


<dt id="arg-proportional">proportional<a class="anchor" aria-label="anchor" href="#arg-proportional"></a></dt>
<dd><p>If <code>TRUE</code>, then the exposures will be normalized
to between 0 and 1 by dividing by the total number of counts for each sample.
Default <code>FALSE</code>.</p></dd>


<dt id="arg-group-by">group_by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>Determines how to group samples into the subplots
(i.e. facets). One of <code>"none"</code>, <code>"signature"</code> or
<code>"annotation"</code>. If set to <code>"annotation"</code>,
then a sample annotation must be supplied via the
<code>annotation</code> parameter. Default <code>"none"</code>.</p></dd>


<dt id="arg-color-by">color_by<a class="anchor" aria-label="anchor" href="#arg-color-by"></a></dt>
<dd><p>Determines how to color the bars or box/violins. One of
<code>"signature"</code> or <code>"annotation"</code>. If set to <code>"annotation"</code>,
then a sample annotation must be supplied via the
<code>annotation</code> parameter. Default <code>"signature"</code>.</p></dd>


<dt id="arg-annotation">annotation<a class="anchor" aria-label="anchor" href="#arg-annotation"></a></dt>
<dd><p>Sample annotation used to group the subplots and/or
color the bars, boxes, or violins. Default <code>NULL</code>.</p></dd>


<dt id="arg-num-samples">num_samples<a class="anchor" aria-label="anchor" href="#arg-num-samples"></a></dt>
<dd><p>The top number of sorted samples to display. If
<code>NULL</code>, then all samples will be displayed. If <code>group_by</code> is set,
then the top samples will be shown within each group. Default <code>NULL</code>.</p></dd>


<dt id="arg-sort-samples">sort_samples<a class="anchor" aria-label="anchor" href="#arg-sort-samples"></a></dt>
<dd><p>This is used to change how samples are sorted in
the barplot from left to right. If set to <code>"total"</code>, then samples
will be sorted from those with the highest number of mutation counts to the
lowest (regardless of how the parameter <code>"proportional"</code> is set).
If set to <code>"name"</code>, then samples are sorted by their name with the
<code><a href="https://rdrr.io/pkg/gtools/man/mixedsort.html" class="external-link">mixedsort</a></code> function. If set to
one or more signature names (e.g. <code>"Signature1"</code>), then samples will
be sorted from those with the highest level of that signature to the lowest.
If multiple signatures are supplied then, samples will be sorted by each
signature sequentially. Default <code>"total"</code>.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>Exposures less than this threshold will be set to 0.
This is most useful when more than one signature is supplied to
<code>sort_samples</code> as samples that are set to zero for the first exposure
will then be sorted by the levels of the second exposure.
Default <code>NULL</code>.</p></dd>


<dt id="arg-same-scale">same_scale<a class="anchor" aria-label="anchor" href="#arg-same-scale"></a></dt>
<dd><p>If <code>TRUE</code>, then all subplots will have the
same scale. Only used when <code>group_by</code> is set. Default <code>FALSE</code>.</p></dd>


<dt id="arg-add-points">add_points<a class="anchor" aria-label="anchor" href="#arg-add-points"></a></dt>
<dd><p>If <code>TRUE</code>, then points for individual sample
exposures will be plotted on top of the violin/box plots. Only used when
<code>plot_type</code> is set to <code>"violin"</code> or <code>"box"</code>.
Default <code>TRUE</code>.</p></dd>


<dt id="arg-point-size">point_size<a class="anchor" aria-label="anchor" href="#arg-point-size"></a></dt>
<dd><p>Size of the points to be plotted on top of the
violin/box plots. Only used when <code>plot_type</code> is set to <code>"violin"</code>
or <code>"box"</code> and <code>add_points</code> is set to <code>TRUE</code>.
Default <code>2</code>.</p></dd>


<dt id="arg-label-x-axis">label_x_axis<a class="anchor" aria-label="anchor" href="#arg-label-x-axis"></a></dt>
<dd><p>If <code>TRUE</code>, x-axis labels will be displayed at
the bottom of the plot. Default <code>FALSE</code>.</p></dd>


<dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p>If <code>TRUE</code>, the legend will be displayed.
Default <code>TRUE</code>.</p></dd>


<dt id="arg-plotly">plotly<a class="anchor" aria-label="anchor" href="#arg-plotly"></a></dt>
<dd><p>If <code>TRUE</code>, the the plot will be made interactive
using <code><a href="https://rdrr.io/pkg/plotly/man/plotly.html" class="external-link">plotly</a></code>. Default <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Generates a ggplot or plotly object</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">res_annot</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_exposures</span><span class="op">(</span><span class="va">res_annot</span>,</span></span>
<span class="r-in"><span>  model_name <span class="op">=</span> <span class="st">"res_annot"</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span>,</span></span>
<span class="r-in"><span>  annotation <span class="op">=</span> <span class="st">"Tumor_Subtypes"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_exposures-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aaron Chevalier, Natasha Gurevich, Tao Guo, Joshua D. Campbell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

