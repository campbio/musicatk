[{"path":"https://www.camplab.net/musicatk/articles/installation.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"","text":"Mutational signatures carcinogenic exposures aberrant cellular processes can cause alterations genome. created musicatk (MUtational SIgnature Comprehensive Analysis ToolKit) address shortcomings versatility ease use pre-existing computational tools. Although many different types mutational data generated, current software packages flexible framework allow users mix match different types mutations mutational signature inference process. Musicatk enables users count combine multiple mutation types, including SBS, DBS, indels. Musicatk calculates replication strand, transcription strand combinations features along discovery unique proprietary genomic feature associated mutation type. Musicatk also implements several methods discovery new signatures well methods infer exposure given existing set signatures. Musicatk provides functions visualization downstream exploratory analysis including ability compare signatures cohorts find matching signatures COSMIC V2 COSMIC V3.","code":""},{"path":"https://www.camplab.net/musicatk/articles/installation.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"","text":"install latest stable release musicatk Bioconductor: latest stable version musicatk can installed GitHub using devtools: development version musicatk can also installed GitHub using devtools:","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE)) {   install.packages(\"BiocManager\") } BiocManager::install(\"musicatk\") library(devtools) install_github(\"campbio/musicatk\") library(devtools) install_github(\"campbio/musicatk@devel\")"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"vignettes","dir":"Articles","previous_headings":"","what":"Vignettes","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"Due range features available musicatk, prepared several vignettes help get started, available https://www.camplab.net/musicatk/ #Introduction variety exogenous exposures endogenous biological processes can contribute overall mutational load observed human tumors. Many different mutational patterns, “mutational signatures”, identified across different tumor types. signatures can provide record environmental exposure can give clues etiology carcinogenesis. Mutational Signature Comprehensive Analysis Toolkit (musicatk) utilities extracting variants variety file formats, contains multiple methods discovery novel signatures prediction known signatures, well many types downstream visualizations exploratory analysis. package ability parse combine multiple motif classes mutational signature discovery prediction processes. Mutation motifs include single base substitutions (SBS), double base substitutions (DBS), insertions (INS) deletions (DEL).","code":""},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"Currently musicatk can installed Bioconductor using following code: install latest version Github, use following code: package can loaded using library command.","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE)) {   install.packages(\"BiocManager\") } BiocManager::install(\"musicatk\") if (!requireNamespace(\"devtools\", quietly = TRUE)) {   install.packages(\"devtools\") }  library(devtools) install_github(\"campbio/musicatk\") library(musicatk)"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"setting-up-a-musica-object","dir":"Articles","previous_headings":"","what":"Setting up a musica object","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"order discover predict mutational signatures, must first set musica object 1) extracting variants files objects VCFs MAFs, 2) selecting appropriate reference genome 3) creating musica object, 4) building count tables variants interest. Alternatively, musica object can created directly count table.","code":""},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"extracting-variants","dir":"Articles","previous_headings":"Setting up a musica object","what":"Extracting variants","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"Variants can extracted various formats using following functions: extract_variants_from_vcf_file() function extract variants VCF file. file imported using readVcf function VariantAnnotation package variant information extracted object. extract_variants_from_vcf() function extracts variants CollapsedVCF ExpandedVCF object VariantAnnotation package. extract_variants_from_maf_file() function extract variants file Mutation Annotation Format (MAF) used TCGA. extract_variants_from_maf() function extract variants MAF object created maftools package. extract_variants_from_matrix() function get information matrix data.frame like object columns chromosome, start position, end position, reference allele, mutation allele, sample name. extract_variants() function extract variants list objects. objects can combination VCF files, VariantAnnotation objects, MAF files, MAF objects, data.frame objects. examples extracting variants MAF VCF files:","code":"# Extract variants from a MAF File lusc_maf <- system.file(\"extdata\", \"public_TCGA.LUSC.maf\", package = \"musicatk\") lusc.variants <- extract_variants_from_maf_file(maf_file = lusc_maf)  # Extract variants from an individual VCF file luad_vcf <- system.file(\"extdata\", \"public_LUAD_TCGA-97-7938.vcf\",   package = \"musicatk\" ) luad.variants <- extract_variants_from_vcf_file(vcf_file = luad_vcf)  # Extract variants from multiple files and/or objects melanoma_vcfs <- list.files(system.file(\"extdata\", package = \"musicatk\"),   pattern = glob2rx(\"*SKCM*vcf\"), full.names = TRUE ) variants <- extract_variants(c(lusc_maf, luad_vcf, melanoma_vcfs)) ##   |                                                                              |                                                                      |   0%  |                                                                              |==============                                                        |  20%  |                                                                              |============================                                          |  40%  |                                                                              |==========================================                            |  60%  |                                                                              |========================================================              |  80%  |                                                                              |======================================================================| 100%"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"choosing-a-genome","dir":"Articles","previous_headings":"Setting up a musica object","what":"Choosing a genome","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"musicatk uses BSgenome objects access genome sequence information flanks mutation used bases generating mutation count tables. BSgenome objects store full genome sequences different organisms. full list supported organisms can obtained running available.genomes() loading BSgenome library. Custom genomes can forged well (see BSgenome documentation). musicatk provides utility function called select_genome() allow users quickly select human genome build versions “hg19” “hg38” mouse genome builds “mm9” “mm10”. reference sequences genomes UCSC format (e.g. chr1).","code":"g <- select_genome(\"hg38\")"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"creating-a-musica-object","dir":"Articles","previous_headings":"Setting up a musica object","what":"Creating a musica object","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"last preprocessing step create object variants genome using create_musica_from_variants function. function perform checks ensure chromosome names reference alleles input variant object match supplied BSgenome object. checks can turned setting check_ref_chromosomes = FALSE check_ref_bases = FALSE, respectively. function also looks adjacent single base substitutions (SBSs) convert double base substitutions (DBSs). disable automatic conversion, set convert_dbs = FALSE.","code":"musica <- create_musica_from_variants(x = variants, genome = g) ## Checking that chromosomes in the 'variant' object match chromosomes in the 'genome' object. ## Checking that the reference bases in the 'variant' object match the reference bases in the 'genome' object. ## Warning in .check_variant_ref_in_genome(dt = dt, genome = genome): Reference ## bases for 6 out of 911 variants did not match the reference base in the ## 'genome'. Make sure the genome reference is correct. ## Standardizing INS/DEL style ## Converting 7 insertions ## Converting 1 deletions ## Converting adjacent SBS into DBS ## 5 SBS converted to DBS"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"creating-mutation-count-tables","dir":"Articles","previous_headings":"","what":"Creating mutation count tables","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"Motifs building blocks mutational signatures. Motifs mutation combined genomic information. instance, SBS96 motifs constructed SBS mutation one upstream one downstream base sandwiched together. build tables counting motifs sample. list mutation tables can created setting table_name parameter build_standard_table function: SBS96 - Motifs six possible single base pair mutation types times four possibilities upstream downstream context bases (464 = 96 motifs) SBS192_Trans - Motifs extension SBS96 multiplied transcriptional strand (translated/untranslated), can specified \"Transcript_Strand\". SBS192_Rep - Motifs extension SBS96 multiplied replication strand (leading/lagging), can specified \"Replication_Strand\". DBS - Motifs 78 possible double-base-pair substitutions INDEL - Motifs 83 categories intended capture different categories indels based base-pair change, repeats, microhomology, insertion deletion, length. Different count tables can combined one using combine_count_tables function. example, SBS96 DBS tables combined mutational signature discovery performed across mutations modalities. Tables information types variants (e.g.  two related SBS tables) generally combined used together. Custom count tables can created user-defined mutation-level annotations using build_custom_table function.","code":"build_standard_table(musica, g = g, table_name = \"SBS96\") ## Warning in build_standard_table(musica, g = g, table_name = \"SBS96\"): ## table_name argument deprecated. Use modality instead. ## Building count table from SBS with SBS96 schema data(dbs_musica) build_standard_table(dbs_musica, g, \"SBS96\", overwrite = TRUE) ## Building count table from SBS with SBS96 schema ## Warning in .table_exists_warning(musica, \"SBS96\", overwrite): Overwriting ## counts table: SBS96 build_standard_table(dbs_musica, g, \"DBS78\", overwrite = TRUE) ## Building count table from DBS with DBS78 schema ## Warning in .table_exists_warning(musica, \"DBS78\", overwrite): Overwriting ## counts table: DBS78 # Subset SBS table to DBS samples so they cam be combined count_tables <- tables(dbs_musica) overlap_samples <- which(colnames(count_tables$SBS96@count_table) %in%                            colnames(count_tables$DBS78@count_table)) count_tables$SBS96@count_table <-   count_tables$SBS96@count_table[, overlap_samples] tables(dbs_musica) <- count_tables  combine_count_tables(   musica = dbs_musica, to_comb = c(\"SBS96\", \"DBS78\"),   name = \"sbs_dbs\", description = \"An example combined                      table, combining SBS96 and DBS\", overwrite = TRUE ) annotate_transcript_strand(musica, \"19\", build_table = FALSE) ##   403 genes were dropped because they have exons located on both strands ##   of the same reference sequence or on more than one reference sequence, ##   so cannot be represented by a single genomic range. ##   Use 'single.strand.genes.only=FALSE' to get all the genes in a ##   GRangesList object, or use suppressMessages() to suppress this message. build_custom_table(   musica = musica, variant_annotation = \"Transcript_Strand\",   name = \"Transcript_Strand\",   description = \"A table of transcript strand of variants\",   data_factor = c(\"T\", \"U\"), overwrite = TRUE )"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"creating-a-musica-object-directly-from-a-count-table","dir":"Articles","previous_headings":"","what":"Creating a musica object directly from a count table","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"count table already available, musica object can created directly without need variant file building tables.","code":"luad_count_table_path <- system.file(\"extdata\", \"luad_tcga_count_table.csv\",   package = \"musicatk\" ) luad_count_table <- as.matrix(read.csv(luad_count_table_path))  musica_from_counts <- create_musica_from_counts(luad_count_table, \"SBS96\")"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"discovering-signatures-and-exposures","dir":"Articles","previous_headings":"","what":"Discovering Signatures and Exposures","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"Mutational signature discovery process deconvoluting matrix containing counts mutation type sample two matrices: 1) signature matrix containing probability mutation motif signature 2) exposure matrix containing estimated counts signature sample. Discovery prediction results saved result_list slot musica object. Supported signature discovery algorithms include: Non-negative matrix factorization (nmf) Latent Dirichlet Allocation (lda) built-seed capabilities reproducible results, nstarts multiple independent chains best final result chosen. NMF also allows parallel processing via par_cores. get signatures exposures result within musica object, following functions can used:","code":"discover_signatures(   musica = musica, modality = \"SBS96\", num_signatures = 3,   algorithm = \"nmf\", model_id = \"ex_result\", nstart = 10 ) # Extract the exposure matrix expos <- exposures(musica, \"result\", \"SBS96\", \"ex_result\") expos[1:3, 1:3] ##            TCGA-56-7582-01A-11D-2042-08 TCGA-77-7335-01A-11D-2042-08 ## Signature1                 9.910392e+00                 2.963251e-09 ## Signature2                 2.860983e-07                 1.610374e+02 ## Signature3                 1.800896e+02                 1.069626e+02 ##            TCGA-94-7557-01A-11D-2122-08 ## Signature1                 1.030442e+00 ## Signature2                 1.159696e+02 ## Signature3                 2.886599e-13 # Extract the signature matrix sigs <- signatures(musica, \"result\", \"SBS96\", \"ex_result\") sigs[1:3, 1:3] ##           Signature1  Signature2   Signature3 ## C>A_ACA 7.561675e-11 0.013628647 1.254321e-02 ## C>A_ACC 7.684567e-11 0.007898625 1.641794e-02 ## C>A_ACG 8.596657e-11 0.010725916 8.347563e-11"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"determining-an-appropriate-k-value","dir":"Articles","previous_headings":"Discovering Signatures and Exposures","what":"Determining an appropriate k value","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"k value number signatures predicted discovery method. help determine appropriate k value, compare_k_vals function can used compare stability error associated various k values. Generally, 100 replicates suggested, well larger span k values test. , fewer k values replicates used simplicity.","code":"k_comparison <- compare_k_vals(musica, \"SBS96\",   reps = 5, min_k = 2, max_k = 4,   algorithm = \"nmf\" ) ##  ## k = 2: ## Calculating signatures on original count table... ## Replicate 1 of 5... ## Replicate 2 of 5... ## Replicate 3 of 5... ## Replicate 4 of 5... ## Replicate 5 of 5... ##  ## k = 3: ## Calculating signatures on original count table... ## Replicate 1 of 5... ## Replicate 2 of 5... ## Replicate 3 of 5... ## Replicate 4 of 5... ## Replicate 5 of 5... ##  ## k = 4: ## Calculating signatures on original count table... ## Replicate 1 of 5... ## Replicate 2 of 5... ## Replicate 3 of 5... ## Replicate 4 of 5... ## Replicate 5 of 5..."},{"path":[]},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"signatures","dir":"Articles","previous_headings":"Plotting","what":"Signatures","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"Barplots showing probability mutation type signature can plotted plot_signatures function:  default, scales y-axis forced across signatures. behavior can turned setting same_scale = FALSE. Signatures can re-named based prior knowledge displayed plots:","code":"plot_signatures(musica, model_id = \"ex_result\", modality = \"SBS96\") name_signatures(musica, \"ex_result\", c(\"Smoking\", \"APOBEC\", \"UV\")) plot_signatures(musica, model_id = \"ex_result\", modality = \"SBS96\")"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"exposures","dir":"Articles","previous_headings":"Plotting","what":"Exposures","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"Barplots showing exposures sample can plotted plot_exposures function:  proportion exposure tumor can shown setting proportional = TRUE:  Counts individual samples can also plotted plot_sample_counts function:","code":"plot_exposures(musica, \"ex_result\", plot_type = \"bar\") plot_exposures(musica, \"ex_result\", plot_type = \"bar\", proportional = TRUE) samples <- sample_names(musica) plot_sample_counts(musica, sample_names = samples[c(3, 4, 5)],                    modality = \"SBS96\")"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"comparison-to-external-signatures-e-g--cosmic","dir":"Articles","previous_headings":"Plotting","what":"Comparison to external signatures (e.g. COSMIC)","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"common analysis compare signatures estimated dataset generated datasets COSMIC database. set functions can used easily perform pairwise correlations signatures. compare_results functions compares signatures two models different musica objects. compare_cosmic_v2 correlate signatures model SBS signatures COSMIC V2. example:  example, Signatures 1 2 highly correlated COSMIC Signature 7 4, respectively, may indicate samples dataset exposed UV radiation cigarette smoke. pairs signatures correlation threshold parameter returned. pairs signatures found, may want consider lowering threshold. default correlation metric cosine similarity, can changed using 1 - Jensen-Shannon Divergence setting metric = \"jsd\" Signatures can also correlated COSMIC V3 database using compare_cosmic_v3 function.","code":"compare_cosmic_v2(musica, \"ex_result\", threshold = 0.75) ##      cosine x_sig_index y_sig_index x_sig_name y_sig_name ## 1 0.9733111           1           7    Smoking       SBS7 ## 4 0.7906308           3           4         UV       SBS4 ## 2 0.7720306           1          11    Smoking      SBS11 ## 3 0.7547538           1          30    Smoking      SBS30"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"predicting-exposures-using-pre-existing-signatures","dir":"Articles","previous_headings":"","what":"Predicting exposures using pre-existing signatures","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"Instead discovering mutational signatures exposures dataset de novo, one might get better results predicting exposures signatures previously estimated datasets. incorporate several methods estimating exposures given set pre-existing signatures. example, can predict exposures COSMIC signatures 1, 4, 7, 13 current dataset:  cosmic_v2_sigs object result_model object containing COSMIC V2 signatures without sample exposure information. Note signatures_to_use supplied user, exposures signatures result object estimated. can predict exposures samples musica object result_model object long mutation schema utilized. can list signatures present tumor type according COSMIC V2 database. example, can find signatures present lung cancers: can predict exposures samples musica object using signatures result_model object. Just illustration, predict exposures using estimated signatures model created earlier: course, example useful predicting exposures using signatures learned set samples. time, want give signature_res parameter result_model object generated using independent samples input musica object. mentioned , different signatures different models can compared using compare_results function:","code":"# Load COSMIC V2 data data(\"cosmic_v2_sigs\")  # Predict pre-existing exposures using the \"lda\" method predict_exposure(   musica = musica, modality = \"SBS96\",   signature_res = cosmic_v2_sigs, model_id = \"ex_pred_result\",   signatures_to_use = c(1, 4, 7, 13), algorithm = \"lda\" )  # Plot exposures plot_exposures(musica, \"ex_pred_result\", plot_type = \"bar\") cosmic_v2_subtype_map(\"lung\") ## lung adeno ## 124561317 ## lung  small cell ## 14515 ## lung  squamous ## 124513 model <- get_model(musica, \"result\", \"SBS96\", \"ex_result\") predict_exposure(   musica = musica, modality = \"SBS96\",   signature_res = model, algorithm = \"lda\",   model_id = \"pred_our_sigs\" ) compare_results(musica,   model_id = \"ex_pred_result\",   other_model_id = \"pred_our_sigs\", threshold = 0.60 ) ##      cosine x_sig_index y_sig_index x_sig_name y_sig_name ## 2 0.9733111           3           1       SBS7    Smoking ## 1 0.7906308           2           3       SBS4         UV ## 3 0.7412271           4           2      SBS13     APOBEC"},{"path":[]},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"adding-sample-annotations","dir":"Articles","previous_headings":"Comparing samples between groups using Sample Annotations","what":"Adding sample annotations","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"first must add annotation musica object Note annotations can also added directly musica object beginning using function: samp_annot(musica, \"Tumor_Subtypes\") <- annot$Tumor_Subtypes. annotations automatically included -stream result object. sure annotation vector supplied order samples musica object. can view sample order sample_names function:","code":"annot <- read.table(system.file(\"extdata\", \"sample_annotations.txt\",                                 package = \"musicatk\"),                     sep = \"\\t\", header = TRUE) samp_annot(musica, \"Tumor_Subtypes\") <- annot$Tumor_Subtypes sample_names(musica) ## [1] TCGA-56-7582-01A-11D-2042-08 TCGA-77-7335-01A-11D-2042-08 ## [3] TCGA-94-7557-01A-11D-2122-08 TCGA-97-7938-01A-11D-2167-08 ## [5] TCGA-EE-A3J5-06A-11D-A20D-08 TCGA-ER-A197-06A-32D-A197-08 ## [7] TCGA-ER-A19O-06A-11D-A197-08 ## 7 Levels: TCGA-56-7582-01A-11D-2042-08 ... TCGA-ER-A19O-06A-11D-A197-08"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"plotting-exposures-by-a-sample-annotation","dir":"Articles","previous_headings":"Comparing samples between groups using Sample Annotations","what":"Plotting exposures by a Sample Annotation","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"mentioned previously, plot_exposures function can plot sample exposures musica_result object. can group exposures either sample annotation signature setting group_by parameter. group exposures Tumor_Subtype annotation:  distribution exposures respect annotation can viewed using boxplots setting plot_type = \"box\" group_by = \"annotation\":  Note name annotation must supplied via annotation parameter. Boxplots can converted violin plots setting plot_type = \"violin\". compare level exposure across sample groups within signature, can set group_by = \"signature\" color_by = \"annotation\":","code":"plot_exposures(musica, \"ex_result\",   plot_type = \"bar\", group_by = \"annotation\",   annotation = \"Tumor_Subtypes\" ) plot_exposures(musica, \"ex_result\", plot_type = \"box\", group_by = \"annotation\",                annotation = \"Tumor_Subtypes\") plot_exposures(musica, \"ex_result\",   plot_type = \"box\", group_by = \"signature\",   color_by = \"annotation\", annotation = \"Tumor_Subtypes\" )"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"visualizing-samples-in-2d-using-umap","dir":"Articles","previous_headings":"Comparing samples between groups using Sample Annotations","what":"Visualizing samples in 2D using UMAP","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"create_umap function embeds samples 2 dimensions using umap function uwot package. major parameters fine tuning UMAP n_neighbors, min_dist, spread. See ?uwot::umap information parameters. plot_umap function generate scatter plot UMAP coordinates. points plot colored level signature default:  default, exposures sample share color scale. However, exposures signatures may really high levels compared others. make plot exposures signature color scale, can set same_scale = FALSE:  Lastly, points can colored Sample Annotation setting color_by = \"annotation\" annotation name annotation:  add_annotation_labels = TRUE, centroid group identified using medians labels plotted top centroid.","code":"create_umap(musica, \"ex_result\") ## The parameter 'n_neighbors' cannot be bigger than the total number of samples. Setting 'n_neighbors' to 7. plot_umap(musica, \"ex_result\") plot_umap(musica, \"ex_result\", same_scale = FALSE) plot_umap(musica, \"ex_result\",   color_by = \"annotation\",   annotation = \"Tumor_Subtypes\", add_annotation_labels = TRUE )"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"use-of-plotly-in-plotting","dir":"Articles","previous_headings":"","what":"Use of Plotly in plotting","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"plot_signatures, plot_exposures, plot_umap, builty ggplotly capabilities. Simply specifying plotly = TRUE enables interactive plots allows examination individuals sections, zooming resizing, turning annotation types legend values.","code":"plot_signatures(musica, \"ex_result\", plotly = TRUE) plot_exposures(musica, \"ex_result\", plotly = TRUE) plot_umap(musica, \"ex_result\", plotly = TRUE)"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"note-on-reproducibility","dir":"Articles","previous_headings":"","what":"Note on reproducibility","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"Several functions make use stochastic algorithms procedures require use random number generator (RNG) simulation sampling. maintain reproducibility, functions called using set_seed(1) withr::with_seed(seed, function()) make sure results generatedeach time one functions called. Using with_seed reproducibility advantage interfering user seeds, using one important several functions including discover_signatures, predict_exposure, create_umap, functions use stochastic processes may produce different results run multiple times settings.","code":"seed <- 1 withr::with_seed(seed, predict_exposure(   musica = musica, modality = \"SBS96\",   signature_res = model, algorithm = \"lda\",   model_id = \"reproducible_ex\" ))"},{"path":"https://www.camplab.net/musicatk/articles/musicatk.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"","code":"sessionInfo() ## R version 4.4.0 (2024-04-24) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Ventura 13.1 ##  ## Matrix products: default ## BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/New_York ## tzcode source: internal ##  ## attached base packages: ## [1] parallel  stats     graphics  grDevices datasets  utils     methods   ## [8] base      ##  ## other attached packages: ##  [1] doParallel_1.0.17   iterators_1.0.14    foreach_1.5.2       ##  [4] musicatk_2.0.0      NMF_0.27            Biobase_2.64.0      ##  [7] BiocGenerics_0.50.0 cluster_2.1.6       rngtools_1.5.2      ## [10] registry_0.5-1      BiocStyle_2.32.1    ##  ## loaded via a namespace (and not attached): ##   [1] RColorBrewer_1.1-3                       ##   [2] rstudioapi_0.16.0                        ##   [3] jsonlite_1.8.8                           ##   [4] shape_1.4.6.1                            ##   [5] magrittr_2.0.3                           ##   [6] GenomicFeatures_1.56.0                   ##   [7] farver_2.1.2                             ##   [8] rmarkdown_2.27                           ##   [9] GlobalOptions_0.1.2                      ##  [10] fs_1.6.4                                 ##  [11] BiocIO_1.14.0                            ##  [12] zlibbioc_1.50.0                          ##  [13] ragg_1.3.2                               ##  [14] vctrs_0.6.5                              ##  [15] memoise_2.0.1                            ##  [16] matrixTests_0.2.3                        ##  [17] Rsamtools_2.20.0                         ##  [18] RCurl_1.98-1.16                          ##  [19] rstatix_0.7.2                            ##  [20] htmltools_0.5.8.1                        ##  [21] S4Arrays_1.4.1                           ##  [22] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2  ##  [23] curl_5.2.1                               ##  [24] broom_1.0.6                              ##  [25] SparseArray_1.4.8                        ##  [26] sass_0.4.9                               ##  [27] bslib_0.7.0                              ##  [28] htmlwidgets_1.6.4                        ##  [29] desc_1.4.3                               ##  [30] plyr_1.8.9                               ##  [31] plotly_4.10.4                            ##  [32] cachem_1.1.0                             ##  [33] GenomicAlignments_1.40.0                 ##  [34] lifecycle_1.0.4                          ##  [35] pkgconfig_2.0.3                          ##  [36] Matrix_1.7-0                             ##  [37] R6_2.5.1                                 ##  [38] fastmap_1.2.0                            ##  [39] GenomeInfoDbData_1.2.12                  ##  [40] MatrixGenerics_1.16.0                    ##  [41] clue_0.3-65                              ##  [42] digest_0.6.36                            ##  [43] colorspace_2.1-0                         ##  [44] AnnotationDbi_1.66.0                     ##  [45] maftools_2.20.0                          ##  [46] S4Vectors_0.42.1                         ##  [47] irlba_2.3.5.1                            ##  [48] crosstalk_1.2.1                          ##  [49] textshaping_0.4.0                        ##  [50] GenomicRanges_1.56.1                     ##  [51] RSQLite_2.3.7                            ##  [52] ggpubr_0.6.0                             ##  [53] labeling_0.4.3                           ##  [54] fansi_1.0.6                              ##  [55] httr_1.4.7                               ##  [56] abind_1.4-5                              ##  [57] compiler_4.4.0                           ##  [58] withr_3.0.1                              ##  [59] bit64_4.0.5                              ##  [60] backports_1.5.0                          ##  [61] BiocParallel_1.38.0                      ##  [62] carData_3.0-5                            ##  [63] DBI_1.2.3                                ##  [64] highr_0.11                               ##  [65] ggsignif_0.6.4                           ##  [66] MASS_7.3-61                              ##  [67] DelayedArray_0.30.1                      ##  [68] rjson_0.2.21                             ##  [69] gtools_3.9.5                             ##  [70] DNAcopy_1.78.0                           ##  [71] tools_4.4.0                              ##  [72] MCMCprecision_0.4.0                      ##  [73] glue_1.7.0                               ##  [74] restfulr_0.0.15                          ##  [75] grid_4.4.0                               ##  [76] gridBase_0.4-7                           ##  [77] reshape2_1.4.4                           ##  [78] generics_0.1.3                           ##  [79] gtable_0.3.5                             ##  [80] BSgenome_1.72.0                          ##  [81] tidyr_1.3.1                              ##  [82] data.table_1.15.4                        ##  [83] car_3.1-2                                ##  [84] utf8_1.2.4                               ##  [85] XVector_0.44.0                           ##  [86] RcppAnnoy_0.0.22                         ##  [87] ggrepel_0.9.5                            ##  [88] pillar_1.9.0                             ##  [89] stringr_1.5.1                            ##  [90] circlize_0.4.16                          ##  [91] splines_4.4.0                            ##  [92] dplyr_1.1.4                              ##  [93] lattice_0.22-6                           ##  [94] renv_1.0.7                               ##  [95] survival_3.7-0                           ##  [96] rtracklayer_1.64.0                       ##  [97] bit_4.0.5                                ##  [98] tidyselect_1.2.1                         ##  [99] BSgenome.Hsapiens.UCSC.hg38_1.4.5        ## [100] ComplexHeatmap_2.20.0                    ## [101] Biostrings_2.72.1                        ## [102] knitr_1.48                               ## [103] gridExtra_2.3                            ## [104] bookdown_0.40                            ## [105] IRanges_2.38.1                           ## [106] SummarizedExperiment_1.34.0              ## [107] stats4_4.4.0                             ## [108] xfun_0.45                                ## [109] matrixStats_1.3.0                        ## [110] stringi_1.8.4                            ## [111] UCSC.utils_1.0.0                         ## [112] lazyeval_0.2.2                           ## [113] yaml_2.3.9                               ## [114] TxDb.Hsapiens.UCSC.hg38.knownGene_3.18.0 ## [115] evaluate_0.24.0                          ## [116] codetools_0.2-20                         ## [117] tibble_3.2.1                             ## [118] BiocManager_1.30.23                      ## [119] cli_3.6.3                                ## [120] uwot_0.2.2                               ## [121] systemfonts_1.1.0                        ## [122] munsell_0.5.1                            ## [123] jquerylib_0.1.4                          ## [124] Rcpp_1.0.12                              ## [125] GenomeInfoDb_1.40.1                      ## [126] tidyverse_2.0.0                          ## [127] png_0.1-8                                ## [128] XML_3.99-0.17                            ## [129] pkgdown_2.1.0                            ## [130] ggplot2_3.5.1                            ## [131] blob_1.2.4                               ## [132] bitops_1.0-7                             ## [133] viridisLite_0.4.2                        ## [134] VariantAnnotation_1.50.0                 ## [135] scales_1.3.0                             ## [136] combinat_0.0-8                           ## [137] purrr_1.0.2                              ## [138] crayon_1.5.3                             ## [139] GetoptLong_1.0.5                         ## [140] rlang_1.1.4                              ## [141] cowplot_1.1.3                            ## [142] KEGGREST_1.44.1                          ## [143] conclust_1.1"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Analysis of mutational signatures with musicatk in the R console","text":"variety exogenous exposures endogenous biological processes can contribute overall mutational load observed human tumors. Many different mutational patterns, “mutational signatures”, identified across different tumor types. signatures can provide record environmental exposure can give clues etiology carcinogenesis. Mutational Signature Comprehensive Analysis Toolkit (musicatk) contains complete end--end workflow characterization mutational signatures cohort samples. musicatk utilities extracting variants variety file formats, multiple methods discovery novel signatures prediction pre-existing signatures, many types downstream visualizations exploratory analysis. package ability parse combine multiple motif classes mutational signature discovery prediction processes. Mutation motifs include single base substitutions (SBS), double base substitutions (DBS), insertions (INS) deletions (DEL). package can loaded using library command:","code":"library(musicatk)"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"importing-mutational-data","dir":"Articles","previous_headings":"","what":"Importing mutational data","title":"Analysis of mutational signatures with musicatk in the R console","text":"order discover predict mutational signatures, must first set musica object 1) extracting variants files objects VCFs MAFs, 2) selecting appropriate reference genome 3) creating musica object, 4) adding sample-level annotations, 5) building count tables variants interest. Alternatively, musica object can created directly count table.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"import-variants-from-files","dir":"Articles","previous_headings":"Importing mutational data","what":"Import variants from files","title":"Analysis of mutational signatures with musicatk in the R console","text":"Variants can extracted various formats using following functions: extract_variants_from_vcf_file() function extract variants VCF file. file imported using readVcf function VariantAnnotation package variant information extracted object. extract_variants_from_vcf() function extracts variants CollapsedVCF ExpandedVCF object VariantAnnotation package. extract_variants_from_maf_file() function extract variants file Mutation Annotation Format (MAF) used TCGA. extract_variants_from_maf() function extract variants MAF object created maftools package. extract_variants_from_matrix() function get information matrix data.frame like object columns chromosome, start position, end position, reference allele, mutation allele, sample name. extract_variants() function extract variants list objects. objects can combination VCF files, VariantAnnotation objects, MAF files, MAF objects, data.frame objects. examples extracting variants MAF VCF files:","code":"# Extract variants from a MAF File lusc_maf <- system.file(\"extdata\", \"public_TCGA.LUSC.maf\", package = \"musicatk\") lusc.variants <- extract_variants_from_maf_file(maf_file = lusc_maf)  # Extract variants from an individual VCF file luad_vcf <- system.file(\"extdata\", \"public_LUAD_TCGA-97-7938.vcf\",   package = \"musicatk\" ) luad.variants <- extract_variants_from_vcf_file(vcf_file = luad_vcf)  # Extract variants from multiple files and/or objects melanoma_vcfs <- list.files(system.file(\"extdata\", package = \"musicatk\"),   pattern = glob2rx(\"*SKCM*vcf\"), full.names = TRUE ) variants <- extract_variants(c(lusc_maf, luad_vcf, melanoma_vcfs))"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"import-tcga-datasets","dir":"Articles","previous_headings":"Importing mutational data","what":"Import TCGA datasets","title":"Analysis of mutational signatures with musicatk in the R console","text":"tutorial, analyze mutational data lung skin tumors TCGA. data retrieved using GDCquery function TCGAbiolinks package. Note previous versions GDC database, may need set worflow.type another string workflow.type = MuTect2 Variant Aggregation Masking.","code":"library(TCGAbiolinks) tcga_datasets <- c(\"TCGA-LUAD\", \"TCGA-LUSC\", \"TCGA-SKCM\") types <- gsub(\"TCGA-\", \"\", tcga_datasets)  variants <- NULL annot <- NULL for (i in seq_along(tcga_datasets)) {   # Download variants   query <- GDCquery(     project = tcga_datasets[i],     data.category = \"Simple Nucleotide Variation\",     data.type = \"Masked Somatic Mutation\",     workflow.type = \"Aliquot Ensemble Somatic Variant Merging and Masking\",     experimental.strategy = \"WXS\",     data.format = \"maf\"   )   GDCdownload(query)   data <- GDCprepare(query)    # Extract from maf   temp <- extract_variants_from_matrix(data)   variants <- rbind(variants, temp)   annot <- rbind(annot, cbind(     rep(types[i], length(unique(temp$sample))),     unique(as.character(temp$sample))   )) } colnames(annot) <- c(\"Tumor_Type\", \"ID\") rownames(annot) <- annot[, \"ID\"]"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"creating-a-musica-object","dir":"Articles","previous_headings":"","what":"Creating a musica object","title":"Analysis of mutational signatures with musicatk in the R console","text":"genome build must first selected musica object can created mutational signature analysis. musicatk uses BSgenome objects access genome sequence information flanks mutation used bases generating mutation count tables. BSgenome objects store full genome sequences different organisms. full list supported organisms can obtained running available.genomes() loading BSgenome library. Custom genomes can forged well (see BSgenome documentation). musicatk provides utility function called select_genome() allow users quickly select human genome build versions “hg19” “hg38” mouse genome builds “mm9” “mm10”. reference sequences genomes UCSC format (e.g. chr1). last preprocessing step create object variants genome using create_musica_from_variants function. function perform checks ensure chromosome names reference alleles input variant object match supplied BSgenome object. checks can turned setting check_ref_chromosomes = FALSE check_ref_bases = FALSE, respectively. function also looks adjacent single base substitutions (SBSs) convert double base substitutions (DBSs). disable automatic conversion, set convert_dbs = FALSE.","code":"g <- select_genome(\"hg38\") musica <- create_musica_from_variants(x = variants, genome = g) ## Checking that chromosomes in the 'variant' object match chromosomes in the 'genome' object. ## Checking that the reference bases in the 'variant' object match the reference bases in the 'genome' object. ## Standardizing INS/DEL style ## Removing 22 compound insertions ## Removing 167 compound deletions ## Converting 44 insertions ## Converting 246 deletions ## Converting adjacent SBS into DBS ## 15176 SBS converted to DBS"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"importing-sample-annotations","dir":"Articles","previous_headings":"","what":"Importing sample annotations","title":"Analysis of mutational signatures with musicatk in the R console","text":"Sample-level annotations, tumor type, treatment, outcome can used downstream analyses. Sample annotations stored vector data.frame can directly added musica object using samp_annot function: Note: sure annotation vector data.frame supplied order samples musica object. sample_names function can used get order samples musica object. Note annotations can also added later .","code":"id <- as.character(sample_names(musica)) samp_annot(musica, \"Tumor_Type\") <- annot[id, \"Tumor_Type\"]"},{"path":[]},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"create-standard-tables","dir":"Articles","previous_headings":"Creating mutation count tables","what":"Create standard tables","title":"Analysis of mutational signatures with musicatk in the R console","text":"Motifs building blocks mutational signatures. Motifs mutation combined genomic information. instance, SBS96 motifs constructed SBS mutation one upstream one downstream base sandwiched together. build tables counting motifs sample. list mutation tables can created setting table_name parameter build_standard_table function: SBS96 - Motifs six possible single base pair mutation types times four possibilities upstream downstream context bases (464 = 96 motifs) SBS192_Trans - Motifs extension SBS96 multiplied transcriptional strand (translated/untranslated), can specified \"Transcript_Strand\". SBS192_Rep - Motifs extension SBS96 multiplied replication strand (leading/lagging), can specified \"Replication_Strand\". DBS - Motifs 78 possible double-base-pair substitutions INDEL - Motifs 83 categories intended capture different categories indels based base-pair change, repeats, microhomology, insertion deletion, length.","code":"build_standard_table(musica, g = g, table_name = \"SBS96\") ## Building count table from SBS with SBS96 schema"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"combine-tables","dir":"Articles","previous_headings":"Creating mutation count tables","what":"Combine tables","title":"Analysis of mutational signatures with musicatk in the R console","text":"Different count tables can combined one using combine_count_tables function. example, SBS96 DBS tables combined mutational signature discovery performed across mutations modalities. Tables information types variants (e.g. two related SBS tables) generally combined used together.","code":"# Build Double Base Substitution table build_standard_table(musica, g = g, table_name = \"DBS78\") ## Building count table from DBS with DBS78 schema # Combine with SBS table combine_count_tables(musica, to_comb = c(\"SBS96\", \"DBS78\"), name = \"SBS_DBS\",                      description =                        \"An example combined table, combining SBS96 and DBS\")  # View all tables names(tables(musica)) ## [1] \"SBS96\"   \"DBS78\"   \"SBS_DBS\""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"creating-a-musica-object-directly-from-a-count-table","dir":"Articles","previous_headings":"","what":"Creating a musica object directly from a count table","title":"Analysis of mutational signatures with musicatk in the R console","text":"count table already available, musica object can created directly without need variant file building tables.","code":"luad_count_table_path <- system.file(\"extdata\", \"luad_tcga_count_table.csv\",   package = \"musicatk\" ) luad_count_table <- as.matrix(read.csv(luad_count_table_path))  musica_from_counts <- create_musica_from_counts(luad_count_table, \"SBS96\")"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"filtering-samples","dir":"Articles","previous_headings":"","what":"Filtering samples","title":"Analysis of mutational signatures with musicatk in the R console","text":"Samples low numbers mutations usually excluded discover prediction procedures. subset_musica_by_counts function can used exclude samples low numbers mutations particular table: subset_musica_by_annotation function can also used subset musica object samples match particular annotation. example, wanted analyze lung cancer, filter samples “LUAD” “LUSC”:","code":"musica_filter <- subset_musica_by_counts(musica, table_name = \"SBS96\",                                          num_counts = 10) musica_luad <- subset_musica_by_annotation(musica, annot_col = \"Tumor_Type\",                                            annot_names = c(\"LUAD\", \"LUSC\"))"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"discovery-of-signatures-and-exposures","dir":"Articles","previous_headings":"","what":"Discovery of signatures and exposures","title":"Analysis of mutational signatures with musicatk in the R console","text":"Mutational signature discovery process deconvoluting matrix containing count mutation type sample two matrices: 1) Signature matrix containing probability mutation motif signature 2) Exposure matrix containing estimated counts signature sample. Discovery prediction results saved result_list slot musica object. discover_signatures function can used identify signatures dataset de novo.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"determining-an-appropriate-k-value","dir":"Articles","previous_headings":"Discovery of signatures and exposures","what":"Determining an appropriate k value","title":"Analysis of mutational signatures with musicatk in the R console","text":"k value number signatures predicted discovery method. help determine appropriate k value, compare_k_vals function can used compare stability error associated various k values. Generally, 100 replicates suggested, well larger span k values test. , fewer k values replicates used simplicity.  resulting plot, see k = 4 yields relatively high silhouette width relatively low reconstruction error. error bars metrics also quite narrow k = 4. Therefore four signatures selected, set k equal 4 discover_signatures function: Supported signature discovery algorithms include: Non-negative matrix factorization (nmf) Latent Dirichlet Allocation (lda) built-seed capabilities reproducible results, nstarts multiple independent chains best final result chosen. NMF also allows parallel processing via par_cores. get signatures exposures result object, following functions can used:","code":"k_comparison <- compare_k_vals(musica, \"SBS96\",   reps = 100, min_k = 2, max_k = 6,   algorithm = \"lda\" ) discover_signatures(musica_filter,   modality = \"SBS96\", num_signatures = 4,   algorithm = \"lda\", model_id = \"ex_result\" ) # Extract the exposure matrix expos <- exposures(musica_filter, \"result\", \"SBS96\", \"ex_result\") expos[1:3, 1:3] ##            TCGA-99-8033-01A-11D-2238-08 TCGA-99-8032-01A-11D-2238-08 ## Signature1                    106.52551                    285.88771 ## Signature2                     44.75862                     53.23718 ## Signature3                      7.65405                     10.74107 ##            TCGA-99-8028-01A-11D-2238-08 ## Signature1                  370.2086953 ## Signature2                   21.8723410 ## Signature3                    0.8796583 # Extract the signature matrix sigs <- signatures(musica_filter, \"result\", \"SBS96\", \"ex_result\") sigs[1:3, 1:3] ##         Signature1  Signature2   Signature3 ## C>A_ACA 0.03277323 0.004306005 5.521593e-04 ## C>A_ACC 0.02966502 0.005984863 3.379481e-04 ## C>A_ACG 0.02146643 0.002121666 1.519013e-05"},{"path":[]},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"plot-signatures","dir":"Articles","previous_headings":"Visualization of results","what":"Plot signatures","title":"Analysis of mutational signatures with musicatk in the R console","text":"plot_signatures function can used display barplots show probability mutation type signature:  default, scales y-axis forced across signatures. behavior can turned setting same_scale = FALSE:","code":"plot_signatures(musica_filter, \"ex_result\") plot_signatures(musica_filter, \"ex_result\", same_scale = FALSE)"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"comparing-to-external-signatures","dir":"Articles","previous_headings":"Visualization of results","what":"Comparing to external signatures","title":"Analysis of mutational signatures with musicatk in the R console","text":"common analysis compare signatures estimated dataset generated datasets COSMIC database. set functions can used easily perform pairwise correlations signatures. compare_results functions compares signatures two models different musica objects. compare_cosmic_v2 correlate signatures model SBS signatures COSMIC V2. example:  example, Signatures 1 3 highly correlated COSMIC Signature 4 7, respectively, may indicate samples dataset exposed UV radiation cigarette smoke. pairs signatures correlation threshold parameter returned. pairs signatures found, may want consider lowering threshold. Signatures can also correlated COSMIC V3 database using compare_cosmic_v3 function. Based COSMIC comparison results prior knowledge, signatures can re-named new name can displayed plots:","code":"compare_cosmic_v2(musica_filter, \"ex_result\", threshold = 0.8) ##      cosine x_sig_index y_sig_index x_sig_name y_sig_name ## 5 0.9964997           3           7 Signature3       SBS7 ## 1 0.9753047           1           4 Signature1       SBS4 ## 4 0.8698311           2           6 Signature2       SBS6 ## 6 0.8679439           4          13 Signature4      SBS13 ## 2 0.8207367           1          24 Signature1      SBS24 ## 3 0.8165057           2           1 Signature2       SBS1 name_signatures(musica_filter, \"ex_result\",                 c(\"SBS4 - Smoking\", \"SBS15 - MMR\", \"SBS7 - UV\",                   \"SBS2/13 - APOBEC\")) plot_signatures(musica_filter, \"ex_result\")"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"plot-exposures","dir":"Articles","previous_headings":"Visualization of results","what":"Plot exposures","title":"Analysis of mutational signatures with musicatk in the R console","text":"Barplots showing exposures sample can plotted plot_exposures function:  default, samples ordered highest number mutations left lowest right. Sometimes, many samples present bars small clearly examine patterns exposures. num_samples parameter can used display top samples highest number mutations left: Samples can ordered level individual exposures. can used combination num_samples parameter examine mutational patterns samples highest levels particular exposure. example, samples can ordered number estimated mutations MMR signature:  proportion exposure tumor can shown setting proportional = TRUE:  plot_exposures function can group exposures either sample annotation signature setting group_by parameter. group annotation, groupBy parameter must set \"annotation\" name annotation must supplied via annotation parameter. example, exposures previous result can grouped Tumor_Type annotation:  plot, clear smoking signature active lung cancers UV signature active skin cancers. distribution exposures respect annotation can viewed using boxplots setting plot_type = \"box\" group_by = \"annotation\":  Note boxplots can converted violin plots setting plot_type = \"violin\". compare exposures levels across groups samples within signature, can set group_by = \"signature\" color_by = \"annotation\":  verify deconvolution algorithm produced good signatures, one strategy examine patterns mutations individual samples high predicted percentage particular signature. shape counts match patterns signature, good indicator deconvolution algorithm worked well. Counts individual samples can plotted plot_sample_counts function. example, can plot sample highest proportion APOBEC signature:","code":"plot_exposures(musica_filter, \"ex_result\", plot_type = \"bar\") plot_exposures(musica_filter, \"ex_result\", plot_type = \"bar\", num_samples = 50) plot_exposures(musica_filter, \"ex_result\", plot_type = \"bar\", num_samples = 50,                sort_samples = \"SBS15 - MMR\") plot_exposures(musica_filter, \"ex_result\", plot_type = \"bar\", num_samples = 50,                proportional = TRUE) plot_exposures(musica_filter, \"ex_result\", plot_type = \"bar\",                group_by = \"annotation\", annotation = \"Tumor_Type\") plot_exposures(musica_filter, \"ex_result\", plot_type = \"box\",                group_by = \"annotation\", annotation = \"Tumor_Type\") plot_exposures(musica_filter, \"ex_result\",   plot_type = \"box\", group_by = \"signature\",   color_by = \"annotation\", annotation = \"Tumor_Type\" ) # Normalize exposures expos.prop <- prop.table(expos, margin = 2)  # Plot counts for the sample with the higest level of exposures for sigs #2 # and #4 ix <- c(which.max(expos.prop[2, ]), which.max(expos.prop[4, ])) plot_sample_counts(musica_filter, sample_names = colnames(expos.prop)[ix],                    modality = \"SBS96\")"},{"path":[]},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"predict-cosmic-signatures","dir":"Articles","previous_headings":"Predict exposures from existing signatures","what":"Predict COSMIC signatures","title":"Analysis of mutational signatures with musicatk in the R console","text":"Instead discovering mutational signatures exposures dataset de novo, better result may obtained predicting exposures signatures previously estimated datasets. Predicting exposures pre-existing signatures may sensitivity detecting active compared discovery-based methods incorporating prior information derived larger datasets. musicatk package incorporates several methods estimating exposures given set pre-existing signatures. example, exposures COSMIC signatures 1, 4, 7, 13, 15 can predicted current dataset. Note including COSMIC signature 1 prediction even though show discovery algorithm signature previously shown active lung tumors also including APOBEC signatures (2 13) previously combined 1 signature discovery method.  cosmic_v2_sigs object just result_model object containing COSMIC V2 signatures without sample exposure information. Note signatures_to_use supplied user, exposures signatures result object estimated. result_model object can given signature_res parameter. Exposures can predicted samples musica object result_model object long mutation schema utilized.","code":"# Load COSMIC V2 data data(\"cosmic_v2_sigs\")  # Predict pre-existing exposures using the \"lda\" method predict_exposure(   musica = musica_filter, modality = \"SBS96\",   signature_res = cosmic_v2_sigs,   model_id = \"result_cosmic_selected_sigs\",   signatures_to_use = c(1, 2, 4, 6, 7, 13), algorithm = \"lda\" )  # Plot exposures plot_exposures(musica_filter, \"result_cosmic_selected_sigs\", plot_type = \"bar\",                num_samples = 50)"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"prediction-with-signature-selection","dir":"Articles","previous_headings":"Predict exposures from existing signatures","what":"Prediction with signature selection","title":"Analysis of mutational signatures with musicatk in the R console","text":"many cases, researchers know signatures active cohort samples beforehand. easy predict COSMIC signatures, can detrimental effects output. Including signatures actually active cohort samples may introduce additional noise estimates exposures signatures truly present dataset. Additionally, including extra signatures may induce false signal exposures non-active signatures. musicatk package “two-step” prediction process. first step, exposures signatures estimated. subset signatures selected “active” dataset exposures active signatures estimated. two-step process can done automatically using auto_predict_grid function: result, 13 30 original COSMIC V2 signatures selected including several signatures previously included first prediction manually selected signatures. multiple groups samples present dataset expected somewhat different sets active signatures (e.g. multiple tumor types), 2-step process can improved performing signature selection within group. can achieved supplying sample_annoation parameter. example, exposures predicted three different tumor types supplying Tumor_Type annotation sample_annotation. parameter can left NULL grouping annotation available. three major parameters determine whether signature present dataset first pass : min_exists - signature considered active sample exposure level threshold (Default 0.05). proportion_samples - signature considered active cohort included second pass active least proportion samples (Default 0.25). rare_exposure - signature considered active cohort included second pass proportion exposure threshold least one sample (Default 0.4). parameter meant capture signatures produce high number mutations found small number samples (e.g. Mismatch repair).","code":"# Predict exposures with auto selection of signatures auto_predict_grid(musica_filter, modality = \"SBS96\",                   signature_res = cosmic_v2_sigs, algorithm = \"lda\",                   model_id = \"result_cosmic_auto\",                   sample_annotation = \"Tumor_Type\") ## LUAD ## LUSC ## SKCM # See list of selected signatures rownames(exposures(musica_filter, \"result\", \"SBS96\", \"result_cosmic_auto\")) ##  [1] \"SBS1\"  \"SBS13\" \"SBS15\" \"SBS16\" \"SBS18\" \"SBS2\"  \"SBS21\" \"SBS24\" \"SBS26\" ## [10] \"SBS3\"  \"SBS4\"  \"SBS6\"  \"SBS7\""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"assess-predicted-signatures","dir":"Articles","previous_headings":"Predict exposures from existing signatures","what":"Assess predicted signatures","title":"Analysis of mutational signatures with musicatk in the R console","text":"almost always worthwhile manually assess confirm signatures predicted present within dataset, especially signatures similar profiles one another. example, COSMIC Signature 4 (smoking) Signature 24 (aflatoxin) predicted present within dataset. smoking-related signature expected cohort contains lung cancers, aflatoxin signature unexpected given usually found liver cancers. signatures strong concentration C>tranversions. fact, can see predicted exposures signatures highly correlated across samples:  Therefore, want remove Signature 24 final prediction model. Signature 18 another one high prevalence C>transversion specific trinucleotide contexts. However, least samples high levels Signature 18 without correspondingly high levels Signature 4:   Additionally, 2 3 samples skin cancers smoking signature usually expected: final check, can look counts individual samples high levels Signature 18:  sample clearly high levels UV signature confirming likely skin cancer. Signature 18 also likely active high number C>mutations CCA, TCA, TCT trinucleotide contexts can observed. Given results, Signature 18 kept final analysis. additional analysis signatures, also want remove Signature 3 predominantly found tumors BRCA deficiencies (e.g. breast cancer) samples high rates indels (observed ). predict_exposure function run one last time curated list signatures final result used rest -stream analyses:","code":"e <- exposures(musica_filter, \"result\", \"SBS96\", \"result_cosmic_auto\") plot(e[\"SBS4\", ], e[\"SBS24\", ], xlab = \"SBS4\", ylab = \"SBS24\") plot(e[\"SBS4\", ], e[\"SBS18\", ], xlab = \"SBS4\", ylab = \"SBS18\") plot_exposures(musica_filter, \"result_cosmic_auto\", num_samples = 25,                sort_samples = \"SBS18\") high.sbs18 <- tail(sort(e[\"SBS18\", ]), n = 3) annot[names(high.sbs18), ] ##                              Tumor_Type ID                             ## TCGA-37-5819-01A-01D-1632-08 \"LUSC\"     \"TCGA-37-5819-01A-01D-1632-08\" ## TCGA-EE-A184-06A-11D-A196-08 \"SKCM\"     \"TCGA-EE-A184-06A-11D-A196-08\" ## TCGA-22-5472-01A-01D-1632-08 \"LUSC\"     \"TCGA-22-5472-01A-01D-1632-08\" plot_sample_counts(musica_filter, sample_names = \"TCGA-ER-A19P-06A-11D-A196-08\") # Predict pre-existing exposures with the revised set of selected signatures predict_exposure(musica = musica_filter, modality = \"SBS96\",                  signature_res = cosmic_v2_sigs,                  signatures_to_use = c(1, 2, 4, 6, 7, 13, 15, 18, 26),                  model_id = \"result_cosmic_final\", algorithm = \"lda\")"},{"path":[]},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"visualize-relationships-between-samples-with-2-d-embedding","dir":"Articles","previous_headings":"Downstream analyses","what":"Visualize relationships between samples with 2-D embedding","title":"Analysis of mutational signatures with musicatk in the R console","text":"create_umap function embeds samples 2 dimensions using umap function uwot package. major parameters fine tuning UMAP n_neighbors, min_dist, spread. Generally, higher min_dist create separation larger groups samples lower See ?uwot::umap information parameters well tutorial fine-tuning. , UMAP created standard parameters: Note using result_cosmic_final model came prediction algorithm, also used ex_result model generated discovery algorithm. plot_umap function generate scatter plot UMAP coordinates. points plot colored level signature default:  default, exposures sample share color scale. However, exposures signatures may really high levels compared others. make plot exposures signature color scale, can set same_scale = FALSE:  Lastly, points can colored Sample Annotation setting color_by = \"annotation\" annotation parameter name annotation:  set add_annotation_labels = TRUE, centroid group identified using medians labels plotted position centroid:","code":"set.seed(1) create_umap(musica_filter, \"result_cosmic_final\") plot_umap(musica_filter, \"result_cosmic_final\") plot_umap(musica_filter, \"result_cosmic_final\", same_scale = FALSE) plot_umap(musica_filter, \"result_cosmic_final\", color_by = \"annotation\",           annotation = \"Tumor_Type\") plot_umap(musica_filter, \"result_cosmic_final\", color_by = \"annotation\",           annotation = \"Tumor_Type\", add_annotation_labels = TRUE)"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"plotting-exposures-in-a-heatmap","dir":"Articles","previous_headings":"Downstream analyses","what":"Plotting exposures in a heatmap","title":"Analysis of mutational signatures with musicatk in the R console","text":"Exposures can displayed heatmap row corresponds siganture column correponds sample:  default, signatures scaled mean zero standard deviation 1 across samples (.e. z-scored). can turned setting scale = FALSE. Sample annotations can displayed column color bar setting annotation parameter:  heatmap shows Signature 4 Signature 7 largely mutually exclusive one another can used separate lung skin cancers. Additionally, subsets signatures samples can displayed. example, want examine signatures involved mismatch repair, can select signatures 6, 15, 26:  heatmap, can see small subset distinct samples relatively higher levels signatures.","code":"plot_heatmap(musica_filter, \"result_cosmic_final\") plot_heatmap(musica_filter, \"result_cosmic_final\", annotation = \"Tumor_Type\") plot_heatmap(musica_filter, \"result_cosmic_final\", annotation = \"Tumor_Type\",              subset_signatures = c(\"SBS6\", \"SBS15\", \"SBS26\"))"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"clustering-samples-based-on-exposures","dir":"Articles","previous_headings":"Downstream analyses","what":"Clustering samples based on exposures","title":"Analysis of mutational signatures with musicatk in the R console","text":"Samples can grouped de novo clusters using several algorithms factoextra cluster packages pam kmeans. One major challenge choosing number clusters (k). function k_select several metrics examining cluster stability total within cluster sum squares (wss), Silhouette Width (silhouette), Gap Statistic (gap_stat).  2 clusters may optimal choice, just correspond two large clusters lung skin tumors. Therefore, choosing higher value may informative. next major drop silhouette width k = 6, select moving forward perform clustering: Clusters can visualized UMAP plot_cluster function:","code":"k_select(musica_filter, \"result_cosmic_final\", method = \"silhouette\",          clust.method = \"pam\", n = 20) clusters <- cluster_exposure(musica_filter, \"result_cosmic_final\",                              method = \"pam\", nclust = 6) ## Metric: 'euclidean'; comparing: 1614 vectors. clusters[, 1] <- as.factor(clusters[, 1]) plot_cluster(musica_filter, \"result_cosmic_final\", cluster = clusters,              group = \"none\")"},{"path":[]},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"plotly-for-interactive-plots","dir":"Articles","previous_headings":"Additional features","what":"Plotly for interactive plots","title":"Analysis of mutational signatures with musicatk in the R console","text":"functions plot_signatures, plot_exposures, plot_umap ability create ggplotly plots simply specifying plotly = TRUE. Plotly plots interactive allow users zoom re-sizing plots, turn annotation types legend values, hover elements plots (e.g. bars points) information element (e.g. sample name). examples plot_signatures plot_exposures","code":"plot_signatures(musica_filter, \"result_cosmic_final\", plotly = TRUE) plot_exposures(musica_filter, \"result_cosmic_final\", num_samples = 25,                plotly = TRUE)"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"cosmic-signatures-annotated-to-be-active-in-a-tumor-type","dir":"Articles","previous_headings":"Additional features","what":"COSMIC signatures annotated to be active in a tumor type","title":"Analysis of mutational signatures with musicatk in the R console","text":"signatures predicted present tumor type according COSMIC V2 database can quickly retrieved. example, can find signatures predicted present lung cancers:","code":"cosmic_v2_subtype_map(\"lung\") ## lung adeno ## 124561317 ## lung  small cell ## 14515 ## lung  squamous ## 124513"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"creating-custom-tables","dir":"Articles","previous_headings":"Additional features","what":"Creating custom tables","title":"Analysis of mutational signatures with musicatk in the R console","text":"Custom count tables can created user-defined mutation-level annotations using build_custom_table function.","code":"# Adds strand information to the 'variant' table annotate_transcript_strand(musica, genome_build = \"hg38\", build_table = FALSE) ##   2135 genes were dropped because they have exons located on both strands ##   of the same reference sequence or on more than one reference sequence, ##   so cannot be represented by a single genomic range. ##   Use 'single.strand.genes.only=FALSE' to get all the genes in a ##   GRangesList object, or use suppressMessages() to suppress this message. # Generates a count table from strand build_custom_table(   musica = musica, variant_annotation = \"Transcript_Strand\",   name = \"Transcript_Strand\",   description = \"A table of transcript strand of variants\",   data_factor = c(\"T\", \"U\"), overwrite = TRUE )"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_cnsl.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Analysis of mutational signatures with musicatk in the R console","text":"","code":"sessionInfo() ## R version 4.4.0 (2024-04-24) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Ventura 13.1 ##  ## Matrix products: default ## BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/New_York ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices datasets  utils     methods   base      ##  ## other attached packages: ## [1] TCGAbiolinks_2.32.0 musicatk_2.0.0      NMF_0.27            ## [4] Biobase_2.64.0      BiocGenerics_0.50.0 cluster_2.1.6       ## [7] rngtools_1.5.2      registry_0.5-1      ##  ## loaded via a namespace (and not attached): ##   [1] RcppAnnoy_0.0.22                         ##   [2] BiocIO_1.14.0                            ##   [3] bitops_1.0-7                             ##   [4] filelock_1.0.3                           ##   [5] matrixTests_0.2.3                        ##   [6] tibble_3.2.1                             ##   [7] R.oo_1.26.0                              ##   [8] XML_3.99-0.17                            ##   [9] factoextra_1.0.7                         ##  [10] lifecycle_1.0.4                          ##  [11] httr2_1.0.2                              ##  [12] rstatix_0.7.2                            ##  [13] doParallel_1.0.17                        ##  [14] NLP_0.2-1                                ##  [15] lattice_0.22-6                           ##  [16] vroom_1.6.5                              ##  [17] MASS_7.3-61                              ##  [18] crosstalk_1.2.1                          ##  [19] backports_1.5.0                          ##  [20] magrittr_2.0.3                           ##  [21] plotly_4.10.4                            ##  [22] sass_0.4.9                               ##  [23] rmarkdown_2.27                           ##  [24] jquerylib_0.1.4                          ##  [25] yaml_2.3.9                               ##  [26] BSgenome.Hsapiens.UCSC.hg38_1.4.5        ##  [27] topicmodels_0.2-16                       ##  [28] cowplot_1.1.3                            ##  [29] DBI_1.2.3                                ##  [30] RColorBrewer_1.1-3                       ##  [31] abind_1.4-5                              ##  [32] zlibbioc_1.50.0                          ##  [33] rvest_1.0.4                              ##  [34] GenomicRanges_1.56.1                     ##  [35] purrr_1.0.2                              ##  [36] R.utils_2.12.3                           ##  [37] RCurl_1.98-1.16                          ##  [38] VariantAnnotation_1.50.0                 ##  [39] rappdirs_0.3.3                           ##  [40] circlize_0.4.16                          ##  [41] GenomeInfoDbData_1.2.12                  ##  [42] IRanges_2.38.1                           ##  [43] S4Vectors_0.42.1                         ##  [44] ggrepel_0.9.5                            ##  [45] tm_0.7-13                                ##  [46] irlba_2.3.5.1                            ##  [47] BiocStyle_2.32.1                         ##  [48] conclust_1.1                             ##  [49] pkgdown_2.1.0                            ##  [50] codetools_0.2-20                         ##  [51] DelayedArray_0.30.1                      ##  [52] xml2_1.3.6                               ##  [53] tidyselect_1.2.1                         ##  [54] shape_1.4.6.1                            ##  [55] UCSC.utils_1.0.0                         ##  [56] farver_2.1.2                             ##  [57] TCGAbiolinksGUI.data_1.24.0              ##  [58] matrixStats_1.3.0                        ##  [59] stats4_4.4.0                             ##  [60] BiocFileCache_2.12.0                     ##  [61] GenomicAlignments_1.40.0                 ##  [62] jsonlite_1.8.8                           ##  [63] GetoptLong_1.0.5                         ##  [64] iterators_1.0.14                         ##  [65] systemfonts_1.1.0                        ##  [66] foreach_1.5.2                            ##  [67] tools_4.4.0                              ##  [68] progress_1.2.3                           ##  [69] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2  ##  [70] ragg_1.3.2                               ##  [71] Rcpp_1.0.12                              ##  [72] glue_1.7.0                               ##  [73] gridExtra_2.3                            ##  [74] SparseArray_1.4.8                        ##  [75] xfun_0.45                                ##  [76] MatrixGenerics_1.16.0                    ##  [77] GenomeInfoDb_1.40.1                      ##  [78] dplyr_1.1.4                              ##  [79] withr_3.0.1                              ##  [80] combinat_0.0-8                           ##  [81] BiocManager_1.30.23                      ##  [82] fastmap_1.2.0                            ##  [83] MCMCprecision_0.4.0                      ##  [84] fansi_1.0.6                              ##  [85] digest_0.6.36                            ##  [86] R6_2.5.1                                 ##  [87] textshaping_0.4.0                        ##  [88] colorspace_2.1-0                         ##  [89] gtools_3.9.5                             ##  [90] biomaRt_2.60.1                           ##  [91] RSQLite_2.3.7                            ##  [92] R.methodsS3_1.8.2                        ##  [93] utf8_1.2.4                               ##  [94] tidyr_1.3.1                              ##  [95] generics_0.1.3                           ##  [96] renv_1.0.7                               ##  [97] data.table_1.15.4                        ##  [98] rtracklayer_1.64.0                       ##  [99] prettyunits_1.2.0                        ## [100] httr_1.4.7                               ## [101] htmlwidgets_1.6.4                        ## [102] S4Arrays_1.4.1                           ## [103] uwot_0.2.2                               ## [104] pkgconfig_2.0.3                          ## [105] gtable_0.3.5                             ## [106] modeltools_0.2-23                        ## [107] blob_1.2.4                               ## [108] ComplexHeatmap_2.20.0                    ## [109] XVector_0.44.0                           ## [110] htmltools_0.5.8.1                        ## [111] carData_3.0-5                            ## [112] clue_0.3-65                              ## [113] scales_1.3.0                             ## [114] tidyverse_2.0.0                          ## [115] TxDb.Hsapiens.UCSC.hg38.knownGene_3.18.0 ## [116] png_0.1-8                                ## [117] knitr_1.48                               ## [118] rstudioapi_0.16.0                        ## [119] tzdb_0.4.0                               ## [120] reshape2_1.4.4                           ## [121] rjson_0.2.21                             ## [122] curl_5.2.1                               ## [123] cachem_1.1.0                             ## [124] GlobalOptions_0.1.2                      ## [125] stringr_1.5.1                            ## [126] parallel_4.4.0                           ## [127] AnnotationDbi_1.66.0                     ## [128] restfulr_0.0.15                          ## [129] desc_1.4.3                               ## [130] pillar_1.9.0                             ## [131] grid_4.4.0                               ## [132] vctrs_0.6.5                              ## [133] slam_0.1-50                              ## [134] ggpubr_0.6.0                             ## [135] car_3.1-2                                ## [136] dbplyr_2.5.0                             ## [137] evaluate_0.24.0                          ## [138] readr_2.1.5                              ## [139] GenomicFeatures_1.56.0                   ## [140] cli_3.6.3                                ## [141] compiler_4.4.0                           ## [142] Rsamtools_2.20.0                         ## [143] rlang_1.1.4                              ## [144] crayon_1.5.3                             ## [145] ggsignif_0.6.4                           ## [146] labeling_0.4.3                           ## [147] plyr_1.8.9                               ## [148] fs_1.6.4                                 ## [149] stringi_1.8.4                            ## [150] viridisLite_0.4.2                        ## [151] philentropy_0.8.0                        ## [152] gridBase_0.4-7                           ## [153] BiocParallel_1.38.0                      ## [154] munsell_0.5.1                            ## [155] Biostrings_2.72.1                        ## [156] lazyeval_0.2.2                           ## [157] Matrix_1.7-0                             ## [158] BSgenome_1.72.0                          ## [159] hms_1.1.3                                ## [160] bit64_4.0.5                              ## [161] ggplot2_3.5.1                            ## [162] KEGGREST_1.44.1                          ## [163] SummarizedExperiment_1.34.0              ## [164] highr_0.11                               ## [165] broom_1.0.6                              ## [166] memoise_2.0.1                            ## [167] bslib_0.7.0                              ## [168] bit_4.0.5                                ## [169] downloader_0.4"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"variety exogenous exposures endogenous biological processes can contribute overall mutational load observed human tumors. Many different mutational patterns, “mutational signatures”, identified across different tumor types. signatures can provide record environmental exposure can give clues etiology carcinogenesis. Mutational Signature Comprehensive Analysis Toolkit (musicatk) contains complete end--end workflow characterization mutational signatures cohort samples. musicatk utilities extracting variants variety file formats, multiple methods discovery novel signatures prediction pre-existing signatures, many types downstream visualizations exploratory analysis. package ability parse combine multiple motif classes mutational signature discovery prediction processes. Mutation motifs include single base substitutions (SBS), double base substitutions (DBS), insertions (INS) deletions (DEL). start app local machine, open RStudio R terminal type following console:","code":"library(musicatk) musicatk()"},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"importing-mutational-data","dir":"Articles","previous_headings":"","what":"Importing mutational data","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"Users can upload datasets 1 3 different methods. - “Import variants files” - upload MAF VCF files containing variant data. - “Import variants TCGA” - easily import open access TCGA tumor datasets. - “Import previously generated musica objects” - upload existing musica objects.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"import-variants-from-files","dir":"Articles","previous_headings":"Importing mutational data","what":"Import variants from files","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"order discover predict mutational signatures, must first set musica object 1) extracting variants files objects VCFs MAFs, 2) selecting appropriate reference genome 3) creating musica object, 4) adding sample-level annotations, 5) building count tables variants interest. Variants stored VCF MAF files can selected computation using ‘browse’ button ‘Select Files’ label.  Clicking ‘Add Samples’ button add files list samples imported. delete undo button next file can pressed remove revert change respectively. adding files, ‘Import’ button can clicked start importing process.  process completed, notification bottom right appear. variants table uploaded files also appear can downloaded pressing ‘Download Variants’ button.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"import-tcga-datasets","dir":"Articles","previous_headings":"Importing mutational data","what":"Import TCGA Datasets","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"tab allows selection single multiple datasets generated Cancer Genome Atlas (TCGA). original TCGA page tumor name list can referred selecting ‘Full Tumor List’ link top. desired datasets selected, ‘Import’ button bottom can clicked download TCGA data. may take time download process selected datasets. finished, completion notification appear bottom right.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"import-previously-generated-musica-objects","dir":"Articles","previous_headings":"Importing mutational data","what":"Import previously generated musica objects","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"tab can used import user’s previously generated musica variant object .rda .rds format. browse button can selected selecting files. selected, bar saying file upload completed appear. finished, notification message bottom right appear along table variants. musica variant object uploaded users can skip Create Musica tab move build tables tab directly.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"creating-a-musica-object","dir":"Articles","previous_headings":"","what":"Creating a musica object","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"tab users can process variants create musica variant object can used discovery signatures prediction exposures. reference genome can selected drop menu labeled “Choose Genome” matches genome build variants ‘Create Musica Object’ button can clicked. ’s done, completion notification message bottom right variant summary table appear. musica object can downloaded clicking ‘Download Musica Object’ button re-uploaded save time subsequent sessions.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"importing-sample-annotations","dir":"Articles","previous_headings":"","what":"Importing sample annotations","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"Sample annotations can used store information sample tumor type treatment status. optional can used downstream plotting functions plot_exposures plot_umap group color samples particular annotation.  Annotations sample-level variables Tumor Type Age. can provided character delimited text file must include column containing sample IDs.  sample IDs must match sample names musica object. NA values given samples present annotation file. selecting correct delimiter, data table appear show annotations added musica object. annotation file contain header, unselect “Header” radio button. Choose column contains sample names “Sample Name Columns” dropdown click “Add Annotation”. # Creating mutation count tables","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"create-standard-tables","dir":"Articles","previous_headings":"Importing sample annotations","what":"Create standard tables","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"“Build Tables” tab generates count tables different mutation schemas. schemas input mutational signature discovery prediction functions. build count tables, user must select 1 5 standard motifs “Select Count Table” dropdown.  SBS96 - Motifs six possible single base pair mutation types times four possibilities upstream downstream context bases (464 = 96 motifs)  SBS192_Trans - Motifs extension SBS96 multiplied transcriptional strand (translated/untranslated), can specified “Transcript_Strand”.  SBS192_Rep - Motifs extension SBS96 multiplied replication strand (leading/lagging), can specified “Replication_Strand”.  DBS - Motifs 78 possible double-base-pair substitutions.  INDEL - Motifs 83 categories intended capture different categories indels based base-pair change, repeats, microhomology, insertion deletion, length.  addition selecting motif, user must also provide reference genome.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"combine-tables","dir":"Articles","previous_headings":"Importing sample annotations","what":"Combine tables","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"two tables can combined new table. option build combined table appear second table created.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"estimating-signatures-and-exposures","dir":"Articles","previous_headings":"","what":"Estimating signatures and exposures","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"user option discovering novel signatures exposures, using previously discovered signatures predict exposures. discover signatures use “Discover” tab. predict signature exposures, use “Predict” tab.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"discovery-of-signatures-and-exposures","dir":"Articles","previous_headings":"Estimating signatures and exposures","what":"Discovery of signatures and exposures","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"Mutational signatures exposures discovered using Latent Dirichlet Allocation (LDA) Non-Negative Matrix Factorization (NMF) algorithms. algorithms deconvolute mutation count matrix two matrices: 1) “signature” matrix containing probability mutation type sample 2) “exposure” matrix containing estimated counts signature sample. Select modality, algorithm, number signatures, specify name result list model store results click “Discover signatures”.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"predicting-exposures-from-existing-signatures","dir":"Articles","previous_headings":"Estimating signatures and exposures","what":"Predicting exposures from existing signatures","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"Exposures samples can predicted using existing set signatures stored result model object. Algorithms available prediction include “lda” “decompTumor2Sig”.  “Signatures Predict” dropdown contains signatures result object selected “Result Predict” dropdown. can search dropdown select multiple signatures. example use “lda” algorithm predict exposures 6 Cosmic signatures.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"visualization-of-results","dir":"Articles","previous_headings":"","what":"Visualization of results","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"data visualization tab can used generate customized plots signatures exposures. Plots made interactive “plotly” option selected.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"plot-signatures","dir":"Articles","previous_headings":"Visualization of results","what":"Plot signatures","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"Bar plots can used display probability type mutation within signature.  Previously, 8 single-base signatures identified cohort lung adenocarcinoma, lung squamous cell carcinoma, skin cutaneous melanoma samples TCGA. default, signatures named numbers, option renaming signatures provided want rename according possible etiology (e.g. Smoking) closest correlation COSMIC (e.g. SBS4).","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"plot-exposures","dir":"Articles","previous_headings":"Visualization of results","what":"Plot exposures","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"Bar plots, box plots, violin plots scatter plots can used visualize exposure levels signature sample.  default, stacked bar plot sorted total number mutations used. stacked bar shows proportion exposure signature.  stacked bar plot can ordered signatures. Signatures selected Sort option, bucket list show allow select signatures want use dragging left box right box. Users can also set limit number samples display.  stacked bar plot now ordered exposure signature 1 top 400 samples included .  Box plot violin plot can used visualize distribution exposures compare exposures different groups samples.  default, box plot exposure signature shown.  annotation file provided, can visually compare exposure signatures among different groups.  box plot, exposures signature grouped tumor types. can find signatures 1 5 high activities lung cancer samples, signatures 3 8 high activities skin cancer samples.  can also group samples signatures color tumor types.  plot can used visualize compare distribution exposure levels signature across annotation tumor type.","code":""},{"path":[]},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"compare-signatures","dir":"Articles","previous_headings":"Downstream analyses","what":"Compare Signatures","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"common analysis compare discovered signatures estimated dataset generated datasets COSMIC database. threshold acts cutoff similarity score can value 0 1. Results populate downloadable data table.  Using cosine metric threshold 0.8,7 pairs similar signatures COSMIC. Signature1 high cosine similarity Cosmic SBS4 indicating tumors exposed cigarette smoke.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"differential-analysis-of-exposures-between-groups","dir":"Articles","previous_headings":"Downstream analyses","what":"Differential analysis of exposures between groups","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"“Exposure Differential Analysis” tab used run differential analysis signature exposures annotated samples. 3 methods perform differential analysis: Wilcoxon Rank Sum Test, Kruskal-Wallis Rank Sum Test, negative binomial regression (glm).  Wilcoxon Rank Sum Test can used directly compare two groups samples. display Wilcoxon Rank Sum Test results LUAD SKCM. Note LUSC ignored since specified pair.  table, can see several signatures differentially exposed across tumor types. comparison analysis, can hypothesize signature1 may related tobacco smoke, exposure tobacco smoke occurs lung cancers skin cancers.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"clustering-samples-based-on-exposures","dir":"Articles","previous_headings":"Downstream analyses","what":"Clustering samples based on exposures","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"“Clustering” subtab provides several algorithms factoextra cluster packages cluster samples based exposure levels. selecting musica result object, recommended use “Explore Number Clusters” box help find potential number clusters data. (Note: gap statistic may take longer time calculate.)  line plot shows within cluster sum squares number clusters predicted using hierarchical clustering. “elbow” curve can used starting place cluster number.  “Clustering” box perform clustering analysis. addition clustering algorithm, several methods calculating dissimilarity matrix, imported philentropy package, also provided.  table output clustering analysis, combined annotation.  “Visualization” box, users can make scatter plots visualize clustering results UMAP panel. Three types plots provided.  “None” selected, single scatter plot made points colored cluster label.  “Signature” selected, subplot made combination cluster label signature. Points colored level specific signature.  “Annotation” selected, additional select box show let choose one type user-supplied annotation interest. subplot generated combination signature category annotation. Points colored cluster label.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"heatmap-of-exposures","dir":"Articles","previous_headings":"Downstream analyses","what":"Heatmap of exposures","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"Heatmaps can used visualize relative levels signatures across tumors single plot. Select result object want use heatmap visualization dropdown menu start labeled ‘Select Result’. Choose different settings press ‘Plot’ button visualize heatmap. Check ‘Proportional’ option normalize levels signatures within sample sum one. Z-score normalization scale signature mean zero standard deviation one.. can also show hide tumor signature names checking unchecking ‘Show column names’ ‘Show row names’, respectively. want display subset signatures, click ‘Selected Signatures’ option select signatures show. can also select ‘Samples’ ‘Annotation’ options subset available samples annotations.","code":""},{"path":"https://www.camplab.net/musicatk/articles/tutorial_tcga_ui.html","id":"download-results","dir":"Articles","previous_headings":"Downstream analyses","what":"Download results","title":"Analysis of mutational signatures with the Shiny graphical user interface (GUI)","text":"can download musica object using drop menu. saved .rds files can reuploaded back app later time. Select name musica object click Download button save file computer.","code":""},{"path":"https://www.camplab.net/musicatk/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Aaron Chevalier. Author.           0000-0002-3968-9250 Natasha Gurevich. Author.           0000-0002-0747-6840 Tao Guo. Author.           0009-0005-8960-9203 Joshua D. Campbell. Author, maintainer.","code":""},{"path":"https://www.camplab.net/musicatk/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Chevalier , Gurevich N, Guo T, Campbell JD (2024). musicatk: Mutational Signature Comprehensive Analysis Toolkit. R package version 2.0.0, https://www.camplab.net/musicatk/.","code":"@Manual{,   title = {musicatk: Mutational Signature Comprehensive Analysis Toolkit},   author = {Aaron Chevalier and Natasha Gurevich and Tao Guo and Joshua D. Campbell},   year = {2024},   note = {R package version 2.0.0},   url = {https://www.camplab.net/musicatk/}, }"},{"path":[]},{"path":"https://www.camplab.net/musicatk/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"variety exogenous exposures endogenous biological processes can contribute overall mutational load observed human tumors. Many different mutational patterns, “mutational signatures”, identified across different tumor types. signatures can provide record environmental exposure can give clues etiology carcinogenesis. Mutational Signature Comprehensive Analysis Toolkit (musicatk) utilities extracting variants variety file formats, contains multiple methods discovery novel signatures prediction known signatures, well many types downstream visualizations exploratory analysis. package ability parse combine multiple motif classes mutational signature discovery prediction processes. Mutation motifs include single base substitutions (SBS), double base substitutions (DBS), insertions (INS) deletions (DEL).","code":""},{"path":"https://www.camplab.net/musicatk/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"Currently musicatk can installed Bioconductor using following code: install latest version Github, use following code: package can loaded using library command.","code":"if (!requireNamespace(\"BiocManager\", quietly=TRUE)){     install.packages(\"BiocManager\")} BiocManager::install(\"musicatk\") if (!requireNamespace(\"devtools\", quietly=TRUE)){     install.packages(\"devtools\")}  library(devtools) install_github(\"campbio/musicatk\") library(musicatk)"},{"path":"https://www.camplab.net/musicatk/index.html","id":"tutorials","dir":"","previous_headings":"","what":"Tutorials","title":"Mutational Signature Comprehensive Analysis Toolkit","text":"Detailed usage tutorials available Camplab website ‘Vignettes’ drop-.","code":""},{"path":"https://www.camplab.net/musicatk/reference/add_flank_to_variants.html","id":null,"dir":"Reference","previous_headings":"","what":"Uses a genome object to find context and add it to the variant table — add_flank_to_variants","title":"Uses a genome object to find context and add it to the variant table — add_flank_to_variants","text":"Uses genome object find context add variant table","code":""},{"path":"https://www.camplab.net/musicatk/reference/add_flank_to_variants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uses a genome object to find context and add it to the variant table — add_flank_to_variants","text":"","code":"add_flank_to_variants(   musica,   g,   flank_start,   flank_end,   build_table = TRUE,   overwrite = FALSE )"},{"path":"https://www.camplab.net/musicatk/reference/add_flank_to_variants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uses a genome object to find context and add it to the variant table — add_flank_to_variants","text":"musica Input samples g BSgenome object indicating genome reference variants coordinates derived . flank_start Start flank area add, can positive negative flank_end End flank area add, can positive negative build_table Automatically build table using annotation add overwrite Overwrite existing count table","code":""},{"path":"https://www.camplab.net/musicatk/reference/add_flank_to_variants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Uses a genome object to find context and add it to the variant table — add_flank_to_variants","text":"None musica","code":""},{"path":"https://www.camplab.net/musicatk/reference/add_flank_to_variants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Uses a genome object to find context and add it to the variant table — add_flank_to_variants","text":"","code":"data(musica_sbs96_tiny) g <- select_genome(\"19\") add_flank_to_variants(musica_sbs96_tiny, g, 1, 2) add_flank_to_variants(musica_sbs96_tiny, g, -2, -1)"},{"path":"https://www.camplab.net/musicatk/reference/add_variant_type.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates a variant type table — add_variant_type","title":"Generates a variant type table — add_variant_type","text":"Generates variant type table","code":""},{"path":"https://www.camplab.net/musicatk/reference/add_variant_type.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates a variant type table — add_variant_type","text":"","code":"add_variant_type(tab)"},{"path":"https://www.camplab.net/musicatk/reference/add_variant_type.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates a variant type table — add_variant_type","text":"tab Input variant table","code":""},{"path":"https://www.camplab.net/musicatk/reference/add_variant_type.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generates a variant type table — add_variant_type","text":"Returns inputted variant table variant type (\"SBS\", \"DBS\", \"INS\", \"DEL\") added appended \"Variant_Type\" column","code":""},{"path":"https://www.camplab.net/musicatk/reference/add_variant_type.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generates a variant type table — add_variant_type","text":"","code":"data(musica) variants <- variants(musica) musicatk:::add_variant_type(variants) #>         chr     start       end    ref    alt                       sample #>      <fctr>     <num>     <num> <char> <char>                       <fctr> #>   1:   chr1  11020563  11020563      C      A TCGA-94-7557-01A-11D-2122-08 #>   2:   chr1  43430030  43430030      G      T TCGA-94-7557-01A-11D-2122-08 #>   3:   chr1  58682403  58682403      A      G TCGA-94-7557-01A-11D-2122-08 #>   4:   chr1 109508295 109508295      C      G TCGA-94-7557-01A-11D-2122-08 #>   5:   chr1 156384826 156384826      A      C TCGA-94-7557-01A-11D-2122-08 #>  ---                                                                       #> 907:  chr19  54885292  54885292      G      A TCGA-ER-A19O-06A-11D-A197-08 #> 908:  chr20  49374328  49374328      A      T TCGA-ER-A19O-06A-11D-A197-08 #> 909:   chrX  73213768  73213768      T      G TCGA-ER-A19O-06A-11D-A197-08 #> 910:   chrX 101292834 101292834      G      A TCGA-ER-A19O-06A-11D-A197-08 #> 911:   chrX 107526690 107526690      C      T TCGA-ER-A19O-06A-11D-A197-08 #>      Variant_Type #>            <char> #>   1:          SBS #>   2:          SBS #>   3:          SBS #>   4:          SBS #>   5:          SBS #>  ---              #> 907:          SBS #> 908:          SBS #> 909:          SBS #> 910:          SBS #> 911:          SBS"},{"path":"https://www.camplab.net/musicatk/reference/annotate_replication_strand.html","id":null,"dir":"Reference","previous_headings":"","what":"Add replication strand annotation to SBS variants based on bedgraph file — annotate_replication_strand","title":"Add replication strand annotation to SBS variants based on bedgraph file — annotate_replication_strand","text":"Add replication strand annotation SBS variants based bedgraph file","code":""},{"path":"https://www.camplab.net/musicatk/reference/annotate_replication_strand.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add replication strand annotation to SBS variants based on bedgraph file — annotate_replication_strand","text":"","code":"annotate_replication_strand(musica, rep_range, build_table = TRUE)"},{"path":"https://www.camplab.net/musicatk/reference/annotate_replication_strand.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add replication strand annotation to SBS variants based on bedgraph file — annotate_replication_strand","text":"musica musica object. rep_range GRanges object replication timing metadata build_table Automatically build table annotation","code":""},{"path":"https://www.camplab.net/musicatk/reference/annotate_replication_strand.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add replication strand annotation to SBS variants based on bedgraph file — annotate_replication_strand","text":"None","code":""},{"path":"https://www.camplab.net/musicatk/reference/annotate_replication_strand.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add replication strand annotation to SBS variants based on bedgraph file — annotate_replication_strand","text":"","code":"data(musica) data(rep_range) annotate_replication_strand(musica, rep_range)"},{"path":"https://www.camplab.net/musicatk/reference/annotate_transcript_strand.html","id":null,"dir":"Reference","previous_headings":"","what":"Add transcript strand annotation to SBS variants (defined in genes only) — annotate_transcript_strand","title":"Add transcript strand annotation to SBS variants (defined in genes only) — annotate_transcript_strand","text":"Add transcript strand annotation SBS variants (defined genes )","code":""},{"path":"https://www.camplab.net/musicatk/reference/annotate_transcript_strand.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add transcript strand annotation to SBS variants (defined in genes only) — annotate_transcript_strand","text":"","code":"annotate_transcript_strand(musica, genome_build, build_table = TRUE)"},{"path":"https://www.camplab.net/musicatk/reference/annotate_transcript_strand.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add transcript strand annotation to SBS variants (defined in genes only) — annotate_transcript_strand","text":"musica musica object. genome_build genome build use: hg19, hg38, custom TxDb object build_table Automatically build table annotation","code":""},{"path":"https://www.camplab.net/musicatk/reference/annotate_transcript_strand.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add transcript strand annotation to SBS variants (defined in genes only) — annotate_transcript_strand","text":"None","code":""},{"path":"https://www.camplab.net/musicatk/reference/annotate_transcript_strand.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add transcript strand annotation to SBS variants (defined in genes only) — annotate_transcript_strand","text":"","code":"data(musica) annotate_transcript_strand(musica, 19) #>   403 genes were dropped because they have exons located on both strands #>   of the same reference sequence or on more than one reference sequence, #>   so cannot be represented by a single genomic range. #>   Use 'single.strand.genes.only=FALSE' to get all the genes in a #>   GRangesList object, or use suppressMessages() to suppress this message."},{"path":"https://www.camplab.net/musicatk/reference/annotate_variant_length.html","id":null,"dir":"Reference","previous_headings":"","what":"Adds an annotation to the input musica's variant table with length of each variant — annotate_variant_length","title":"Adds an annotation to the input musica's variant table with length of each variant — annotate_variant_length","text":"Adds annotation input musica's variant table length variant","code":""},{"path":"https://www.camplab.net/musicatk/reference/annotate_variant_length.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adds an annotation to the input musica's variant table with length of each variant — annotate_variant_length","text":"","code":"annotate_variant_length(musica)"},{"path":"https://www.camplab.net/musicatk/reference/annotate_variant_length.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adds an annotation to the input musica's variant table with length of each variant — annotate_variant_length","text":"musica Input samples","code":""},{"path":"https://www.camplab.net/musicatk/reference/annotate_variant_length.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Adds an annotation to the input musica's variant table with length of each variant — annotate_variant_length","text":"None","code":""},{"path":"https://www.camplab.net/musicatk/reference/annotate_variant_length.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Adds an annotation to the input musica's variant table with length of each variant — annotate_variant_length","text":"","code":"data(musica) annotate_variant_length(musica) musica #> An object of class \"musica\" #> Slot \"variants\": #>         chr     start       end    ref    alt                       sample #>      <fctr>     <num>     <num> <char> <char>                       <fctr> #>   1:   chr1  11020563  11020563      C      A TCGA-94-7557-01A-11D-2122-08 #>   2:   chr1  43430030  43430030      G      T TCGA-94-7557-01A-11D-2122-08 #>   3:   chr1  58682403  58682403      A      G TCGA-94-7557-01A-11D-2122-08 #>   4:   chr1 109508295 109508295      C      G TCGA-94-7557-01A-11D-2122-08 #>   5:   chr1 156384826 156384826      A      C TCGA-94-7557-01A-11D-2122-08 #>  ---                                                                       #> 907:  chr19  54885292  54885292      G      A TCGA-ER-A19O-06A-11D-A197-08 #> 908:  chr20  49374328  49374328      A      T TCGA-ER-A19O-06A-11D-A197-08 #> 909:   chrX  73213768  73213768      T      G TCGA-ER-A19O-06A-11D-A197-08 #> 910:   chrX 101292834 101292834      G      A TCGA-ER-A19O-06A-11D-A197-08 #> 911:   chrX 107526690 107526690      C      T TCGA-ER-A19O-06A-11D-A197-08 #>      Variant_Type Variant_Length #>            <char>          <num> #>   1:          SBS              1 #>   2:          SBS              1 #>   3:          SBS              1 #>   4:          SBS              1 #>   5:          SBS              1 #>  ---                             #> 907:          SBS              1 #> 908:          SBS              1 #> 909:          SBS              1 #> 910:          SBS              1 #> 911:          SBS              1 #>  #> Slot \"count_tables\": #> $SBS96 #> Count_Table:  SBS96  #> Motifs: 96  #> Samples: 7  #>   #> **Annotations:  #>            motif mutation context #> C>A_ACA C>A_ACA      C>A     ACA #> C>A_ACC C>A_ACC      C>A     ACC #> C>A_ACG C>A_ACG      C>A     ACG #> C>A_ACT C>A_ACT      C>A     ACT #> C>A_CCA C>A_CCA      C>A     CCA #> C>A_CCC C>A_CCC      C>A     CCC #> 7           ...      ...     ...  #>  #> **Features:  #>    mutation #> 1  C>A_TCA #> 2  C>A_ACT #> 3  T>C_ATT #> 4  C>G_TCT #> 5  T>G_CTC #> 6  C>G_CCC #> 7      ...  #>  #> **Types:  #>  SBS #>   #> **Color Variable:  #>  mutation #>   #> **Color Mapping:  #>  #5ABCEBFF #>  #050708FF #>  #D33C32FF #>  #CBCACBFF #>  #ABCD72FF #>  #E7C9C6FF #>   #> **Descriptions:  #>  Single Base Substitution table with one base upstream and downstream #>  #>  #> Slot \"sample_annotations\": #>                        Samples Tumor_Subtypes #> 1 TCGA-94-7557-01A-11D-2122-08           Lung #> 2 TCGA-56-7582-01A-11D-2042-08           Lung #> 3 TCGA-77-7335-01A-11D-2042-08           Lung #> 4 TCGA-97-7938-01A-11D-2167-08           Lung #> 5 TCGA-EE-A3J5-06A-11D-A20D-08         Breast #> 6 TCGA-ER-A197-06A-32D-A197-08         Breast #> 7 TCGA-ER-A19O-06A-11D-A197-08         Breast #>  #> Slot \"result_list\": #> List of length 0 #>"},{"path":"https://www.camplab.net/musicatk/reference/annotate_variant_type.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate variants with variant type (","title":"Annotate variants with variant type (","text":"Annotate variants variant type (\"SBS\", \"INS\", \"DEl\", \"DBS\")","code":""},{"path":"https://www.camplab.net/musicatk/reference/annotate_variant_type.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate variants with variant type (","text":"","code":"annotate_variant_type(musica)"},{"path":"https://www.camplab.net/musicatk/reference/annotate_variant_type.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate variants with variant type (","text":"musica musica object.","code":""},{"path":"https://www.camplab.net/musicatk/reference/annotate_variant_type.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate variants with variant type (","text":"None","code":""},{"path":"https://www.camplab.net/musicatk/reference/annotate_variant_type.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate variants with variant type (","text":"","code":"data(musica) annotate_variant_type(musica)"},{"path":"https://www.camplab.net/musicatk/reference/auto_predict_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Automatic filtering of signatures for exposure prediction gridded across specific annotation — auto_predict_grid","title":"Automatic filtering of signatures for exposure prediction gridded across specific annotation — auto_predict_grid","text":"Automatic filtering signatures exposure prediction gridded across specific annotation","code":""},{"path":"https://www.camplab.net/musicatk/reference/auto_predict_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Automatic filtering of signatures for exposure prediction gridded across specific annotation — auto_predict_grid","text":"","code":"auto_predict_grid(   musica,   modality,   signature_res,   algorithm,   model_id = NULL,   result_name = \"result\",   sample_annotation = NULL,   min_exists = 0.05,   proportion_samples = 0.25,   rare_exposure = 0.4,   verbose = TRUE,   combine_res = TRUE,   make_copy = FALSE,   table_name = NULL )"},{"path":"https://www.camplab.net/musicatk/reference/auto_predict_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Automatic filtering of signatures for exposure prediction gridded across specific annotation — auto_predict_grid","text":"musica Input samples predict signature weights modality Modality used posterior prediction (e.g. SBS96) signature_res Signatures automatically subset prediction algorithm Algorithm use prediction. Choose \"lda_posterior\", decompTumor2Sig model_id Name model result_name Name result_list entry save results . Default \"result\". sample_annotation Annotation grid across, none given, prediction subsetting samples together min_exists Threshold consider signature active sample proportion_samples Threshold samples consider signature active cohort rare_exposure sample considered active cohort least one sample threshold proportion verbose Print current annotation value predicted combine_res Automatically combines list annotation results single result object zero exposure values signatures found given annotation's set samples make_copy FALSE, inputted musica object updated nothing returned. TRUE, new musica object created returned. Default FALSE. table_name Use modality instead","code":""},{"path":"https://www.camplab.net/musicatk/reference/auto_predict_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Automatic filtering of signatures for exposure prediction gridded across specific annotation — auto_predict_grid","text":"Returns nothing new musica object, depending make_copy parameter.","code":""},{"path":"https://www.camplab.net/musicatk/reference/auto_predict_grid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Automatic filtering of signatures for exposure prediction gridded across specific annotation — auto_predict_grid","text":"","code":"data(musica_annot) data(cosmic_v2_sigs) auto_predict_grid(   musica = musica_annot, modality = \"SBS96\",   signature_res = cosmic_v2_sigs, algorithm = \"lda\",   sample_annotation = \"Tumor_Subtypes\" ) #> Lung #> Breast auto_predict_grid(musica_annot, \"SBS96\", cosmic_v2_sigs, \"lda\")"},{"path":"https://www.camplab.net/musicatk/reference/auto_subset_sigs.html","id":null,"dir":"Reference","previous_headings":"","what":"Automatic filtering of inactive signatures — auto_subset_sigs","title":"Automatic filtering of inactive signatures — auto_subset_sigs","text":"Automatic filtering inactive signatures","code":""},{"path":"https://www.camplab.net/musicatk/reference/auto_subset_sigs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Automatic filtering of inactive signatures — auto_subset_sigs","text":"","code":"auto_subset_sigs(   musica,   modality,   signature_res,   algorithm,   min_exists = 0.05,   proportion_samples = 0.25,   rare_exposure = 0.4,   result_name = \"result\",   model_id = NULL )"},{"path":"https://www.camplab.net/musicatk/reference/auto_subset_sigs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Automatic filtering of inactive signatures — auto_subset_sigs","text":"musica musica object. modality Modality used posterior prediction (e.g. SBS96) signature_res Signatures automatically subset prediction algorithm Algorithm use prediction. Choose \"lda_posterior\" decompTumor2Sig min_exists Threshold consider signature active sample proportion_samples Threshold samples consider signature active cohort rare_exposure sample considered active cohort least one sample threshold proportion result_name Name result_list entry save results . Default \"result\". model_id Identifier result. NULL, automatically set algorithm number signatures. Default NULL.","code":""},{"path":"https://www.camplab.net/musicatk/reference/auto_subset_sigs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Automatic filtering of inactive signatures — auto_subset_sigs","text":"Returns new musica object results.","code":""},{"path":"https://www.camplab.net/musicatk/reference/build_custom_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Builds a custom table from specified user variants — build_custom_table","title":"Builds a custom table from specified user variants — build_custom_table","text":"Builds custom table specified user variants","code":""},{"path":"https://www.camplab.net/musicatk/reference/build_custom_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Builds a custom table from specified user variants — build_custom_table","text":"","code":"build_custom_table(   musica,   variant_annotation,   name,   description = character(),   data_factor = NA,   annotation_df = NULL,   features = NULL,   type = NULL,   color_variable = NULL,   color_mapping = NULL,   return_instead = FALSE,   overwrite = FALSE )"},{"path":"https://www.camplab.net/musicatk/reference/build_custom_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Builds a custom table from specified user variants — build_custom_table","text":"musica musica object. variant_annotation User column use building table name Table name refer (must unique) description Optional description table content data_factor Full set table values, case missing data. NA, superset available unique data values used annotation_df data.frame annotations use plotting features data.frame input data count table built type type data/mutation feature Rle object color_variable name column annotation_df used coloring plots color_mapping mapping values selected color_variable column color values plotting return_instead Instead adding musica object, return created table overwrite Overwrite existing count table","code":""},{"path":"https://www.camplab.net/musicatk/reference/build_custom_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Builds a custom table from specified user variants — build_custom_table","text":"return_instead = TRUE created table object returned, otherwise table object automatically added musica's count_tables list nothing returned","code":""},{"path":"https://www.camplab.net/musicatk/reference/build_custom_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Builds a custom table from specified user variants — build_custom_table","text":"","code":"data(musica) annotate_transcript_strand(musica, \"19\", build_table = FALSE) #>   403 genes were dropped because they have exons located on both strands #>   of the same reference sequence or on more than one reference sequence, #>   so cannot be represented by a single genomic range. #>   Use 'single.strand.genes.only=FALSE' to get all the genes in a #>   GRangesList object, or use suppressMessages() to suppress this message. build_custom_table(musica, \"Transcript_Strand\", \"Transcript_Strand\",   data_factor = factor(c(\"T\", \"U\")) )"},{"path":"https://www.camplab.net/musicatk/reference/build_standard_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Builds count tables using various mutation type schemas — build_standard_table","title":"Builds count tables using various mutation type schemas — build_standard_table","text":"Generates count tables different mutation type schemas can used input mutational signature discovery prediction functions. \"SBS96\" generates table single base substitutions following standard 96 mutation types derived trinucleotide context. \"SBS192\" 96 mutation type schema addition transcriptional strand replication strand information added base. \"DBS\" generates table double base substitution schema used COSMIC V3. \"Indel\" generates table insertions deletions following schema used COSMIC V3.","code":""},{"path":"https://www.camplab.net/musicatk/reference/build_standard_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Builds count tables using various mutation type schemas — build_standard_table","text":"","code":"build_standard_table(   musica,   g,   modality,   strand_type = NULL,   overwrite = FALSE,   verbose = FALSE,   table_name = NULL )"},{"path":"https://www.camplab.net/musicatk/reference/build_standard_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Builds count tables using various mutation type schemas — build_standard_table","text":"musica musica object. g BSgenome object indicating genome reference variants coordinates derived . modality Modality table build. One \"SBS96\", \"SBS192\", \"DBS\", \"Indel\". strand_type Strand type use SBS192 schema. One \"Transcript_Strand\" \"Replication_Strand\". used modality = SBS192. overwrite TRUE, existing count table name overwritten. FALSE, error thrown table name exists within musica object. verbose Show progress bar processed samples table_name Use modality instead","code":""},{"path":"https://www.camplab.net/musicatk/reference/build_standard_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Builds count tables using various mutation type schemas — build_standard_table","text":"object returned. count tables automatically added musica object.","code":""},{"path":"https://www.camplab.net/musicatk/reference/build_standard_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Builds count tables using various mutation type schemas — build_standard_table","text":"","code":"g <- select_genome(\"19\")  data(musica) build_standard_table(musica, g, \"SBS96\", overwrite = TRUE) #> Building count table from SBS with SBS96 schema #> Warning: Overwriting counts table: SBS96  data(musica) annotate_transcript_strand(musica, \"19\") #>   403 genes were dropped because they have exons located on both strands #>   of the same reference sequence or on more than one reference sequence, #>   so cannot be represented by a single genomic range. #>   Use 'single.strand.genes.only=FALSE' to get all the genes in a #>   GRangesList object, or use suppressMessages() to suppress this message. build_standard_table(musica, g, \"SBS192\", \"Transcript_Strand\") #> Building count table from SBS and Transcript_Strand with SBS192 schema  data(musica) data(rep_range) annotate_replication_strand(musica, rep_range) build_standard_table(musica, g, \"SBS192\", \"Replication_Strand\") #> Building count table from SBS and Replication_Strand with SBS192 schema  data(dbs_musica) build_standard_table(dbs_musica, g, \"DBS\", overwrite = TRUE) #> Building count table from DBS with DBS78 schema #> Warning: Overwriting counts table: DBS78  data(indel_musica) build_standard_table(indel_musica, g, modality = \"INDEL\") #> Building count table from INDELs with IND83 schema"},{"path":"https://www.camplab.net/musicatk/reference/built_tables.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve the names of count_tables from a musica object — built_tables","title":"Retrieve the names of count_tables from a musica object — built_tables","text":"count_tables contains standard /custom count tables created variants","code":""},{"path":"https://www.camplab.net/musicatk/reference/built_tables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve the names of count_tables from a musica object — built_tables","text":"","code":"built_tables(object)  # S4 method for class 'musica' built_tables(object)"},{"path":"https://www.camplab.net/musicatk/reference/built_tables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve the names of count_tables from a musica object — built_tables","text":"object musica object generated create_musica_from_variants create_musica_from_counts function.","code":""},{"path":"https://www.camplab.net/musicatk/reference/built_tables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve the names of count_tables from a musica object — built_tables","text":"names created count_tables","code":""},{"path":"https://www.camplab.net/musicatk/reference/built_tables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve the names of count_tables from a musica object — built_tables","text":"","code":"data(res) built_tables(res) #> [1] \"SBS96\""},{"path":"https://www.camplab.net/musicatk/reference/cluster_exposure.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform clustering analysis from a musica result object — cluster_exposure","title":"Perform clustering analysis from a musica result object — cluster_exposure","text":"Proportional sample exposures used input perform clustering.","code":""},{"path":"https://www.camplab.net/musicatk/reference/cluster_exposure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform clustering analysis from a musica result object — cluster_exposure","text":"","code":"cluster_exposure(   musica,   model_name,   modality = \"SBS96\",   result_name = \"result\",   nclust,   proportional = TRUE,   method = \"kmeans\",   dis.method = \"euclidean\",   hc.method = \"ward.D\",   clara.samples = 5,   iter.max = 10,   tol = 1e-15 )"},{"path":"https://www.camplab.net/musicatk/reference/cluster_exposure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform clustering analysis from a musica result object — cluster_exposure","text":"musica musica object containing mutational discovery prediction. model_name name desired model. modality modality model. Must \"SBS96\", \"DBS78\", \"IND83\". Default \"SBS96\". result_name Name result list entry containing desired model. Default \"result\". nclust Pre-defined number clusters. proportional Logical, indicating proportional exposure (default) used clustering. method Clustering algorithms. Options \"kmeans\" (K-means), \"hkmeans\" (hybrid hierarchical K-means), \"hclust\" (hierarchical clustering), \"pam\" (PAM), \"clara\" (Clara). dis.method Methods calculate dissimilarity matrix. Options \"euclidean\" (default), \"manhattan\", \"jaccard\", \"cosine\", \"canberra\". hc.method Methods perform hierarchical clustering. Options \"ward.D\" (default), \"ward.D2\", \"single\", \"complete\", \"average\", \"mcquitty\", \"median\", \"centroid\". clara.samples Number samples drawn dataset. used \"clara\" selected. Default 5. iter.max Maximum number iterations k-means clustering. tol Tolerance level kmeans clustering level iterations","code":""},{"path":"https://www.camplab.net/musicatk/reference/cluster_exposure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform clustering analysis from a musica result object — cluster_exposure","text":"one-column data frame sample IDs row names cluster number sample.","code":""},{"path":[]},{"path":"https://www.camplab.net/musicatk/reference/cluster_exposure.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform clustering analysis from a musica result object — cluster_exposure","text":"","code":"set.seed(123) data(res_annot) clust_out <- cluster_exposure(res_annot, model_name = \"res_annot\", nclust = 2) #> Metric: 'euclidean'; comparing: 7 vectors. #> Warning: FANNY algorithm has not converged in 'maxit' = 10 iterations"},{"path":"https://www.camplab.net/musicatk/reference/combine_count_tables.html","id":null,"dir":"Reference","previous_headings":"","what":"Combines tables into a single table that can be used for discovery/prediction — combine_count_tables","title":"Combines tables into a single table that can be used for discovery/prediction — combine_count_tables","text":"Combines tables single table can used discovery/prediction","code":""},{"path":"https://www.camplab.net/musicatk/reference/combine_count_tables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combines tables into a single table that can be used for discovery/prediction — combine_count_tables","text":"","code":"combine_count_tables(   musica,   to_comb,   name,   description = character(),   color_variable = character(),   color_mapping = character(),   overwrite = FALSE )"},{"path":"https://www.camplab.net/musicatk/reference/combine_count_tables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combines tables into a single table that can be used for discovery/prediction — combine_count_tables","text":"musica musica object. to_comb vector table names combine. table must already exist within input musica object name Name table build, must new name description Description new table color_variable Annotation column use coloring plotted motifs, provided counts table input result's musica object color_mapping Mapping color_variable color names, provided counts table input result's musica object overwrite Overwrite existing count table","code":""},{"path":"https://www.camplab.net/musicatk/reference/combine_count_tables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combines tables into a single table that can be used for discovery/prediction — combine_count_tables","text":"None","code":""},{"path":"https://www.camplab.net/musicatk/reference/combine_count_tables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combines tables into a single table that can be used for discovery/prediction — combine_count_tables","text":"","code":"g <- select_genome(\"19\")  data(musica) build_standard_table(musica, g, \"SBS96\", overwrite = TRUE) #> Building count table from SBS with SBS96 schema #> Warning: Overwriting counts table: SBS96  annotate_transcript_strand(musica, \"19\") #>   403 genes were dropped because they have exons located on both strands #>   of the same reference sequence or on more than one reference sequence, #>   so cannot be represented by a single genomic range. #>   Use 'single.strand.genes.only=FALSE' to get all the genes in a #>   GRangesList object, or use suppressMessages() to suppress this message. build_standard_table(musica, g, \"SBS192\", \"Transcript_Strand\") #> Building count table from SBS and Transcript_Strand with SBS192 schema  combine_count_tables(musica, c(\"SBS96\", \"SBS192_Trans\"), \"combo\")"},{"path":"https://www.camplab.net/musicatk/reference/combine_predict_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine signatures and exposures of different models. Exposure values are zero for samples in an annotation where that signature was not predicted — combine_predict_grid","title":"Combine signatures and exposures of different models. Exposure values are zero for samples in an annotation where that signature was not predicted — combine_predict_grid","text":"Combine signatures exposures different models. Exposure values zero samples annotation signature predicted","code":""},{"path":"https://www.camplab.net/musicatk/reference/combine_predict_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine signatures and exposures of different models. Exposure values are zero for samples in an annotation where that signature was not predicted — combine_predict_grid","text":"","code":"combine_predict_grid(   musica,   modality,   signature_res,   model_ids = NULL,   result_name = \"result\",   model_rename = NULL,   make_copy = FALSE,   table_name = NULL )"},{"path":"https://www.camplab.net/musicatk/reference/combine_predict_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine signatures and exposures of different models. Exposure values are zero for samples in an annotation where that signature was not predicted — combine_predict_grid","text":"musica musica object. modality Modality used prediction. signature_res Signatures automatically subset prediction model_ids Vector ids models combine. null, models modality result_list entry combined. Default NULL. result_name Name result list entry containing signatures plot. Default \"result\". model_rename New model identifier. null, combination ids models combined. Deafult NULL. make_copy FALSE, inputted musica object updated nothing returned. TRUE, new musica object created returned. Default FALSE. table_name Use modality instead","code":""},{"path":"https://www.camplab.net/musicatk/reference/combine_predict_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine signatures and exposures of different models. Exposure values are zero for samples in an annotation where that signature was not predicted — combine_predict_grid","text":"Returns nothing new musica object, depending make_copy parameter.","code":""},{"path":"https://www.camplab.net/musicatk/reference/combine_predict_grid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combine signatures and exposures of different models. Exposure values are zero for samples in an annotation where that signature was not predicted — combine_predict_grid","text":"","code":"data(musica_annot) data(cosmic_v2_sigs) grid <- auto_predict_grid(musica_annot, \"SBS96\", cosmic_v2_sigs, \"lda\",   \"Tumor_Subtypes\",   combine_res = FALSE, make_copy = TRUE ) combined <- combine_predict_grid(grid, \"SBS96\", cosmic_v2_sigs, make_copy = TRUE)"},{"path":"https://www.camplab.net/musicatk/reference/compare_cosmic_v2.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare a result object to COSMIC V2 SBS Signatures (combination whole-exome and whole-genome) — compare_cosmic_v2","title":"Compare a result object to COSMIC V2 SBS Signatures (combination whole-exome and whole-genome) — compare_cosmic_v2","text":"Compare result object COSMIC V2 SBS Signatures (combination whole-exome whole-genome)","code":""},{"path":"https://www.camplab.net/musicatk/reference/compare_cosmic_v2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare a result object to COSMIC V2 SBS Signatures (combination whole-exome and whole-genome) — compare_cosmic_v2","text":"","code":"compare_cosmic_v2(   musica,   model_id,   modality = \"SBS96\",   result_name = \"result\",   metric = \"cosine\",   threshold = 0.9,   result_rename = deparse(substitute(result)),   decimals = 2,   same_scale = FALSE )"},{"path":"https://www.camplab.net/musicatk/reference/compare_cosmic_v2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare a result object to COSMIC V2 SBS Signatures (combination whole-exome and whole-genome) — compare_cosmic_v2","text":"musica musica object. model_id name model containing signatures compare. modality Compare SBS, DBS, Indel. Default \"SBS96\" result_name Name result list entry. Default \"result\". metric One \"cosine\" cosine similarity \"jsd\" 1 minus Jensen-Shannon Divergence. Default \"cosine\". threshold threshold similarity result_rename title plot user result signatures decimals Specifies rounding similarity metric displayed. Default 2. same_scale TRUE, scale probability signature . FALSE, scale y-axis adjusted signature. Default TRUE.","code":""},{"path":"https://www.camplab.net/musicatk/reference/compare_cosmic_v2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare a result object to COSMIC V2 SBS Signatures (combination whole-exome and whole-genome) — compare_cosmic_v2","text":"Returns comparisons","code":""},{"path":"https://www.camplab.net/musicatk/reference/compare_cosmic_v2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare a result object to COSMIC V2 SBS Signatures (combination whole-exome and whole-genome) — compare_cosmic_v2","text":"","code":"data(res) compare_cosmic_v2(res, model_id = \"res\", threshold = 0.7)  #>      cosine x_sig_index y_sig_index x_sig_name y_sig_name #> 4 0.9742418           3           7 Signature3       SBS7 #> 5 0.7730161           3          11 Signature3      SBS11 #> 6 0.7568463           3          30 Signature3      SBS30 #> 1 0.7337470           1          13 Signature1      SBS13 #> 2 0.7296889           2           5 Signature2       SBS5 #> 3 0.7107142           2          19 Signature2      SBS19"},{"path":"https://www.camplab.net/musicatk/reference/compare_cosmic_v3.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare a result object to COSMIC V3 Signatures; Select exome or genome for SBS and only genome for DBS or Indel classes — compare_cosmic_v3","title":"Compare a result object to COSMIC V3 Signatures; Select exome or genome for SBS and only genome for DBS or Indel classes — compare_cosmic_v3","text":"Compare result object COSMIC V3 Signatures; Select exome genome SBS genome DBS Indel classes","code":""},{"path":"https://www.camplab.net/musicatk/reference/compare_cosmic_v3.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare a result object to COSMIC V3 Signatures; Select exome or genome for SBS and only genome for DBS or Indel classes — compare_cosmic_v3","text":"","code":"compare_cosmic_v3(   musica,   model_id,   sample_type,   modality = \"SBS96\",   result_name = \"result\",   metric = \"cosine\",   threshold = 0.9,   result_rename = deparse(substitute(model_id)),   decimals = 2,   same_scale = FALSE )"},{"path":"https://www.camplab.net/musicatk/reference/compare_cosmic_v3.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare a result object to COSMIC V3 Signatures; Select exome or genome for SBS and only genome for DBS or Indel classes — compare_cosmic_v3","text":"musica musica object. model_id name model containing signatures compare. sample_type exome (SBS ) genome modality Compare SBS, DBS, Indel. Default \"SBS96\" result_name Name result list entry. Default \"result\". metric One \"cosine\" cosine similarity \"jsd\" 1 minus Jensen-Shannon Divergence. Default \"cosine\". threshold threshold similarity result_rename title plot user result signatures decimals Specifies rounding similarity metric displayed. Default 2. same_scale TRUE, scale probability signature . FALSE, scale y-axis adjusted signature. Default TRUE.","code":""},{"path":"https://www.camplab.net/musicatk/reference/compare_cosmic_v3.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare a result object to COSMIC V3 Signatures; Select exome or genome for SBS and only genome for DBS or Indel classes — compare_cosmic_v3","text":"Returns comparisons","code":""},{"path":"https://www.camplab.net/musicatk/reference/compare_cosmic_v3.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare a result object to COSMIC V3 Signatures; Select exome or genome for SBS and only genome for DBS or Indel classes — compare_cosmic_v3","text":"","code":"data(res) compare_cosmic_v3(res,   model_id = \"res\", modality = \"SBS96\",   sample_type = \"genome\", threshold = 0.8 )  #>      cosine x_sig_index y_sig_index x_sig_name y_sig_name #> 2 0.9028629           3           8 Signature3      SBS7b #> 1 0.8877524           3           7 Signature3      SBS7a"},{"path":"https://www.camplab.net/musicatk/reference/compare_k_vals.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare k values — compare_k_vals","title":"Compare k values — compare_k_vals","text":"Compare stability error various k values help determine correct number signatures (k).","code":""},{"path":"https://www.camplab.net/musicatk/reference/compare_k_vals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare k values — compare_k_vals","text":"","code":"compare_k_vals(   musica,   modality,   reps = 100,   min_k = 1,   max_k = 10,   error_type = \"prop\",   algorithm = \"nmf\" )"},{"path":"https://www.camplab.net/musicatk/reference/compare_k_vals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare k values — compare_k_vals","text":"musica musica object. modality modality use, either \"SBS96\", \"DBS78\", \"IND83\". reps Number times prediction performed. replicate, count table data perturbed. Multiple replicates allows stability analysis calculating silhouette width multiple results. Default 100. min_k Lower range number signatures discovery. Default 1. max_k Upper range number signatures discovery. Default 10. error_type Whether calculate reconstruction error proportions (\"prop\") raw counts (\"raw\"). Default \"prop\". algorithm Algorithm signature discovery. Default \"nmf\".","code":""},{"path":"https://www.camplab.net/musicatk/reference/compare_k_vals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare k values — compare_k_vals","text":"data.frame stats k value tested","code":""},{"path":"https://www.camplab.net/musicatk/reference/compare_k_vals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare k values — compare_k_vals","text":"","code":"data(musica) compare_k_vals(musica, \"SBS96\", reps = 3, min_k = 1, max_k = 5) #>  #> k = 1: #> Calculating signatures on original count table... #>  #> Replicate 1 of 3... #> Replicate 2 of 3... #> Replicate 3 of 3... #>  #> k = 2: #> Calculating signatures on original count table... #>  #> Replicate 1 of 3... #> Replicate 2 of 3... #> Replicate 3 of 3... #>  #> k = 3: #> Calculating signatures on original count table... #>  #> Replicate 1 of 3... #> Replicate 2 of 3... #> Replicate 3 of 3... #>  #> k = 4: #> Calculating signatures on original count table... #>  #> Replicate 1 of 3... #> Replicate 2 of 3... #> Replicate 3 of 3... #>  #> k = 5: #> Calculating signatures on original count table... #>  #> Replicate 1 of 3... #> Replicate 2 of 3... #> Replicate 3 of 3... #> Warning: Removed 1 row containing missing values or values outside the scale range #> (`geom_line()`). #> Warning: Removed 1 row containing missing values or values outside the scale range #> (`geom_point()`).  #>   k  sil_width min_sil_width max_sil_width sd_sil_width sterror_sil_width #> 1 1         NA            NA            NA           NA                NA #> 2 2 0.76434462    0.73576651     0.8038029    0.0210121       0.007428898 #> 3 3 0.43603280   -0.07114908     0.8078214    0.2949283       0.085138456 #> 4 4 0.09268357   -0.27594425     0.8124093    0.4133481       0.103337018 #> 5 5 0.06672168   -0.31252943     0.8107605    0.3758637       0.084045671 #>      error min_error max_error  sd_error sterror_error #> 1 7.009688  6.430394  7.412877 0.4139008     0.2069504 #> 2 5.096309  4.654886  5.443521 0.3370649     0.1685324 #> 3 4.395687  4.031071  4.682656 0.2697601     0.1348800 #> 4 3.379200  3.217509  3.729880 0.2376476     0.1188238 #> 5 2.478940  2.305402  2.793636 0.2163521     0.1081761"},{"path":"https://www.camplab.net/musicatk/reference/compare_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare two result files to find similar signatures — compare_results","title":"Compare two result files to find similar signatures — compare_results","text":"Compare two result files find similar signatures","code":""},{"path":"https://www.camplab.net/musicatk/reference/compare_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare two result files to find similar signatures — compare_results","text":"","code":"compare_results(   musica,   model_id,   other_model_id,   modality = \"SBS96\",   result_name = \"result\",   other_musica = NULL,   other_result_name = \"result\",   threshold = 0.9,   metric = \"cosine\",   result_rename = deparse(substitute(model_id)),   other_result_rename = deparse(substitute(other_model_id)),   decimals = 2,   same_scale = FALSE )"},{"path":"https://www.camplab.net/musicatk/reference/compare_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare two result files to find similar signatures — compare_results","text":"musica musica object. model_id name first model compare. other_model_id name second model compare. modality Modality results compared. Default \"SBS96\". result_name Name result list entry first result compare. Default \"result\". other_musica second musica object. null, provided musica object used twice. Default NULL. other_result_name Name result list entry second result compare. Default \"result\". threshold threshold similarity metric One \"cosine\" cosine similarity \"jsd\" 1 minus Jensen-Shannon Divergence. Default \"cosine\". result_rename title plot first result signatures other_result_rename title plot second result signatures decimals Specifies rounding similarity metric displayed. Default 2. same_scale TRUE, scale probability signature . FALSE, scale y-axis adjusted signature. Default FALSE.","code":""},{"path":"https://www.camplab.net/musicatk/reference/compare_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare two result files to find similar signatures — compare_results","text":"Returns comparisons","code":""},{"path":"https://www.camplab.net/musicatk/reference/compare_results.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare two result files to find similar signatures — compare_results","text":"","code":"data(res) compare_results(res,   model_id = \"res\", other_model_id = \"res\",   modality = \"SBS96\", threshold = 0.8 )  #>   cosine x_sig_index y_sig_index x_sig_name y_sig_name #> 1      1           1           1 Signature1 Signature1 #> 2      1           2           2 Signature2 Signature2 #> 3      1           3           3 Signature3 Signature3"},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v2_sigs.html","id":null,"dir":"Reference","previous_headings":"","what":"COSMIC v2 SBS96 Signatures Result Object — cosmic_v2_sigs","title":"COSMIC v2 SBS96 Signatures Result Object — cosmic_v2_sigs","text":"Data COSMIC formatted used prediction individual tumors cohorts.","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v2_sigs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"COSMIC v2 SBS96 Signatures Result Object — cosmic_v2_sigs","text":"","code":"data(cosmic_v2_sigs)"},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v2_sigs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"COSMIC v2 SBS96 Signatures Result Object — cosmic_v2_sigs","text":"object class result_model See [predict_exposure()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v2_sigs.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"COSMIC v2 SBS96 Signatures Result Object — cosmic_v2_sigs","text":"COSMIC v2, <https://cancer.sanger.ac.uk/cosmic/signatures_v2>","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v2_sigs.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"COSMIC v2 SBS96 Signatures Result Object — cosmic_v2_sigs","text":"Alexandrov, L., Nik-Zainal, S., Wedge, D. et al. (2013) Signatures mutational processes human cancer. Nature 500, 415–421 ([Nature](https://www.ncbi.nlm.nih.gov/pubmed/23945592))","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v2_subtype_map.html","id":null,"dir":"Reference","previous_headings":"","what":"Input a cancer subtype to return a list of related COSMIC signatures — cosmic_v2_subtype_map","title":"Input a cancer subtype to return a list of related COSMIC signatures — cosmic_v2_subtype_map","text":"Input cancer subtype return list related COSMIC signatures","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v2_subtype_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Input a cancer subtype to return a list of related COSMIC signatures — cosmic_v2_subtype_map","text":"","code":"cosmic_v2_subtype_map(tumor_type)"},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v2_subtype_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Input a cancer subtype to return a list of related COSMIC signatures — cosmic_v2_subtype_map","text":"tumor_type Cancer subtype view related signatures","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v2_subtype_map.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Input a cancer subtype to return a list of related COSMIC signatures — cosmic_v2_subtype_map","text":"Returns signatures related partial string match","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v2_subtype_map.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Input a cancer subtype to return a list of related COSMIC signatures — cosmic_v2_subtype_map","text":"","code":"cosmic_v2_subtype_map(\"lung\") #> lung adeno #> 124561317 #> lung  small cell #> 14515 #> lung  squamous #> 124513"},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_dbs_sigs.html","id":null,"dir":"Reference","previous_headings":"","what":"COSMIC v3 DBS Genome Signatures Result Object — cosmic_v3_dbs_sigs","title":"COSMIC v3 DBS Genome Signatures Result Object — cosmic_v3_dbs_sigs","text":"Data COSMIC formatted used prediction individual tumors cohorts.","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_dbs_sigs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"COSMIC v3 DBS Genome Signatures Result Object — cosmic_v3_dbs_sigs","text":"","code":"data(cosmic_v3_dbs_sigs)"},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_dbs_sigs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"COSMIC v3 DBS Genome Signatures Result Object — cosmic_v3_dbs_sigs","text":"object class result_model. See [predict_exposure()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_dbs_sigs.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"COSMIC v3 DBS Genome Signatures Result Object — cosmic_v3_dbs_sigs","text":"COSMIC v3, <https://cancer.sanger.ac.uk/cosmic/signatures>","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_dbs_sigs.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"COSMIC v3 DBS Genome Signatures Result Object — cosmic_v3_dbs_sigs","text":"Alexandrov, L.B., Kim, J., Haradhvala, N.J. et al. (2020) repertoire mutational signatures human cancer. Nature 578, 94–101 ([Nature](https://doi.org/10.1038/s41586-020-1943-3))","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_indel_sigs.html","id":null,"dir":"Reference","previous_headings":"","what":"COSMIC v3 Indel Genome Signatures Result Object — cosmic_v3_indel_sigs","title":"COSMIC v3 Indel Genome Signatures Result Object — cosmic_v3_indel_sigs","text":"Data COSMIC formatted used prediction individual tumors cohorts.","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_indel_sigs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"COSMIC v3 Indel Genome Signatures Result Object — cosmic_v3_indel_sigs","text":"","code":"data(cosmic_v3_indel_sigs)"},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_indel_sigs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"COSMIC v3 Indel Genome Signatures Result Object — cosmic_v3_indel_sigs","text":"object class result_model. See [predict_exposure()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_indel_sigs.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"COSMIC v3 Indel Genome Signatures Result Object — cosmic_v3_indel_sigs","text":"COSMIC v3, <https://cancer.sanger.ac.uk/cosmic/signatures>","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_indel_sigs.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"COSMIC v3 Indel Genome Signatures Result Object — cosmic_v3_indel_sigs","text":"Alexandrov, L.B., Kim, J., Haradhvala, N.J. et al. (2020) repertoire mutational signatures human cancer. Nature 578, 94–101 ([Nature](https://doi.org/10.1038/s41586-020-1943-3))","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_sbs_sigs.html","id":null,"dir":"Reference","previous_headings":"","what":"COSMIC v3 SBS96 Genome Signatures Result Object — cosmic_v3_sbs_sigs","title":"COSMIC v3 SBS96 Genome Signatures Result Object — cosmic_v3_sbs_sigs","text":"Data COSMIC formatted used prediction individual tumors cohorts.","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_sbs_sigs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"COSMIC v3 SBS96 Genome Signatures Result Object — cosmic_v3_sbs_sigs","text":"","code":"data(cosmic_v3_sbs_sigs)"},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_sbs_sigs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"COSMIC v3 SBS96 Genome Signatures Result Object — cosmic_v3_sbs_sigs","text":"object class result_model. See [predict_exposure()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_sbs_sigs.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"COSMIC v3 SBS96 Genome Signatures Result Object — cosmic_v3_sbs_sigs","text":"COSMIC v3, <https://cancer.sanger.ac.uk/cosmic/signatures>","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_sbs_sigs.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"COSMIC v3 SBS96 Genome Signatures Result Object — cosmic_v3_sbs_sigs","text":"Alexandrov, L.B., Kim, J., Haradhvala, N.J. et al. (2020) repertoire mutational signatures human cancer. Nature 578, 94–101 ([Nature](https://doi.org/10.1038/s41586-020-1943-3))","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_sbs_sigs_exome.html","id":null,"dir":"Reference","previous_headings":"","what":"COSMIC v3 SBS96 Exome Signatures Result Object — cosmic_v3_sbs_sigs_exome","title":"COSMIC v3 SBS96 Exome Signatures Result Object — cosmic_v3_sbs_sigs_exome","text":"Data COSMIC formatted used prediction individual tumors cohorts.","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_sbs_sigs_exome.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"COSMIC v3 SBS96 Exome Signatures Result Object — cosmic_v3_sbs_sigs_exome","text":"","code":"data(cosmic_v3_sbs_sigs_exome)"},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_sbs_sigs_exome.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"COSMIC v3 SBS96 Exome Signatures Result Object — cosmic_v3_sbs_sigs_exome","text":"object class result_model. See [predict_exposure()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_sbs_sigs_exome.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"COSMIC v3 SBS96 Exome Signatures Result Object — cosmic_v3_sbs_sigs_exome","text":"COSMIC v3, <https://cancer.sanger.ac.uk/cosmic/signatures>","code":""},{"path":"https://www.camplab.net/musicatk/reference/cosmic_v3_sbs_sigs_exome.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"COSMIC v3 SBS96 Exome Signatures Result Object — cosmic_v3_sbs_sigs_exome","text":"Alexandrov, L.B., Kim, J., Haradhvala, N.J. et al. (2020) repertoire mutational signatures human cancer. Nature 578, 94–101 ([Nature](https://doi.org/10.1038/s41586-020-1943-3))","code":""},{"path":"https://www.camplab.net/musicatk/reference/count_table-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Object containing the count table matrices, their names and descriptions that we generated by provided and by user functions. These are used to discover and infer signatures and exposures. — count_table-class","title":"Object containing the count table matrices, their names and descriptions that we generated by provided and by user functions. These are used to discover and infer signatures and exposures. — count_table-class","text":"Object containing count table matrices, names descriptions generated provided user functions. used discover infer signatures exposures.","code":""},{"path":"https://www.camplab.net/musicatk/reference/count_table-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Object containing the count table matrices, their names and descriptions that we generated by provided and by user functions. These are used to discover and infer signatures and exposures. — count_table-class","text":"name name describes type table (e.g. \"SBS96\") count_table array counts samples columns motifs rows annotation data.frame annotations three columns used plotting: motif, mutation, context features Original features used generate count_table type mutation type feature, case need plot model differently color_variable variable used plotting colors, selected annotation slot color_mapping mapping annotations chosen color_variable color values plotting description summary table result objects result_list list lists. nested lists created combined (rbind) tables, tables first list level modelled independantly. Combined tables must named. list(\"tableA\", comboTable = list(\"tableC\", \"tableD\"))","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_dbs78_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Creates and adds a table for standard doublet base subsitution (DBS) — create_dbs78_table","title":"Creates and adds a table for standard doublet base subsitution (DBS) — create_dbs78_table","text":"Creates adds table standard doublet base subsitution (DBS)","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_dbs78_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creates and adds a table for standard doublet base subsitution (DBS) — create_dbs78_table","text":"","code":"create_dbs78_table(musica, overwrite = overwrite, verbose)"},{"path":"https://www.camplab.net/musicatk/reference/create_dbs78_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creates and adds a table for standard doublet base subsitution (DBS) — create_dbs78_table","text":"musica musica object. overwrite Overwrite existing count table","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_dbs78_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Creates and adds a table for standard doublet base subsitution (DBS) — create_dbs78_table","text":"Returns created DBS table object","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_musica_from_counts.html","id":null,"dir":"Reference","previous_headings":"","what":"Creates a musica object from a mutation count table — create_musica_from_counts","title":"Creates a musica object from a mutation count table — create_musica_from_counts","text":"function creates musica object mutation count table matrix. musica class stores variants information, variant-level annotations, sample-level annotations, count tables used input mutational signature discovery prediction algorithms.","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_musica_from_counts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creates a musica object from a mutation count table — create_musica_from_counts","text":"","code":"create_musica_from_counts(x, variant_class)"},{"path":"https://www.camplab.net/musicatk/reference/create_musica_from_counts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creates a musica object from a mutation count table — create_musica_from_counts","text":"x data.table, matrix, data.frame contains counts mutation types sample, samples columns. variant_class Mutations SBS, DBS, Indel.","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_musica_from_counts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Creates a musica object from a mutation count table — create_musica_from_counts","text":"Returns musica object","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_musica_from_counts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Creates a musica object from a mutation count table — create_musica_from_counts","text":"","code":"data(musica) count_table <- get_count_table(extract_count_tables(musica)$SBS96) musica <- create_musica_from_counts(count_table, \"SBS96\")"},{"path":"https://www.camplab.net/musicatk/reference/create_musica_from_variants.html","id":null,"dir":"Reference","previous_headings":"","what":"Creates a musica object from a variant table — create_musica_from_variants","title":"Creates a musica object from a variant table — create_musica_from_variants","text":"function creates musica object variant table matrix. musica class stores variants information, variant-level annotations, sample-level annotations, count tables used input mutational signature discovery prediction algorithms. input variant table matrix must columns chromosome, start position, end position, reference allele, alternate allele, sample names. column names variant table can mapped using chromosome_col, start_col, end_col, ref_col, alt_col, sample_col parameters.","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_musica_from_variants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creates a musica object from a variant table — create_musica_from_variants","text":"","code":"create_musica_from_variants(   x,   genome,   check_ref_chromosomes = TRUE,   check_ref_bases = TRUE,   chromosome_col = \"chr\",   start_col = \"start\",   end_col = \"end\",   ref_col = \"ref\",   alt_col = \"alt\",   sample_col = \"sample\",   extra_fields = NULL,   standardize_indels = TRUE,   convert_dbs = TRUE,   verbose = TRUE )"},{"path":"https://www.camplab.net/musicatk/reference/create_musica_from_variants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creates a musica object from a variant table — create_musica_from_variants","text":"x data.table, matrix, data.frame contains columns variant information. genome BSgenome object indicating genome reference variants coordinates derived . check_ref_chromosomes Whether peform check ensure chromosomes variant object match reference chromosomes genome object. mismatches, may cause errors downstream generation count tables. mismatches occur, attept automatically fix seqlevelsStyle function made. Default TRUE. check_ref_bases Whether check reference bases variant object match reference bases genome object. Default TRUE. chromosome_col name column contains chromosome reference variant. Default \"chr\". start_col name column contains start position variant. Default \"start\". end_col name column contains end position variant. Default \"end\". ref_col name column contains reference base(s) variant. Default \"ref\". alt_col name column contains alternative base(s) variant. Default \"alt\". sample_col name column contains sample id variant. Default \"sample\". extra_fields additional fields extract include musica object. Default NULL. standardize_indels Flag convert indel style (e.g. `C > CAT` becomes `- > ` `GCACA > G` becomes `CACA > -`) convert_dbs Flag convert adjacent SBS DBS (original SBS removed) verbose Whether print status messages error checking. Default TRUE.","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_musica_from_variants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Creates a musica object from a variant table — create_musica_from_variants","text":"Returns musica object","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_musica_from_variants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Creates a musica object from a variant table — create_musica_from_variants","text":"","code":"maf_file <- system.file(\"extdata\", \"public_TCGA.LUSC.maf\",   package = \"musicatk\" ) variants <- extract_variants_from_maf_file(maf_file) g <- select_genome(\"38\") musica <- create_musica_from_variants(x = variants, genome = g) #> Checking that chromosomes in the 'variant' object match chromosomes in the 'genome' object. #> Checking that the reference bases in the 'variant' object match the reference bases in the 'genome' object. #> Standardizing INS/DEL style #> Converting adjacent SBS into DBS #> 4 SBS converted to DBS"},{"path":"https://www.camplab.net/musicatk/reference/create_result_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Load an external model into a result_model object — create_result_model","title":"Load an external model into a result_model object — create_result_model","text":"function creates result_model object signatures, exposures, mutation count table.","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_result_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load an external model into a result_model object — create_result_model","text":"","code":"create_result_model(signatures, exposures, model_id, modality)"},{"path":"https://www.camplab.net/musicatk/reference/create_result_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load an external model into a result_model object — create_result_model","text":"signatures matrix data.frame signatures mutational motifs exposures matrix data.frame samples signature weights model_id Name model modality Modality model","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_result_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load an external model into a result_model object — create_result_model","text":"result_model object","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_result_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load an external model into a result_model object — create_result_model","text":"","code":"signatures <- signatures(res, \"result\", \"SBS96\", \"res\") exposures <- exposures(res, \"result\", \"SBS96\", \"res\") model <- create_result_model(signatures, exposures, \"example_model\", \"SBS96\")"},{"path":"https://www.camplab.net/musicatk/reference/create_sbs192_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Uses a genome object to find context and generate standard SBS192 table using transcript strand — create_sbs192_table","title":"Uses a genome object to find context and generate standard SBS192 table using transcript strand — create_sbs192_table","text":"Uses genome object find context generate standard SBS192 table using transcript strand","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_sbs192_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uses a genome object to find context and generate standard SBS192 table using transcript strand — create_sbs192_table","text":"","code":"create_sbs192_table(musica, g, strand_type, overwrite = FALSE)"},{"path":"https://www.camplab.net/musicatk/reference/create_sbs192_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uses a genome object to find context and generate standard SBS192 table using transcript strand — create_sbs192_table","text":"musica Input samples g BSgenome object indicating genome reference variants coordinates derived . strand_type Transcript_Strand Replication_Strand overwrite Overwrite existing count table","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_sbs192_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Uses a genome object to find context and generate standard SBS192 table using transcript strand — create_sbs192_table","text":"Returns created SBS192 count table object built using either transcript strand replication strand","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_sbs96_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Uses a genome object to find context and generate standard SBS96 tables — create_sbs96_table","title":"Uses a genome object to find context and generate standard SBS96 tables — create_sbs96_table","text":"Uses genome object find context generate standard SBS96 tables","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_sbs96_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uses a genome object to find context and generate standard SBS96 tables — create_sbs96_table","text":"","code":"create_sbs96_table(musica, g, overwrite = FALSE)"},{"path":"https://www.camplab.net/musicatk/reference/create_sbs96_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uses a genome object to find context and generate standard SBS96 tables — create_sbs96_table","text":"musica musica object. g BSgenome object indicating genome reference variants coordinates derived . overwrite Overwrite existing count table","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_sbs96_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Uses a genome object to find context and generate standard SBS96 tables — create_sbs96_table","text":"Returns created SBS96 count table object","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_umap.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a UMAP from a model result — create_umap","title":"Create a UMAP from a model result — create_umap","text":"Proportional sample exposures used input umap function generate two dimensional UMAP.","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_umap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a UMAP from a model result — create_umap","text":"","code":"create_umap(   musica,   model_name,   modality = \"SBS96\",   result_name = \"result\",   n_neighbors = 30,   min_dist = 0.75,   spread = 1 )"},{"path":"https://www.camplab.net/musicatk/reference/create_umap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a UMAP from a model result — create_umap","text":"musica musica object containing mutational signature discovery prediction. model_name name desired model. modality modality model. Must \"SBS96\", \"DBS78\", \"IND83\". Default \"SBS96\". result_name Name result list entry containing model. Default \"result\". n_neighbors size local neighborhood used views manifold approximation. Larger values result global manifold, smaller values result local data preserved. n_neighbors larger number samples, n_neighbors automatically set number samples musica. Default 30. min_dist effective minimum distance embedded points. Smaller values result clustered/clumped embedding nearby points manifold drawn closer together, larger values result even dispersal points. Default 0.2. spread effective scale embedded points. combination ‘min_dist’, determines clustered/clumped embedded points . Default 1.","code":""},{"path":"https://www.camplab.net/musicatk/reference/create_umap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a UMAP from a model result — create_umap","text":"musica object new UMAP stored UMAP slot result_model object model.","code":""},{"path":[]},{"path":"https://www.camplab.net/musicatk/reference/create_umap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a UMAP from a model result — create_umap","text":"","code":"data(res_annot) create_umap(res_annot, model_name = \"res_annot\") #> The parameter 'n_neighbors' cannot be bigger than the total number of samples. Setting 'n_neighbors' to 7."},{"path":"https://www.camplab.net/musicatk/reference/credible_intervals.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve credible_intervals from a result_model, result_collection, or musica object — credible_intervals","title":"Retrieve credible_intervals from a result_model, result_collection, or musica object — credible_intervals","text":"Credible intervals model","code":""},{"path":"https://www.camplab.net/musicatk/reference/credible_intervals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve credible_intervals from a result_model, result_collection, or musica object — credible_intervals","text":"","code":"credible_intervals(x, ...)  # S4 method for class 'musica' credible_intervals(x, result, modality, model_id)  # S4 method for class 'result_collection' credible_intervals(x, modality, model_id)  # S4 method for class 'result_model' credible_intervals(x)  credible_intervals(x, ...) <- value  # S4 method for class 'musica,matrix' credible_intervals(x, result, modality, model_id) <- value  # S4 method for class 'result_collection,matrix' credible_intervals(x, modality, model_id) <- value  # S4 method for class 'result_model,matrix' credible_intervals(x) <- value"},{"path":"https://www.camplab.net/musicatk/reference/credible_intervals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve credible_intervals from a result_model, result_collection, or musica object — credible_intervals","text":"x musica, result_collection, result_model object generated mutational discovery prediction tool. ... inputs result Name result result_list assign credible_intervals. Used result musica object. modality Modality assign credible_intervals. Used result musica result_collection object. model_id Model identifier assign credible_intervals. Used result musica result_collection object. value List credible intervals","code":""},{"path":"https://www.camplab.net/musicatk/reference/credible_intervals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve credible_intervals from a result_model, result_collection, or musica object — credible_intervals","text":"credible intervals model","code":""},{"path":"https://www.camplab.net/musicatk/reference/credible_intervals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve credible_intervals from a result_model, result_collection, or musica object — credible_intervals","text":"","code":"data(res) credible_intervals(res, \"result\", \"SBS96\", \"res\") #> List of length 0"},{"path":"https://www.camplab.net/musicatk/reference/dbs_musica.html","id":null,"dir":"Reference","previous_headings":"","what":"dbs_musica — dbs_musica","title":"dbs_musica — dbs_musica","text":"musica created testing includes DBS variants","code":""},{"path":"https://www.camplab.net/musicatk/reference/dbs_musica.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"dbs_musica — dbs_musica","text":"","code":"data(dbs_musica)"},{"path":"https://www.camplab.net/musicatk/reference/dbs_musica.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"dbs_musica — dbs_musica","text":"object class musica See [create_musica_from_variants()] [create_musica_from_counts()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/discover_signatures.html","id":null,"dir":"Reference","previous_headings":"","what":"Discover mutational signatures — discover_signatures","title":"Discover mutational signatures — discover_signatures","text":"Mutational signatures exposures discovered using methods Latent Dirichlet Allocation (lda) Non-Negative Matrix Factorization (nmf). algorithms deconvolute matrix counts mutation types sample two matrices: 1) \"signature\" matrix containing probability mutation type sample 2) \"exposure\" matrix containing estimated counts signature sample. mutational discovery can performed, samples first need stored musica object using create_musica_from_variants create_musica_from_counts function mutation count tables need created using functions build_standard_table create_musica_from_counts used.","code":""},{"path":"https://www.camplab.net/musicatk/reference/discover_signatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Discover mutational signatures — discover_signatures","text":"","code":"discover_signatures(   musica,   modality,   num_signatures,   algorithm = \"lda\",   result_name = \"result\",   model_id = NULL,   seed = 1,   nstart = 10,   par_cores = 1,   make_copy = FALSE,   table_name = NULL )"},{"path":"https://www.camplab.net/musicatk/reference/discover_signatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Discover mutational signatures — discover_signatures","text":"musica musica object. modality Modality use signature discovery. Needs name supplied table building functions build_standard_table. num_signatures Number signatures discover. algorithm Method use mutational signature discovery. One \"lda\" \"nmf\". Default \"lda\". result_name Name result_list entry save results . Default \"result\". model_id Identifier result. NULL, automatically set algorithm number signatures. Default NULL. seed Seed used random number generators signature discovery algorithms. Default 1. nstart Number independent random starts used mutational signature algorithms. Default 10. par_cores Number parallel cores use. used method = \"nmf\". Default 1. make_copy FALSE, inputted musica object updated nothing returned. TRUE, new musica object created returned. Default FALSE. table_name Use modality instead","code":""},{"path":"https://www.camplab.net/musicatk/reference/discover_signatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Discover mutational signatures — discover_signatures","text":"Returns nothing new musica object, depending make_copy parameter.","code":""},{"path":"https://www.camplab.net/musicatk/reference/discover_signatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Discover mutational signatures — discover_signatures","text":"","code":"data(musica) g <- select_genome(\"19\") build_standard_table(musica, g, \"SBS96\", overwrite = TRUE) #> Building count table from SBS with SBS96 schema #> Warning: Overwriting counts table: SBS96 discover_signatures(   musica = musica, modality = \"SBS96\",   num_signatures = 3, algorithm = \"lda\", seed = 12345, nstart = 1 )"},{"path":"https://www.camplab.net/musicatk/reference/dot-jsd.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculates 1 - Jensen-Shannon Divergences between all pairs of columns between two matrices — .jsd","title":"Calculates 1 - Jensen-Shannon Divergences between all pairs of columns between two matrices — .jsd","text":"Calculates 1 - Jensen-Shannon Divergences pairs columns two matrices","code":""},{"path":"https://www.camplab.net/musicatk/reference/dot-jsd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculates 1 - Jensen-Shannon Divergences between all pairs of columns between two matrices — .jsd","text":"","code":".jsd(p, q, epsilon = 1e-07)"},{"path":"https://www.camplab.net/musicatk/reference/dot-jsd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculates 1 - Jensen-Shannon Divergences between all pairs of columns between two matrices — .jsd","text":"p First matrix q Second matrix epsilon Number add probabilities. Default 0.0000001.","code":""},{"path":"https://www.camplab.net/musicatk/reference/dot-jsd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculates 1 - Jensen-Shannon Divergences between all pairs of columns between two matrices — .jsd","text":"Returns matrix 1 - Jensen-Shannon Divergences","code":""},{"path":"https://www.camplab.net/musicatk/reference/drop_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"Drops a column from the variant table that the user no longer needs — drop_annotation","title":"Drops a column from the variant table that the user no longer needs — drop_annotation","text":"Drops column variant table user longer needs","code":""},{"path":"https://www.camplab.net/musicatk/reference/drop_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Drops a column from the variant table that the user no longer needs — drop_annotation","text":"","code":"drop_annotation(musica, column_name)"},{"path":"https://www.camplab.net/musicatk/reference/drop_annotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drops a column from the variant table that the user no longer needs — drop_annotation","text":"musica musica object. column_name Name column drop","code":""},{"path":"https://www.camplab.net/musicatk/reference/drop_annotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Drops a column from the variant table that the user no longer needs — drop_annotation","text":"None","code":""},{"path":"https://www.camplab.net/musicatk/reference/drop_annotation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Drops a column from the variant table that the user no longer needs — drop_annotation","text":"","code":"data(musica) drop_annotation(musica, \"Variant_Type\")"},{"path":"https://www.camplab.net/musicatk/reference/exposure_differential_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare exposures of annotated samples — exposure_differential_analysis","title":"Compare exposures of annotated samples — exposure_differential_analysis","text":"exposure_differential_analysis used run differential analysis signature exposures annotated samples.","code":""},{"path":"https://www.camplab.net/musicatk/reference/exposure_differential_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare exposures of annotated samples — exposure_differential_analysis","text":"","code":"exposure_differential_analysis(   musica,   model_name,   annotation,   modality = \"SBS96\",   result_name = \"result\",   method = c(\"wilcox\", \"kruskal\", \"glm.nb\"),   group1 = NULL,   group2 = NULL,   ... )"},{"path":"https://www.camplab.net/musicatk/reference/exposure_differential_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare exposures of annotated samples — exposure_differential_analysis","text":"musica musica object. model_name name model. annotation Column sample_annotations table musica object modality modality. Must \"SBS96\", \"DBS78\", \"IND83\". Default \"SBS96\". result_name Name result list entry. Default \"result\". method method c(\"wilcox\", \"kruskal\", \"glm.nb\") used perform differential analysis signature exposures group1 character vector used Wilcox test. Elements group1 compared elements group2. required annotation 2 levels. group2 character vector used Wilcox test. Elements group2 compared elements group1. required annotation 2 levels. ... Additional arguments passed chosen method","code":""},{"path":"https://www.camplab.net/musicatk/reference/exposure_differential_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare exposures of annotated samples — exposure_differential_analysis","text":"matrix containing statistics summarizing analysis dependent chosen method","code":""},{"path":"https://www.camplab.net/musicatk/reference/exposure_differential_analysis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare exposures of annotated samples — exposure_differential_analysis","text":"","code":"data(\"res_annot\") exposure_differential_analysis(res_annot,   model_name = \"res_annot\",   annotation = \"Tumor_Subtypes\", method = \"wilcox\" ) #>    Signature Group1 Group2          Pr(>|z|)             (fdr) #> 1 Signature1 Breast   Lung 0.114285714285714 0.342857142857143 #> 2 Signature2 Breast   Lung 0.228571428571429 0.342857142857143 #> 3 Signature3 Breast   Lung 0.628571428571429 0.628571428571429"},{"path":"https://www.camplab.net/musicatk/reference/exposures.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve exposures from a result_model, result_collection, or musica object — exposures","title":"Retrieve exposures from a result_model, result_collection, or musica object — exposures","text":"exposure matrix contains estimated amount signature sample. Rows correspond signature columns correspond sample.","code":""},{"path":"https://www.camplab.net/musicatk/reference/exposures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve exposures from a result_model, result_collection, or musica object — exposures","text":"","code":"exposures(x, ...)  # S4 method for class 'musica' exposures(x, result, modality, model_id)  # S4 method for class 'result_collection' exposures(x, modality, model_id)  # S4 method for class 'result_model' exposures(x)  exposures(x, ...) <- value  # S4 method for class 'musica,matrix' exposures(x, result, modality, model_id) <- value  # S4 method for class 'result_collection,matrix' exposures(x, modality, model_id) <- value  # S4 method for class 'result_model,matrix' exposures(x) <- value"},{"path":"https://www.camplab.net/musicatk/reference/exposures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve exposures from a result_model, result_collection, or musica object — exposures","text":"x musica, result_collection, result_model object generated mutational discovery prediction tool. ... inputs result Name result result_list assign exposures. Used result musica object. modality Modality assign exposures. Used result musica result_collection object. model_id Model identifier assign exposures. Used result musica result_collection object. value matrix samples signature exposures","code":""},{"path":"https://www.camplab.net/musicatk/reference/exposures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve exposures from a result_model, result_collection, or musica object — exposures","text":"matrix exposures","code":""},{"path":"https://www.camplab.net/musicatk/reference/exposures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve exposures from a result_model, result_collection, or musica object — exposures","text":"","code":"data(res) exposures(res, \"result\", \"SBS96\", \"res\") #>            TCGA-56-7582-01A-11D-2042-08 TCGA-77-7335-01A-11D-2042-08 #> Signature1                   0.09060907                 175.47415750 #> Signature2                 191.81878100                  98.43519276 #> Signature3                   0.09060993                   0.09064974 #>            TCGA-94-7557-01A-11D-2122-08 TCGA-97-7938-01A-11D-2167-08 #> Signature1                     64.48884                 116.81894638 #> Signature2                     38.41289                   0.09052656 #> Signature3                     14.09827                   0.09052706 #>            TCGA-EE-A3J5-06A-11D-A20D-08 TCGA-ER-A197-06A-32D-A197-08 #> Signature1                    0.0905308                   6.89236265 #> Signature2                    0.0905325                   4.01908283 #> Signature3                  121.8189367                   0.08855452 #>            TCGA-ER-A19O-06A-11D-A197-08 #> Signature1                   0.09025138 #> Signature2                   0.09025280 #> Signature3                  50.81949582 data(res) exposures(res, \"result\", \"SBS96\", \"res\") <- matrix()"},{"path":"https://www.camplab.net/musicatk/reference/extract_count_tables.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract count tables list from a musica object — extract_count_tables","title":"Extract count tables list from a musica object — extract_count_tables","text":"Extract count tables list musica object","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_count_tables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract count tables list from a musica object — extract_count_tables","text":"","code":"extract_count_tables(musica)"},{"path":"https://www.camplab.net/musicatk/reference/extract_count_tables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract count tables list from a musica object — extract_count_tables","text":"musica musica object.","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_count_tables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract count tables list from a musica object — extract_count_tables","text":"List count tables objects","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_count_tables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract count tables list from a musica object — extract_count_tables","text":"","code":"data(musica) extract_count_tables(musica) #> $SBS96 #> Count_Table:  SBS96  #> Motifs: 96  #> Samples: 7  #>   #> **Annotations:  #>            motif mutation context #> C>A_ACA C>A_ACA      C>A     ACA #> C>A_ACC C>A_ACC      C>A     ACC #> C>A_ACG C>A_ACG      C>A     ACG #> C>A_ACT C>A_ACT      C>A     ACT #> C>A_CCA C>A_CCA      C>A     CCA #> C>A_CCC C>A_CCC      C>A     CCC #> 7           ...      ...     ...  #>  #> **Features:  #>    mutation #> 1  C>A_TCA #> 2  C>A_ACT #> 3  T>C_ATT #> 4  C>G_TCT #> 5  T>G_CTC #> 6  C>G_CCC #> 7      ...  #>  #> **Types:  #>  SBS #>   #> **Color Variable:  #>  mutation #>   #> **Color Mapping:  #>  #5ABCEBFF #>  #050708FF #>  #D33C32FF #>  #CBCACBFF #>  #ABCD72FF #>  #E7C9C6FF #>   #> **Descriptions:  #>  Single Base Substitution table with one base upstream and downstream #>"},{"path":"https://www.camplab.net/musicatk/reference/extract_variants.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract variants from mutliple objects — extract_variants","title":"Extract variants from mutliple objects — extract_variants","text":"Chooses correct function extract variants input based class object file extension. Different types objects can mixed within list. example, list can include VCF files maf objects. Certain parameters id rename apply VCF objects files need individually specified VCF. Therefore, parameters suppied vector length number inputs. types objects input list, value id rename ignored items.","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract variants from mutliple objects — extract_variants","text":"","code":"extract_variants(   inputs,   id = NULL,   rename = NULL,   sample_field = NULL,   filename_as_id = FALSE,   strip_extension = c(\".vcf\", \".vcf.gz\", \".gz\"),   filter = TRUE,   multiallele = c(\"expand\", \"exclude\"),   fix_vcf_errors = TRUE,   extra_fields = NULL,   chromosome_col = \"chr\",   start_col = \"start\",   end_col = \"end\",   ref_col = \"ref\",   alt_col = \"alt\",   sample_col = \"sample\",   verbose = TRUE )"},{"path":"https://www.camplab.net/musicatk/reference/extract_variants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract variants from mutliple objects — extract_variants","text":"inputs vector list objects file names. Objects can CollapsedVCF, ExpandedVCF, MAF, object inherits matrix data.frame, character strings denote path vcf maf file. id character vector length inputs denoting sample extract vcf. See extract_variants_from_vcf details. used input vcf object file. Default NULL. rename character vector length inputs denoting renamed . See extract_variants_from_vcf details. used input vcf object file. Default NULL. sample_field algoriths save name sample ##SAMPLE portion header VCF. See extract_variants_from_vcf details. Default NULL. filename_as_id set TRUE, file name used sample name. See extract_variants_from_vcf_file details. used input vcf file. Default TRUE. strip_extension used filename_as_id set TRUE. set TRUE, file extention stripped filename setting sample name. See extract_variants_from_vcf_file details. used input vcf file. Default c(\".vcf\",\".vcf.gz\",\".gz\") filter Exclude variants PASS FILTER column VCF inputs. multiallele Multialleles multiple alternative variants listed row vcf. See extract_variants_from_vcf details. used input vcf object file. Default \"expand\". fix_vcf_errors Attempt automatically fix VCF file formatting errors. See extract_variants_from_vcf_file details. used input vcf file. Default TRUE. extra_fields Optionally extract additional fields input objects. Default NULL. chromosome_col name column contains chromosome reference variant. used input matrix data.frame. Default \"Chromosome\". start_col name column contains start position variant. used input matrix data.frame. Default \"Start_Position\". end_col name column contains end position variant. used input matrix data.frame. Default \"End_Position\". ref_col name column contains reference base(s) variant. used input matrix data.frame. Default \"Tumor_Seq_Allele1\". alt_col name column contains alternative base(s) variant. used input matrix data.frame. Default \"Tumor_Seq_Allele2\". sample_col name column contains sample id variant. used input matrix data.frame. Default \"sample\". verbose Show progress variant extraction. Default TRUE.","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract variants from mutliple objects — extract_variants","text":"Returns data.table variants vcf","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract variants from mutliple objects — extract_variants","text":"","code":"# Get loations of two vcf files and a maf file luad_vcf_file <- system.file(\"extdata\", \"public_LUAD_TCGA-97-7938.vcf\",   package = \"musicatk\" ) lusc_maf_file <- system.file(\"extdata\", \"public_TCGA.LUSC.maf\",   package = \"musicatk\" ) melanoma_vcfs <- list.files(system.file(\"extdata\", package = \"musicatk\"),   pattern = glob2rx(\"*SKCM*vcf\"), full.names = TRUE )  # Read all files in at once inputs <- c(luad_vcf_file, melanoma_vcfs, lusc_maf_file) variants <- extract_variants(inputs = inputs) #>    |                                                                               |                                                                      |   0%   |                                                                               |==============                                                        |  20% #> Extracted 1 out of 5 inputs: /private/var/folders/cm/gxfbvrvj7n1c55lzxjsv6lsr0000gn/T/RtmpbXzCcV/temp_libpathc9231d690bd9/musicatk/extdata/public_LUAD_TCGA-97-7938.vcf #>    |                                                                               |============================                                          |  40% #> Extracted 2 out of 5 inputs: /private/var/folders/cm/gxfbvrvj7n1c55lzxjsv6lsr0000gn/T/RtmpbXzCcV/temp_libpathc9231d690bd9/musicatk/extdata/public_SKCM_TCGA-EE-A3J5-06A-11D-A20D-08.vcf #>    |                                                                               |==========================================                            |  60% #> Extracted 3 out of 5 inputs: /private/var/folders/cm/gxfbvrvj7n1c55lzxjsv6lsr0000gn/T/RtmpbXzCcV/temp_libpathc9231d690bd9/musicatk/extdata/public_SKCM_TCGA-ER-A197-06A-32D-A197-08.vcf #>    |                                                                               |========================================================              |  80% #> Extracted 4 out of 5 inputs: /private/var/folders/cm/gxfbvrvj7n1c55lzxjsv6lsr0000gn/T/RtmpbXzCcV/temp_libpathc9231d690bd9/musicatk/extdata/public_SKCM_TCGA-ER-A19O-06A-11D-A197-08.vcf #>    |                                                                               |======================================================================| 100% #> Extracted 5 out of 5 inputs: /private/var/folders/cm/gxfbvrvj7n1c55lzxjsv6lsr0000gn/T/RtmpbXzCcV/temp_libpathc9231d690bd9/musicatk/extdata/public_TCGA.LUSC.maf table(variants$sample) #>  #> TCGA-97-7938-01A-11D-2167-08 TCGA-EE-A3J5-06A-11D-A20D-08  #>                          121                          123  #> TCGA-ER-A197-06A-32D-A197-08 TCGA-ER-A19O-06A-11D-A197-08  #>                           13                           52  #> TCGA-56-7582-01A-11D-2042-08 TCGA-77-7335-01A-11D-2042-08  #>                          199                          283  #> TCGA-94-7557-01A-11D-2122-08  #>                          120   # Run again but renaming samples in first four vcfs new_name <- c(paste0(\"Sample\", 1:4), NA) variants <- extract_variants(inputs = inputs, rename = new_name) #>    |                                                                               |                                                                      |   0%   |                                                                               |==============                                                        |  20% #> Extracted 1 out of 5 inputs: /private/var/folders/cm/gxfbvrvj7n1c55lzxjsv6lsr0000gn/T/RtmpbXzCcV/temp_libpathc9231d690bd9/musicatk/extdata/public_LUAD_TCGA-97-7938.vcf #>    |                                                                               |============================                                          |  40% #> Extracted 2 out of 5 inputs: /private/var/folders/cm/gxfbvrvj7n1c55lzxjsv6lsr0000gn/T/RtmpbXzCcV/temp_libpathc9231d690bd9/musicatk/extdata/public_SKCM_TCGA-EE-A3J5-06A-11D-A20D-08.vcf #>    |                                                                               |==========================================                            |  60% #> Extracted 3 out of 5 inputs: /private/var/folders/cm/gxfbvrvj7n1c55lzxjsv6lsr0000gn/T/RtmpbXzCcV/temp_libpathc9231d690bd9/musicatk/extdata/public_SKCM_TCGA-ER-A197-06A-32D-A197-08.vcf #>    |                                                                               |========================================================              |  80% #> Extracted 4 out of 5 inputs: /private/var/folders/cm/gxfbvrvj7n1c55lzxjsv6lsr0000gn/T/RtmpbXzCcV/temp_libpathc9231d690bd9/musicatk/extdata/public_SKCM_TCGA-ER-A19O-06A-11D-A197-08.vcf #>    |                                                                               |======================================================================| 100% #> Extracted 5 out of 5 inputs: /private/var/folders/cm/gxfbvrvj7n1c55lzxjsv6lsr0000gn/T/RtmpbXzCcV/temp_libpathc9231d690bd9/musicatk/extdata/public_TCGA.LUSC.maf table(variants$sample) #>  #>                      Sample1                      Sample2  #>                          121                          123  #>                      Sample3                      Sample4  #>                           13                           52  #> TCGA-56-7582-01A-11D-2042-08 TCGA-77-7335-01A-11D-2042-08  #>                          199                          283  #> TCGA-94-7557-01A-11D-2122-08  #>                          120"},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_maf.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract variants from a maf object — extract_variants_from_maf","title":"Extract variants from a maf object — extract_variants_from_maf","text":"Add description","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_maf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract variants from a maf object — extract_variants_from_maf","text":"","code":"extract_variants_from_maf(maf, extra_fields = NULL)"},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_maf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract variants from a maf object — extract_variants_from_maf","text":"maf MAF object loaded read.maf() 'maftools' package extra_fields Optionally extract additional columns maf object. Default NULL.","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_maf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract variants from a maf object — extract_variants_from_maf","text":"Returns data.table variants maf can used create musica object.","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_maf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract variants from a maf object — extract_variants_from_maf","text":"","code":"maf_file <- system.file(\"extdata\", \"public_TCGA.LUSC.maf\",   package = \"musicatk\" ) library(maftools) maf <- read.maf(maf_file) #> -Reading #> -Validating #> -Silent variants: 206  #> -Summarizing #> --Possible FLAGS among top ten genes: #>   TTN #> -Processing clinical data #> --Missing clinical data #> -Finished in 0.030s elapsed (0.028s cpu)  variants <- extract_variants_from_maf(maf = maf)"},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_maf_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Extracts variants from a maf file — extract_variants_from_maf_file","title":"Extracts variants from a maf file — extract_variants_from_maf_file","text":"Add Description - Aaron","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_maf_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extracts variants from a maf file — extract_variants_from_maf_file","text":"","code":"extract_variants_from_maf_file(maf_file, extra_fields = NULL)"},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_maf_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extracts variants from a maf file — extract_variants_from_maf_file","text":"maf_file Location maf file extra_fields Optionally extract additional columns object. Default NULL.","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_maf_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extracts variants from a maf file — extract_variants_from_maf_file","text":"Returns data.table variants maf","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_maf_file.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extracts variants from a maf file — extract_variants_from_maf_file","text":"","code":"maf_file <- system.file(\"extdata\", \"public_TCGA.LUSC.maf\",   package = \"musicatk\" ) maf <- extract_variants_from_maf_file(maf_file = maf_file)"},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract variants from matrix or data.frame like objects — extract_variants_from_matrix","title":"Extract variants from matrix or data.frame like objects — extract_variants_from_matrix","text":"Add Description","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract variants from matrix or data.frame like objects — extract_variants_from_matrix","text":"","code":"extract_variants_from_matrix(   mat,   chromosome_col = \"Chromosome\",   start_col = \"Start_Position\",   end_col = \"End_Position\",   ref_col = \"Tumor_Seq_Allele1\",   alt_col = \"Tumor_Seq_Allele2\",   sample_col = \"Tumor_Sample_Barcode\",   extra_fields = NULL )"},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract variants from matrix or data.frame like objects — extract_variants_from_matrix","text":"mat object inherits classes \"matrix\" \"data.frame\" Examples include matrix, data.frame, data.table. chromosome_col name column contains chromosome reference variant. Default \"Chromosome\". start_col name column contains start position variant. Default \"Start_Position\". end_col name column contains end position variant. Default \"End_Position\". ref_col name column contains reference base(s) variant. Default \"Tumor_Seq_Allele1\". alt_col name column contains alternative base(s) variant. Default \"Tumor_Seq_Allele2\". sample_col name column contains sample id variant. Default \"Tumor_Sample_Barcode\". extra_fields Optionally extract additional columns object. Default NULL.","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract variants from matrix or data.frame like objects — extract_variants_from_matrix","text":"Returns data.table variants maf can used create musica object.","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract variants from matrix or data.frame like objects — extract_variants_from_matrix","text":"","code":"maf_file <- system.file(\"extdata\", \"public_TCGA.LUSC.maf\",   package = \"musicatk\" ) library(maftools) maf <- read.maf(maf_file) #> -Reading #> -Validating #> -Silent variants: 206  #> -Summarizing #> --Possible FLAGS among top ten genes: #>   TTN #> -Processing clinical data #> --Missing clinical data #> -Finished in 0.028s elapsed (0.027s cpu)  variants <- extract_variants_from_maf(maf = maf) variants <- extract_variants_from_matrix(   mat = variants,   chromosome_col = \"chr\", start_col = \"start\", end_col = \"end\",   ref_col = \"ref\", alt_col = \"alt\", sample_col = \"sample\" )"},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_vcf.html","id":null,"dir":"Reference","previous_headings":"","what":"Extracts variants from a VariantAnnotation VCF object — extract_variants_from_vcf","title":"Extracts variants from a VariantAnnotation VCF object — extract_variants_from_vcf","text":"Aaron - Need describe differnce ID, name header, rename terms naming sample. Need describe differences multiallelic choices. Also need describe automatic error fixing","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_vcf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extracts variants from a VariantAnnotation VCF object — extract_variants_from_vcf","text":"","code":"extract_variants_from_vcf(   vcf,   id = NULL,   rename = NULL,   sample_field = NULL,   filter = TRUE,   multiallele = c(\"expand\", \"exclude\"),   extra_fields = NULL )"},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_vcf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extracts variants from a VariantAnnotation VCF object — extract_variants_from_vcf","text":"vcf Location vcf file id ID sample select VCF. NULL, first sample selected. Default NULL. rename Rename sample value extracting variants. NULL, sample named according ID. sample_field algoriths save name sample ##SAMPLE portion header VCF (e.g. ##SAMPLE=<ID=TUMOR,SampleName=TCGA-01-0001>). ID specified via id parameter (\"TUMOR\" example), sample_field can used specify name tag (\"SampleName\" example). Default NULL. filter Exclude variants PASS FILTER column VCF. Default TRUE. multiallele Multialleles multiple alternative variants listed row vcf. One \"expand\" \"exclude\". \"expand\" selected, alternate allele given rows. \"exclude\" selected, rows removed. Default \"expand\". extra_fields Optionally extract additional fields INFO section VCF. Default NULL.","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_vcf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extracts variants from a VariantAnnotation VCF object — extract_variants_from_vcf","text":"Returns data.table variants vcf","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_vcf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extracts variants from a VariantAnnotation VCF object — extract_variants_from_vcf","text":"","code":"vcf_file <- system.file(\"extdata\", \"public_LUAD_TCGA-97-7938.vcf\",   package = \"musicatk\" )  library(VariantAnnotation) #> Loading required package: MatrixGenerics #> Loading required package: matrixStats #>  #> Attaching package: ‘matrixStats’ #> The following objects are masked from ‘package:Biobase’: #>  #>     anyMissing, rowMedians #>  #> Attaching package: ‘MatrixGenerics’ #> The following objects are masked from ‘package:matrixStats’: #>  #>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse, #>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums, #>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs, #>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats, #>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds, #>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads, #>     colWeightedMeans, colWeightedMedians, colWeightedSds, #>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet, #>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods, #>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps, #>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins, #>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks, #>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars, #>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians, #>     rowWeightedSds, rowWeightedVars #> The following object is masked from ‘package:Biobase’: #>  #>     rowMedians #> Loading required package: GenomeInfoDb #> Loading required package: S4Vectors #> Warning: package ‘S4Vectors’ was built under R version 4.4.1 #> Loading required package: stats4 #>  #> Attaching package: ‘S4Vectors’ #> The following object is masked from ‘package:NMF’: #>  #>     nrun #> The following object is masked from ‘package:utils’: #>  #>     findMatches #> The following objects are masked from ‘package:base’: #>  #>     I, expand.grid, unname #> Loading required package: IRanges #> Warning: package ‘IRanges’ was built under R version 4.4.1 #> Loading required package: GenomicRanges #> Loading required package: SummarizedExperiment #> Loading required package: Rsamtools #> Loading required package: Biostrings #> Loading required package: XVector #>  #> Attaching package: ‘Biostrings’ #> The following object is masked from ‘package:base’: #>  #>     strsplit #>  #> Attaching package: ‘VariantAnnotation’ #> The following object is masked from ‘package:base’: #>  #>     tabulate vcf <- readVcf(vcf_file) variants <- extract_variants_from_vcf(vcf = vcf)"},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_vcf_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Extracts variants from a vcf file — extract_variants_from_vcf_file","title":"Extracts variants from a vcf file — extract_variants_from_vcf_file","text":"Add Description","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_vcf_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extracts variants from a vcf file — extract_variants_from_vcf_file","text":"","code":"extract_variants_from_vcf_file(   vcf_file,   id = NULL,   rename = NULL,   sample_field = NULL,   filename_as_id = FALSE,   strip_extension = c(\".vcf\", \".vcf.gz\", \".gz\"),   filter = TRUE,   multiallele = c(\"expand\", \"exclude\"),   extra_fields = NULL,   fix_vcf_errors = TRUE )"},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_vcf_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extracts variants from a vcf file — extract_variants_from_vcf_file","text":"vcf_file Path vcf file id ID sample select VCF. NULL, first sample selected. Default NULL. rename Rename sample value extracting variants. NULL, sample named according ID. sample_field algoriths save name sample ##SAMPLE portion header VCF (e.g. ##SAMPLE=<ID=TUMOR,SampleName=TCGA-01-0001>). ID specified via id parameter (\"TUMOR\" example), sample_field can used specify name tag (\"SampleName\" example). Default NULL. filename_as_id set TRUE, file name used sample name. strip_extension used filename_as_id set TRUE. set TRUE, file extention stripped filename setting sample name. character vector given, strings vector removed end filename setting sample name. Default c(\".vcf\",\".vcf.gz\",\".gz\") filter Exclude variants PASS FILTER column VCF. Default TRUE. multiallele Multialleles multiple alternative variants listed row vcf. One \"expand\" \"exclude\". \"expand\" selected, alternate allele given rows. \"exclude\" selected, rows removed. Default \"expand\". extra_fields Optionally extract additional fields INFO section VCF. Default NULL. fix_vcf_errors Attempt automatically fix VCF file formatting errors.","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_vcf_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extracts variants from a vcf file — extract_variants_from_vcf_file","text":"Returns data.table variants extracted vcf","code":""},{"path":"https://www.camplab.net/musicatk/reference/extract_variants_from_vcf_file.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extracts variants from a vcf file — extract_variants_from_vcf_file","text":"","code":"vcf <- system.file(\"extdata\", \"public_LUAD_TCGA-97-7938.vcf\",   package = \"musicatk\" ) variants <- extract_variants_from_vcf_file(vcf_file = vcf)"},{"path":"https://www.camplab.net/musicatk/reference/generate_result_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate result_grid from musica based on annotation and range of k — generate_result_grid","title":"Generate result_grid from musica based on annotation and range of k — generate_result_grid","text":"Generate result_grid musica based annotation range k","code":""},{"path":"https://www.camplab.net/musicatk/reference/generate_result_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate result_grid from musica based on annotation and range of k — generate_result_grid","text":"","code":"generate_result_grid(   musica,   modality,   algorithm = \"lda\",   annotation = NA,   k_start,   k_end,   result_name = \"result_grid\",   n_start = 1,   seed = NULL,   par_cores = FALSE,   verbose = FALSE,   make_copy = FALSE,   table_name = NULL )"},{"path":"https://www.camplab.net/musicatk/reference/generate_result_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate result_grid from musica based on annotation and range of k — generate_result_grid","text":"musica musica object. modality Modality used signature discovery algorithm Algorithm signature discovery annotation Sample annotation split results k_start Lower range number signatures discovery k_end Upper range number signatures discovery result_name Name result_list entry save results . Default \"result_grid\". n_start Number times discover signatures compare based posterior loglikihood seed Seed use reproducible results, set null disable par_cores Number parallel cores use (NMF ) verbose Whether output loop iterations make_copy FALSE, inputted musica object updated nothing returned. TRUE, new musica object created returned. Default FALSE. table_name Use modality instead","code":""},{"path":"https://www.camplab.net/musicatk/reference/generate_result_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate result_grid from musica based on annotation and range of k — generate_result_grid","text":"Returns nothing new musica object, depending make_copy parameter.","code":""},{"path":"https://www.camplab.net/musicatk/reference/generate_result_grid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate result_grid from musica based on annotation and range of k — generate_result_grid","text":"","code":"data(musica_sbs96) grid <- generate_result_grid(musica_sbs96, \"SBS96\", \"lda\",   k_start = 2,   k_end = 5 )"},{"path":"https://www.camplab.net/musicatk/reference/get_count_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve count_table matrix from count_table object — get_count_table","title":"Retrieve count_table matrix from count_table object — get_count_table","text":"count table","code":""},{"path":"https://www.camplab.net/musicatk/reference/get_count_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve count_table matrix from count_table object — get_count_table","text":"","code":"get_count_table(count_table)"},{"path":"https://www.camplab.net/musicatk/reference/get_count_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve count_table matrix from count_table object — get_count_table","text":"count_table count_table object.","code":""},{"path":"https://www.camplab.net/musicatk/reference/get_count_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve count_table matrix from count_table object — get_count_table","text":"count table","code":""},{"path":"https://www.camplab.net/musicatk/reference/get_modality.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve a specific modality entry from a musica or result_collection object — get_modality","title":"Retrieve a specific modality entry from a musica or result_collection object — get_modality","text":"modality list contains model results modality","code":""},{"path":"https://www.camplab.net/musicatk/reference/get_modality.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve a specific modality entry from a musica or result_collection object — get_modality","text":"","code":"get_modality(x, ...)  # S4 method for class 'musica' get_modality(x, result, modality)  # S4 method for class 'result_collection' get_modality(x, modality)"},{"path":"https://www.camplab.net/musicatk/reference/get_modality.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve a specific modality entry from a musica or result_collection object — get_modality","text":"x result_model result_collection object ... inputs result name result_list entry. modality modality.","code":""},{"path":"https://www.camplab.net/musicatk/reference/get_modality.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve a specific modality entry from a musica or result_collection object — get_modality","text":"list modality contains result_model objects","code":""},{"path":"https://www.camplab.net/musicatk/reference/get_modality.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve a specific modality entry from a musica or result_collection object — get_modality","text":"","code":"data(res) get_modality(res, \"result\", \"SBS96\") #> $res #> An object of class \"result_model\" #> Slot \"signatures\": #>           Signature1   Signature2   Signature3 #> C>A_ACA 8.666532e-04 2.613711e-02 4.448169e-14 #> C>A_ACC 1.222204e-02 1.367763e-02 3.861026e-17 #> C>A_ACG 8.228520e-03 7.525241e-07 1.181972e-34 #> C>A_ACT 6.922897e-03 1.046267e-02 4.705594e-16 #> C>A_CCA 2.268506e-02 2.627552e-02 5.342028e-03 #> C>A_CCC 3.453916e-02 1.326883e-02 8.573563e-19 #> C>A_CCG 3.017375e-02 4.968338e-12 4.942740e-34 #> C>A_CCT 2.347529e-02 7.349768e-03 7.630364e-34 #> C>A_GCA 1.767337e-02 3.157788e-02 5.691025e-03 #> C>A_GCC 1.424257e-02 1.748020e-02 1.014869e-34 #> C>A_GCG 1.285337e-64 1.203912e-02 9.483122e-67 #> C>A_GCT 8.555769e-03 1.168081e-02 1.683258e-17 #> C>A_TCA 2.488531e-02 1.182221e-02 3.015327e-13 #> C>A_TCC 2.466496e-02 1.507377e-02 4.714786e-34 #> C>A_TCG 1.126220e-02 8.711230e-03 1.727722e-33 #> C>A_TCT 2.454132e-02 1.520943e-02 4.301613e-17 #> C>G_ACA 3.720076e-44 3.720076e-44 3.720076e-44 #> C>G_ACC 2.595663e-05 1.502043e-02 5.342027e-03 #> C>G_ACG 2.038874e-03 6.792227e-03 1.193386e-33 #> C>G_ACT 2.742966e-03 1.119504e-07 1.264509e-34 #> C>G_CCA 9.639451e-03 1.049176e-02 1.171358e-33 #> C>G_CCC 1.371533e-02 1.498665e-08 2.995019e-16 #> C>G_CCG 4.105876e-64 6.019562e-03 5.360183e-66 #> C>G_CCT 4.107476e-03 7.532273e-03 1.634147e-34 #> C>G_GCA 1.891476e-03 1.297352e-02 1.814603e-33 #> C>G_GCC 3.726155e-04 1.163028e-02 3.489254e-35 #> C>G_GCG 8.229101e-03 1.150110e-07 3.013128e-13 #> C>G_GCT 1.097217e-02 1.085797e-07 1.720778e-13 #> C>G_TCA 7.467141e-02 2.040074e-02 1.606676e-13 #> C>G_TCC 3.057653e-02 5.577622e-03 2.153462e-12 #> C>G_TCG 1.097205e-02 2.506732e-07 5.295908e-34 #> C>G_TCT 7.448028e-02 1.760067e-02 8.285057e-13 #> C>T_ACA 6.403196e-03 2.307202e-02 1.793321e-35 #> C>T_ACC 3.020069e-03 1.670874e-02 1.254062e-02 #> C>T_ACG 1.491455e-02 3.459969e-02 5.700336e-03 #> C>T_ACT 6.830307e-03 7.554477e-03 4.916733e-15 #> C>T_CCA 2.419367e-02 3.456344e-02 6.248236e-02 #> C>T_CCC 2.118356e-02 1.286786e-02 1.335619e-01 #> C>T_CCG 2.102095e-02 5.086909e-02 2.903630e-02 #> C>T_CCT 6.045208e-03 3.811245e-02 8.084269e-02 #> C>T_GCA 1.574014e-03 3.439032e-02 3.551824e-15 #> C>T_GCC 1.777753e-02 2.723358e-02 2.922491e-02 #> C>T_GCG 2.774451e-02 2.034235e-02 6.019646e-03 #> C>T_GCT 4.098337e-04 3.431291e-02 7.746617e-03 #> C>T_TCA 3.189400e-02 3.519934e-02 9.443587e-02 #> C>T_TCC 2.449972e-02 2.107020e-02 2.354123e-01 #> C>T_TCG 2.219426e-02 3.989305e-02 1.049950e-01 #> C>T_TCT 4.067045e-02 2.032979e-02 3.963147e-02 #> T>A_ATA 2.373571e-03 4.050712e-04 6.268995e-07 #> T>A_ATC 4.600210e-03 3.981849e-03 5.342031e-03 #> T>A_ATG 5.030936e-03 1.253859e-02 4.563086e-26 #> T>A_ATT 5.486136e-03 3.009781e-03 5.342034e-03 #> T>A_CTA 9.013459e-03 5.159054e-03 4.092394e-33 #> T>A_CTC 1.097227e-02 1.058355e-09 3.709747e-10 #> T>A_CTG 2.386812e-02 9.928521e-03 5.342028e-03 #> T>A_CTT 5.172173e-04 1.749118e-02 8.753248e-34 #> T>A_GTA 1.483420e-73 6.598148e-70 1.068406e-02 #> T>A_GTC 2.743066e-03 3.026769e-09 3.172478e-35 #> T>A_GTG 5.485563e-03 6.290277e-07 5.342033e-03 #> T>A_GTT 8.953417e-04 1.406651e-02 7.645306e-15 #> T>A_TTA 7.830455e-03 1.726050e-08 6.118554e-03 #> T>A_TTC 3.825787e-65 3.009781e-03 4.022010e-67 #> T>A_TTG 8.229205e-03 2.408105e-13 4.092867e-33 #> T>A_TTT 1.097650e-04 5.899124e-03 5.342033e-03 #> T>C_ATA 1.369925e-02 1.766050e-05 5.069676e-10 #> T>C_ATC 5.486137e-03 3.762914e-62 5.342032e-03 #> T>C_ATG 8.925114e-03 2.632446e-02 7.800215e-16 #> T>C_ATT 2.433390e-03 9.728480e-03 1.538829e-02 #> T>C_CTA 4.600669e-03 3.981344e-03 2.719501e-34 #> T>C_CTC 2.561366e-06 9.026533e-03 2.172342e-35 #> T>C_CTG 1.378588e-02 1.196173e-02 2.980716e-14 #> T>C_CTT 2.722357e-65 6.019562e-03 4.772865e-67 #> T>C_GTA 1.096049e-02 1.292396e-05 8.337786e-10 #> T>C_GTC 1.097207e-02 2.201382e-07 5.033614e-10 #> T>C_GTG 7.807325e-03 2.401830e-05 6.121000e-03 #> T>C_GTT 4.598791e-03 3.983399e-03 2.136814e-02 #> T>C_TTA 1.877293e-05 1.152941e-02 6.210160e-03 #> T>C_TTC 2.666685e-04 1.744657e-02 5.909145e-03 #> T>C_TTG 3.362178e-03 7.928723e-03 6.089818e-03 #> T>C_TTT 7.719903e-05 5.934856e-03 1.068407e-02 #> T>G_ATA 5.485846e-03 3.193990e-07 4.766222e-34 #> T>G_ATC 2.742837e-03 2.539378e-07 5.342032e-03 #> T>G_ATG 2.209459e-71 1.284586e-67 5.342032e-03 #> T>G_ATT 6.715116e-03 4.671088e-03 1.217154e-33 #> T>G_CTA 2.206821e-79 7.231800e-78 5.342032e-03 #> T>G_CTC 6.752989e-03 7.639313e-03 8.133268e-15 #> T>G_CTG 2.742934e-03 1.470164e-07 5.342033e-03 #> T>G_CTT 5.485469e-03 7.326000e-07 3.062070e-34 #> T>G_GTA 1.855451e-04 5.815976e-03 2.779645e-34 #> T>G_GTC 3.720076e-44 3.720076e-44 3.720076e-44 #> T>G_GTG 5.486137e-03 1.452622e-12 6.501419e-35 #> T>G_GTT 2.497966e-65 3.009781e-03 1.177083e-67 #> T>G_TTA 1.975414e-65 3.009781e-03 2.176097e-67 #> T>G_TTC 3.720076e-44 3.720076e-44 3.720076e-44 #> T>G_TTG 8.141805e-03 9.589828e-05 1.232222e-12 #> T>G_TTT 2.359148e-03 4.208018e-04 7.955750e-07 #>  #> Slot \"exposures\": #>            TCGA-56-7582-01A-11D-2042-08 TCGA-77-7335-01A-11D-2042-08 #> Signature1                   0.09060907                 175.47415750 #> Signature2                 191.81878100                  98.43519276 #> Signature3                   0.09060993                   0.09064974 #>            TCGA-94-7557-01A-11D-2122-08 TCGA-97-7938-01A-11D-2167-08 #> Signature1                     64.48884                 116.81894638 #> Signature2                     38.41289                   0.09052656 #> Signature3                     14.09827                   0.09052706 #>            TCGA-EE-A3J5-06A-11D-A20D-08 TCGA-ER-A197-06A-32D-A197-08 #> Signature1                    0.0905308                   6.89236265 #> Signature2                    0.0905325                   4.01908283 #> Signature3                  121.8189367                   0.08855452 #>            TCGA-ER-A19O-06A-11D-A197-08 #> Signature1                   0.09025138 #> Signature2                   0.09025280 #> Signature3                  50.81949582 #>  #> Slot \"num_signatures\": #> [1] 3 #>  #> Slot \"other_parameters\": #> List of length 0 #>  #> Slot \"credible_intervals\": #> List of length 0 #>  #> Slot \"metrics\": #> List of length 0 #>  #> Slot \"umap\": #> <0 x 0 matrix> #>  #> Slot \"model_id\": #> [1] \"res\" #>  #> Slot \"modality\": #> [1] \"SBS96\" #>  #>"},{"path":"https://www.camplab.net/musicatk/reference/get_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve model from a musica or result collection object — get_model","title":"Retrieve model from a musica or result collection object — get_model","text":"Extract result_model object musica result_collection object contains model.","code":""},{"path":"https://www.camplab.net/musicatk/reference/get_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve model from a musica or result collection object — get_model","text":"","code":"get_model(x, ...)  # S4 method for class 'musica' get_model(x, result, modality, model)  # S4 method for class 'result_collection' get_model(x, modality, model)"},{"path":"https://www.camplab.net/musicatk/reference/get_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve model from a musica or result collection object — get_model","text":"x musica result_collection object. ... inputs result name result_list entry. modality modality. model name model.","code":""},{"path":"https://www.camplab.net/musicatk/reference/get_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve model from a musica or result collection object — get_model","text":"result_model object","code":""},{"path":"https://www.camplab.net/musicatk/reference/get_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve model from a musica or result collection object — get_model","text":"","code":"data(res) get_model(res, \"result\", \"SBS96\", \"res\") #> An object of class \"result_model\" #> Slot \"signatures\": #>           Signature1   Signature2   Signature3 #> C>A_ACA 8.666532e-04 2.613711e-02 4.448169e-14 #> C>A_ACC 1.222204e-02 1.367763e-02 3.861026e-17 #> C>A_ACG 8.228520e-03 7.525241e-07 1.181972e-34 #> C>A_ACT 6.922897e-03 1.046267e-02 4.705594e-16 #> C>A_CCA 2.268506e-02 2.627552e-02 5.342028e-03 #> C>A_CCC 3.453916e-02 1.326883e-02 8.573563e-19 #> C>A_CCG 3.017375e-02 4.968338e-12 4.942740e-34 #> C>A_CCT 2.347529e-02 7.349768e-03 7.630364e-34 #> C>A_GCA 1.767337e-02 3.157788e-02 5.691025e-03 #> C>A_GCC 1.424257e-02 1.748020e-02 1.014869e-34 #> C>A_GCG 1.285337e-64 1.203912e-02 9.483122e-67 #> C>A_GCT 8.555769e-03 1.168081e-02 1.683258e-17 #> C>A_TCA 2.488531e-02 1.182221e-02 3.015327e-13 #> C>A_TCC 2.466496e-02 1.507377e-02 4.714786e-34 #> C>A_TCG 1.126220e-02 8.711230e-03 1.727722e-33 #> C>A_TCT 2.454132e-02 1.520943e-02 4.301613e-17 #> C>G_ACA 3.720076e-44 3.720076e-44 3.720076e-44 #> C>G_ACC 2.595663e-05 1.502043e-02 5.342027e-03 #> C>G_ACG 2.038874e-03 6.792227e-03 1.193386e-33 #> C>G_ACT 2.742966e-03 1.119504e-07 1.264509e-34 #> C>G_CCA 9.639451e-03 1.049176e-02 1.171358e-33 #> C>G_CCC 1.371533e-02 1.498665e-08 2.995019e-16 #> C>G_CCG 4.105876e-64 6.019562e-03 5.360183e-66 #> C>G_CCT 4.107476e-03 7.532273e-03 1.634147e-34 #> C>G_GCA 1.891476e-03 1.297352e-02 1.814603e-33 #> C>G_GCC 3.726155e-04 1.163028e-02 3.489254e-35 #> C>G_GCG 8.229101e-03 1.150110e-07 3.013128e-13 #> C>G_GCT 1.097217e-02 1.085797e-07 1.720778e-13 #> C>G_TCA 7.467141e-02 2.040074e-02 1.606676e-13 #> C>G_TCC 3.057653e-02 5.577622e-03 2.153462e-12 #> C>G_TCG 1.097205e-02 2.506732e-07 5.295908e-34 #> C>G_TCT 7.448028e-02 1.760067e-02 8.285057e-13 #> C>T_ACA 6.403196e-03 2.307202e-02 1.793321e-35 #> C>T_ACC 3.020069e-03 1.670874e-02 1.254062e-02 #> C>T_ACG 1.491455e-02 3.459969e-02 5.700336e-03 #> C>T_ACT 6.830307e-03 7.554477e-03 4.916733e-15 #> C>T_CCA 2.419367e-02 3.456344e-02 6.248236e-02 #> C>T_CCC 2.118356e-02 1.286786e-02 1.335619e-01 #> C>T_CCG 2.102095e-02 5.086909e-02 2.903630e-02 #> C>T_CCT 6.045208e-03 3.811245e-02 8.084269e-02 #> C>T_GCA 1.574014e-03 3.439032e-02 3.551824e-15 #> C>T_GCC 1.777753e-02 2.723358e-02 2.922491e-02 #> C>T_GCG 2.774451e-02 2.034235e-02 6.019646e-03 #> C>T_GCT 4.098337e-04 3.431291e-02 7.746617e-03 #> C>T_TCA 3.189400e-02 3.519934e-02 9.443587e-02 #> C>T_TCC 2.449972e-02 2.107020e-02 2.354123e-01 #> C>T_TCG 2.219426e-02 3.989305e-02 1.049950e-01 #> C>T_TCT 4.067045e-02 2.032979e-02 3.963147e-02 #> T>A_ATA 2.373571e-03 4.050712e-04 6.268995e-07 #> T>A_ATC 4.600210e-03 3.981849e-03 5.342031e-03 #> T>A_ATG 5.030936e-03 1.253859e-02 4.563086e-26 #> T>A_ATT 5.486136e-03 3.009781e-03 5.342034e-03 #> T>A_CTA 9.013459e-03 5.159054e-03 4.092394e-33 #> T>A_CTC 1.097227e-02 1.058355e-09 3.709747e-10 #> T>A_CTG 2.386812e-02 9.928521e-03 5.342028e-03 #> T>A_CTT 5.172173e-04 1.749118e-02 8.753248e-34 #> T>A_GTA 1.483420e-73 6.598148e-70 1.068406e-02 #> T>A_GTC 2.743066e-03 3.026769e-09 3.172478e-35 #> T>A_GTG 5.485563e-03 6.290277e-07 5.342033e-03 #> T>A_GTT 8.953417e-04 1.406651e-02 7.645306e-15 #> T>A_TTA 7.830455e-03 1.726050e-08 6.118554e-03 #> T>A_TTC 3.825787e-65 3.009781e-03 4.022010e-67 #> T>A_TTG 8.229205e-03 2.408105e-13 4.092867e-33 #> T>A_TTT 1.097650e-04 5.899124e-03 5.342033e-03 #> T>C_ATA 1.369925e-02 1.766050e-05 5.069676e-10 #> T>C_ATC 5.486137e-03 3.762914e-62 5.342032e-03 #> T>C_ATG 8.925114e-03 2.632446e-02 7.800215e-16 #> T>C_ATT 2.433390e-03 9.728480e-03 1.538829e-02 #> T>C_CTA 4.600669e-03 3.981344e-03 2.719501e-34 #> T>C_CTC 2.561366e-06 9.026533e-03 2.172342e-35 #> T>C_CTG 1.378588e-02 1.196173e-02 2.980716e-14 #> T>C_CTT 2.722357e-65 6.019562e-03 4.772865e-67 #> T>C_GTA 1.096049e-02 1.292396e-05 8.337786e-10 #> T>C_GTC 1.097207e-02 2.201382e-07 5.033614e-10 #> T>C_GTG 7.807325e-03 2.401830e-05 6.121000e-03 #> T>C_GTT 4.598791e-03 3.983399e-03 2.136814e-02 #> T>C_TTA 1.877293e-05 1.152941e-02 6.210160e-03 #> T>C_TTC 2.666685e-04 1.744657e-02 5.909145e-03 #> T>C_TTG 3.362178e-03 7.928723e-03 6.089818e-03 #> T>C_TTT 7.719903e-05 5.934856e-03 1.068407e-02 #> T>G_ATA 5.485846e-03 3.193990e-07 4.766222e-34 #> T>G_ATC 2.742837e-03 2.539378e-07 5.342032e-03 #> T>G_ATG 2.209459e-71 1.284586e-67 5.342032e-03 #> T>G_ATT 6.715116e-03 4.671088e-03 1.217154e-33 #> T>G_CTA 2.206821e-79 7.231800e-78 5.342032e-03 #> T>G_CTC 6.752989e-03 7.639313e-03 8.133268e-15 #> T>G_CTG 2.742934e-03 1.470164e-07 5.342033e-03 #> T>G_CTT 5.485469e-03 7.326000e-07 3.062070e-34 #> T>G_GTA 1.855451e-04 5.815976e-03 2.779645e-34 #> T>G_GTC 3.720076e-44 3.720076e-44 3.720076e-44 #> T>G_GTG 5.486137e-03 1.452622e-12 6.501419e-35 #> T>G_GTT 2.497966e-65 3.009781e-03 1.177083e-67 #> T>G_TTA 1.975414e-65 3.009781e-03 2.176097e-67 #> T>G_TTC 3.720076e-44 3.720076e-44 3.720076e-44 #> T>G_TTG 8.141805e-03 9.589828e-05 1.232222e-12 #> T>G_TTT 2.359148e-03 4.208018e-04 7.955750e-07 #>  #> Slot \"exposures\": #>            TCGA-56-7582-01A-11D-2042-08 TCGA-77-7335-01A-11D-2042-08 #> Signature1                   0.09060907                 175.47415750 #> Signature2                 191.81878100                  98.43519276 #> Signature3                   0.09060993                   0.09064974 #>            TCGA-94-7557-01A-11D-2122-08 TCGA-97-7938-01A-11D-2167-08 #> Signature1                     64.48884                 116.81894638 #> Signature2                     38.41289                   0.09052656 #> Signature3                     14.09827                   0.09052706 #>            TCGA-EE-A3J5-06A-11D-A20D-08 TCGA-ER-A197-06A-32D-A197-08 #> Signature1                    0.0905308                   6.89236265 #> Signature2                    0.0905325                   4.01908283 #> Signature3                  121.8189367                   0.08855452 #>            TCGA-ER-A19O-06A-11D-A197-08 #> Signature1                   0.09025138 #> Signature2                   0.09025280 #> Signature3                  50.81949582 #>  #> Slot \"num_signatures\": #> [1] 3 #>  #> Slot \"other_parameters\": #> List of length 0 #>  #> Slot \"credible_intervals\": #> List of length 0 #>  #> Slot \"metrics\": #> List of length 0 #>  #> Slot \"umap\": #> <0 x 0 matrix> #>  #> Slot \"model_id\": #> [1] \"res\" #>  #> Slot \"modality\": #> [1] \"SBS96\" #>"},{"path":"https://www.camplab.net/musicatk/reference/get_result_list_entry.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve result_list entry from a musica object — get_result_list_entry","title":"Retrieve result_list entry from a musica object — get_result_list_entry","text":"result_list contains results various runs","code":""},{"path":"https://www.camplab.net/musicatk/reference/get_result_list_entry.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve result_list entry from a musica object — get_result_list_entry","text":"","code":"get_result_list_entry(object, result_name)  # S4 method for class 'musica,character' get_result_list_entry(object, result_name)"},{"path":"https://www.camplab.net/musicatk/reference/get_result_list_entry.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve result_list entry from a musica object — get_result_list_entry","text":"object musica object generated create_musica_from_variants create_musica_from_counts function. result_name name result_list entry.","code":""},{"path":"https://www.camplab.net/musicatk/reference/get_result_list_entry.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve result_list entry from a musica object — get_result_list_entry","text":"list results","code":""},{"path":"https://www.camplab.net/musicatk/reference/get_result_list_entry.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve result_list entry from a musica object — get_result_list_entry","text":"","code":"data(res) get_result_list_entry(res, \"result\") #> An object of class \"result_collection\" #> Slot \"modality\": #> List of length 1 #> names(1): SBS96 #>  #> Slot \"parameter\": #> list() #>  #> Slot \"hyperparameter\": #> list() #>"},{"path":"https://www.camplab.net/musicatk/reference/hyperparameter.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve hyperparameter from a musica or result_collection object — hyperparameter","title":"Retrieve hyperparameter from a musica or result_collection object — hyperparameter","text":"hyperparameter contain list prior tuning parameters","code":""},{"path":"https://www.camplab.net/musicatk/reference/hyperparameter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve hyperparameter from a musica or result_collection object — hyperparameter","text":"","code":"hyperparameter(x, ...)  # S4 method for class 'musica' hyperparameter(x, result)  # S4 method for class 'result_collection' hyperparameter(x)  hyperparameter(x, ...) <- value  # S4 method for class 'musica,list' hyperparameter(x, result) <- value  # S4 method for class 'result_collection,list' hyperparameter(x) <- value"},{"path":"https://www.camplab.net/musicatk/reference/hyperparameter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve hyperparameter from a musica or result_collection object — hyperparameter","text":"x result_model result_collection object ... inputs result name result_list entry. value list hyperparameters model","code":""},{"path":"https://www.camplab.net/musicatk/reference/hyperparameter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve hyperparameter from a musica or result_collection object — hyperparameter","text":"list hyperparameters","code":""},{"path":"https://www.camplab.net/musicatk/reference/hyperparameter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve hyperparameter from a musica or result_collection object — hyperparameter","text":"","code":"data(res) hyperparameter(res, \"result\") #> list()"},{"path":"https://www.camplab.net/musicatk/reference/indel_musica.html","id":null,"dir":"Reference","previous_headings":"","what":"indel_musica — indel_musica","title":"indel_musica — indel_musica","text":"musica created testing includes INDEL variants","code":""},{"path":"https://www.camplab.net/musicatk/reference/indel_musica.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"indel_musica — indel_musica","text":"","code":"data(indel_musica)"},{"path":"https://www.camplab.net/musicatk/reference/indel_musica.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"indel_musica — indel_musica","text":"object class musica See [create_musica_from_variants()] [create_musica_from_counts()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/k_select.html","id":null,"dir":"Reference","previous_headings":"","what":"Plots for helping decide number of clusters — k_select","title":"Plots for helping decide number of clusters — k_select","text":"help decide number cluster, three different methods provided: total within cluster sum squares, average silhouette coefficient, gap statistics.","code":""},{"path":"https://www.camplab.net/musicatk/reference/k_select.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plots for helping decide number of clusters — k_select","text":"","code":"k_select(   musica,   model_name,   modality = \"SBS96\",   result_name = \"result\",   method = \"wss\",   clust.method = \"kmeans\",   n = 10,   proportional = TRUE )"},{"path":"https://www.camplab.net/musicatk/reference/k_select.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plots for helping decide number of clusters — k_select","text":"musica musica object containing mutational discovery prediction. two-dimensional UMAP stored object. model_name name desired model. modality modality model. Must \"SBS96\", \"DBS78\", \"IND83\". Default \"SBS96\". result_name Name result list entry containing desired model. Default \"result\". method single character string indicating statistic use plot. Options \"wss\" (total within cluster sum squares), \"silhouette\" (average silhouette coefficient), \"gap_stat\" (gap statistic). Default \"wss\". clust.method character string indicating clustering method. Options \"kmeans\" (default), \"hclust\" (hierarchical clustering), \"hkmeans\", \"pam\", \"clara\". n integer indicating maximum number clusters test. Default 10. proportional Logical, indicating proportional exposure (default) used clustering.","code":""},{"path":"https://www.camplab.net/musicatk/reference/k_select.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plots for helping decide number of clusters — k_select","text":"ggplot object.","code":""},{"path":[]},{"path":"https://www.camplab.net/musicatk/reference/k_select.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plots for helping decide number of clusters — k_select","text":"","code":"data(res_annot) set.seed(123) # Make an elbow plot k_select(res_annot, model_name = \"res_annot\", method = \"wss\", n = 6)  # Plot average silhouette coefficient against number of clusters k_select(res_annot, model_name = \"res_annot\", method = \"silhouette\", n = 6)  # Plot gap statistics against number of clusters k_select(res_annot, model_name = \"res_annot\", method = \"gap_stat\", n = 6)"},{"path":"https://www.camplab.net/musicatk/reference/metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve metrics from a result_model, result_collection, or musica object — metrics","title":"Retrieve metrics from a result_model, result_collection, or musica object — metrics","text":"Metrics model","code":""},{"path":"https://www.camplab.net/musicatk/reference/metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve metrics from a result_model, result_collection, or musica object — metrics","text":"","code":"metrics(x, ...)  # S4 method for class 'musica' metrics(x, result, modality, model_id)  # S4 method for class 'result_collection' metrics(x, modality, model_id)  # S4 method for class 'result_model' metrics(x)  metrics(x, ...) <- value  # S4 method for class 'musica,SimpleList' metrics(x, result, modality, model_id) <- value  # S4 method for class 'result_collection,SimpleList' metrics(x, modality, model_id) <- value  # S4 method for class 'result_model,SimpleList' metrics(x) <- value"},{"path":"https://www.camplab.net/musicatk/reference/metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve metrics from a result_model, result_collection, or musica object — metrics","text":"x musica, result_collection, result_model object generated mutational discovery prediction tool. ... inputs result Name result result_list assign metrics. Used result musica object. modality Modality assign metrics. Used result musica result_collection object. model_id Model identifier assign metrics. Used result musica result_collection object. value List metrics","code":""},{"path":"https://www.camplab.net/musicatk/reference/metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve metrics from a result_model, result_collection, or musica object — metrics","text":"metrics model","code":""},{"path":"https://www.camplab.net/musicatk/reference/metrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve metrics from a result_model, result_collection, or musica object — metrics","text":"","code":"data(res) metrics(res, \"result\", \"SBS96\", \"res\") #> List of length 0"},{"path":"https://www.camplab.net/musicatk/reference/modality.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve modality from a result_model, result_collection, or musica object — modality","title":"Retrieve modality from a result_model, result_collection, or musica object — modality","text":"modality","code":""},{"path":"https://www.camplab.net/musicatk/reference/modality.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve modality from a result_model, result_collection, or musica object — modality","text":"","code":"modality(x, ...)  # S4 method for class 'musica' modality(x, result, modality, model_id)  # S4 method for class 'result_collection' modality(x, modality, model_id)  # S4 method for class 'result_model' modality(x)  modality(x, ...) <- value  # S4 method for class 'musica,matrix' modality(x, result, modality, model_id) <- value  # S4 method for class 'result_collection,matrix' modality(x, modality, model_id) <- value  # S4 method for class 'result_model,matrix' modality(x) <- value"},{"path":"https://www.camplab.net/musicatk/reference/modality.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve modality from a result_model, result_collection, or musica object — modality","text":"x musica, result_collection, result_model object generated mutational discovery prediction tool. ... inputs result_collection object. result Name result result_list assign modality. Used result musica object. modality Modality assign modality. Used result musica result_collection object. model_id Model identifier assign modality. Used result musica value modality","code":""},{"path":"https://www.camplab.net/musicatk/reference/modality.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve modality from a result_model, result_collection, or musica object — modality","text":"modality model","code":""},{"path":"https://www.camplab.net/musicatk/reference/modality.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve modality from a result_model, result_collection, or musica object — modality","text":"","code":"data(res) modality(res, \"result\", \"SBS96\", \"res\") #> [1] \"SBS96\""},{"path":"https://www.camplab.net/musicatk/reference/model_id.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve model_id from a result_model, result_collection, or musica object — model_id","title":"Retrieve model_id from a result_model, result_collection, or musica object — model_id","text":"Model identifier","code":""},{"path":"https://www.camplab.net/musicatk/reference/model_id.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve model_id from a result_model, result_collection, or musica object — model_id","text":"","code":"model_id(x, ...)  # S4 method for class 'musica' model_id(x, result, modality, model_id)  # S4 method for class 'result_collection' model_id(x, modality, model_id)  # S4 method for class 'result_model' model_id(x)  model_id(x, ...) <- value  # S4 method for class 'musica,matrix' model_id(x, result, modality, model_id) <- value  # S4 method for class 'result_collection,matrix' model_id(x, modality, model_id) <- value  # S4 method for class 'result_model,matrix' model_id(x) <- value"},{"path":"https://www.camplab.net/musicatk/reference/model_id.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve model_id from a result_model, result_collection, or musica object — model_id","text":"x musica, result_collection, result_model object generated mutational discovery prediction tool. ... inputs result Name result result_list assign model_id. Used result musica object. modality Modality assign model_id. Used result musica result_collection object. model_id Model identifier assign model_id. Used result musica result_collection object. value Model identifier","code":""},{"path":"https://www.camplab.net/musicatk/reference/model_id.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve model_id from a result_model, result_collection, or musica object — model_id","text":"model_id model","code":""},{"path":"https://www.camplab.net/musicatk/reference/model_id.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve model_id from a result_model, result_collection, or musica object — model_id","text":"","code":"data(res) model_id(res, \"result\", \"SBS96\", \"res\") #> [1] \"res\""},{"path":"https://www.camplab.net/musicatk/reference/musica-class.html","id":null,"dir":"Reference","previous_headings":"","what":"The primary object that contains variants, count_tables, and samples annotations — musica-class","title":"The primary object that contains variants, count_tables, and samples annotations — musica-class","text":"primary object contains variants, count_tables, samples annotations","code":""},{"path":"https://www.camplab.net/musicatk/reference/musica-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"The primary object that contains variants, count_tables, and samples annotations — musica-class","text":"variants data.table variants count_tables Summary table per-sample unnormalized motif counts sample_annotations Sample-level annotations (e.g. age, sex, primary) result_list Results various algorithms, modalities, models","code":""},{"path":"https://www.camplab.net/musicatk/reference/musica.html","id":null,"dir":"Reference","previous_headings":"","what":"musica — musica","title":"musica — musica","text":"musica created testing includes SBS variants","code":""},{"path":"https://www.camplab.net/musicatk/reference/musica.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"musica — musica","text":"","code":"data(musica)"},{"path":"https://www.camplab.net/musicatk/reference/musica.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"musica — musica","text":"object class musica See [create_musica_from_variants()] [create_musica_from_counts()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/musica_annot.html","id":null,"dir":"Reference","previous_headings":"","what":"musica_annot — musica_annot","title":"musica_annot — musica_annot","text":"musica created testing includes SBS variants sample annotations","code":""},{"path":"https://www.camplab.net/musicatk/reference/musica_annot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"musica_annot — musica_annot","text":"","code":"data(musica_annot)"},{"path":"https://www.camplab.net/musicatk/reference/musica_annot.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"musica_annot — musica_annot","text":"object class musica See [create_musica_from_variants()] [create_musica_from_counts()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/musica_sbs96.html","id":null,"dir":"Reference","previous_headings":"","what":"musica_sbs96 — musica_sbs96","title":"musica_sbs96 — musica_sbs96","text":"musica created testing includes SBS variants build counts table ","code":""},{"path":"https://www.camplab.net/musicatk/reference/musica_sbs96.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"musica_sbs96 — musica_sbs96","text":"","code":"data(musica_sbs96)"},{"path":"https://www.camplab.net/musicatk/reference/musica_sbs96.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"musica_sbs96 — musica_sbs96","text":"object class musica See [build_standard_table()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/musica_sbs96_tiny.html","id":null,"dir":"Reference","previous_headings":"","what":"musica_sbs96_tiny — musica_sbs96_tiny","title":"musica_sbs96_tiny — musica_sbs96_tiny","text":"small musica created testing includes SBS variants build counts table ","code":""},{"path":"https://www.camplab.net/musicatk/reference/musica_sbs96_tiny.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"musica_sbs96_tiny — musica_sbs96_tiny","text":"","code":"data(musica_sbs96_tiny)"},{"path":"https://www.camplab.net/musicatk/reference/musica_sbs96_tiny.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"musica_sbs96_tiny — musica_sbs96_tiny","text":"object class musica See [build_standard_table()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/musicatk.html","id":null,"dir":"Reference","previous_headings":"","what":"Starts the musicatk interactive Shiny app — musicatk","title":"Starts the musicatk interactive Shiny app — musicatk","text":"musicatk Shiny app allows users perform mutational signature analysis using interative graphical user interface (GUI)","code":""},{"path":"https://www.camplab.net/musicatk/reference/musicatk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Starts the musicatk interactive Shiny app — musicatk","text":"","code":"musicatk(include_version = TRUE, theme = \"yeti\")"},{"path":"https://www.camplab.net/musicatk/reference/musicatk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Starts the musicatk interactive Shiny app — musicatk","text":"include_version Include version number header. Default TRUE. theme theme use GUI. Default \"yeti\".","code":""},{"path":"https://www.camplab.net/musicatk/reference/musicatk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Starts the musicatk interactive Shiny app — musicatk","text":"shiny app open. data returned.","code":""},{"path":"https://www.camplab.net/musicatk/reference/musicatk.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Starts the musicatk interactive Shiny app — musicatk","text":"","code":"if (FALSE) { # \\dontrun{ # Start the app musicatk() } # }"},{"path":"https://www.camplab.net/musicatk/reference/name_signatures.html","id":null,"dir":"Reference","previous_headings":"","what":"Rename signatures for a model — name_signatures","title":"Rename signatures for a model — name_signatures","text":"Rename signatures model","code":""},{"path":"https://www.camplab.net/musicatk/reference/name_signatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rename signatures for a model — name_signatures","text":"","code":"name_signatures(   musica,   model_id,   name_vector,   modality = \"SBS96\",   result_name = \"result\" )"},{"path":"https://www.camplab.net/musicatk/reference/name_signatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rename signatures for a model — name_signatures","text":"musica musica object containing mutational signature discovery prediction. model_id name model rename signatures . name_vector Vector user-defined signature names modality modality model. Must \"SBS96\", \"DBS78\", \"IND83\". Default \"SBS96\". result_name Name result list entry containing model. Default \"result\".","code":""},{"path":"https://www.camplab.net/musicatk/reference/name_signatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rename signatures for a model — name_signatures","text":"Musica object user-defined signatures names","code":""},{"path":"https://www.camplab.net/musicatk/reference/name_signatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rename signatures for a model — name_signatures","text":"","code":"data(res) name_signatures(res,   model_id = \"res\",   name_vector = c(\"smoking\", \"apobec\", \"unknown\") )"},{"path":"https://www.camplab.net/musicatk/reference/num_signatures.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve num_signatures from a result_model, result_collection, or musica object — num_signatures","title":"Retrieve num_signatures from a result_model, result_collection, or musica object — num_signatures","text":"number signatures model","code":""},{"path":"https://www.camplab.net/musicatk/reference/num_signatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve num_signatures from a result_model, result_collection, or musica object — num_signatures","text":"","code":"num_signatures(x, ...)  # S4 method for class 'musica' num_signatures(x, result, modality, model_id)  # S4 method for class 'result_collection' num_signatures(x, modality, model_id)  # S4 method for class 'result_model' num_signatures(x)  num_signatures(x, ...) <- value  # S4 method for class 'musica,matrix' num_signatures(x, result, modality, model_id) <- value  # S4 method for class 'result_collection,matrix' num_signatures(x, modality, model_id) <- value  # S4 method for class 'result_model,matrix' num_signatures(x) <- value"},{"path":"https://www.camplab.net/musicatk/reference/num_signatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve num_signatures from a result_model, result_collection, or musica object — num_signatures","text":"x musica, result_collection, result_model object generated mutational discovery prediction tool. ... inputs result Name result result_list assign num_signatures. Used result musica object. modality Modality assign num_signatures. Used result musica result_collection object. model_id Model identifier assign num_signatures. Used result musica result_collection object. value Number signatures model","code":""},{"path":"https://www.camplab.net/musicatk/reference/num_signatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve num_signatures from a result_model, result_collection, or musica object — num_signatures","text":"number signatures model","code":""},{"path":"https://www.camplab.net/musicatk/reference/num_signatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve num_signatures from a result_model, result_collection, or musica object — num_signatures","text":"","code":"data(res) num_signatures(res, \"result\", \"SBS96\", \"res\") #> [1] 3"},{"path":"https://www.camplab.net/musicatk/reference/other_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve other_parameters from a result_model, result_collection, or musica object — other_parameters","title":"Retrieve other_parameters from a result_model, result_collection, or musica object — other_parameters","text":"Parameters model","code":""},{"path":"https://www.camplab.net/musicatk/reference/other_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve other_parameters from a result_model, result_collection, or musica object — other_parameters","text":"","code":"other_parameters(x, ...)  # S4 method for class 'musica' other_parameters(x, result, modality, model_id)  # S4 method for class 'result_collection' other_parameters(x, modality, model_id)  # S4 method for class 'result_model' other_parameters(x)  other_parameters(x, ...) <- value  # S4 method for class 'musica,matrix' other_parameters(x, result, modality, model_id) <- value  # S4 method for class 'result_collection,matrix' other_parameters(x, modality, model_id) <- value  # S4 method for class 'result_model,matrix' other_parameters(x) <- value"},{"path":"https://www.camplab.net/musicatk/reference/other_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve other_parameters from a result_model, result_collection, or musica object — other_parameters","text":"x musica, result_collection, result_model object generated mutational discovery prediction tool. ... inputs result Name result result_list assign other_parameters. Used result musica object. modality Modality assign other_parameters. Used result musica result_collection object. model_id Model identifier assign other_parameters. Used result musica result_collection object. value List parameters","code":""},{"path":"https://www.camplab.net/musicatk/reference/other_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve other_parameters from a result_model, result_collection, or musica object — other_parameters","text":"parameters model","code":""},{"path":"https://www.camplab.net/musicatk/reference/other_parameters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve other_parameters from a result_model, result_collection, or musica object — other_parameters","text":"","code":"data(res) other_parameters(res, \"result\", \"SBS96\", \"res\") #> List of length 0"},{"path":"https://www.camplab.net/musicatk/reference/parameter.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve parameter from a musica or result_collection object — parameter","title":"Retrieve parameter from a musica or result_collection object — parameter","text":"parameter contains input parameters used model","code":""},{"path":"https://www.camplab.net/musicatk/reference/parameter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve parameter from a musica or result_collection object — parameter","text":"","code":"parameter(x, ...)  # S4 method for class 'musica' parameter(x, result)  # S4 method for class 'result_collection' parameter(x)  parameter(x, ...) <- value  # S4 method for class 'result_collection,list' parameter(x) <- value  # S4 method for class 'musica,list' parameter(x, result) <- value"},{"path":"https://www.camplab.net/musicatk/reference/parameter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve parameter from a musica or result_collection object — parameter","text":"x result_model result_collection object ... inputs result name result_list entry. value list input parameters","code":""},{"path":"https://www.camplab.net/musicatk/reference/parameter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve parameter from a musica or result_collection object — parameter","text":"list parameters","code":""},{"path":"https://www.camplab.net/musicatk/reference/parameter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve parameter from a musica or result_collection object — parameter","text":"","code":"data(res) parameter(res, \"result\") #> list()"},{"path":"https://www.camplab.net/musicatk/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"Pipe operator","code":""},{"path":"https://www.camplab.net/musicatk/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://www.camplab.net/musicatk/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"NA","code":""},{"path":"https://www.camplab.net/musicatk/reference/pipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Pipe operator — %>%","text":"","code":"c(1, 2) %>% barplot()"},{"path":"https://www.camplab.net/musicatk/reference/plot_cluster.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize clustering results — plot_cluster","title":"Visualize clustering results — plot_cluster","text":"clustering results can visualized UMAP panel. Three different types plots can generated using function: cluster--signature plot, cluster--annotation plot, single UMAP plot.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_cluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize clustering results — plot_cluster","text":"","code":"plot_cluster(   musica,   model_name,   modality = \"SBS96\",   result_name = \"result\",   clusters,   group = \"signature\",   annotation = NULL,   plotly = TRUE )"},{"path":"https://www.camplab.net/musicatk/reference/plot_cluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize clustering results — plot_cluster","text":"musica musica object containing mutational discovery prediction. two-dimensional UMAP stored object. model_name name desired model. modality modality model. Must \"SBS96\", \"DBS78\", \"IND83\". Default \"SBS96\". result_name Name result list entry containing desired model. Default \"result\". clusters result generated cluster_exposure function. group single character string indicating grouping factor. Possible options : \"signature\" (columns signatures grid), \"annotation\" (columns sample annotation), \"none\" (single UMAP plot). Default \"signature\". annotation Column name annotation. plotly TRUE, plot made interactive using plotly.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_cluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize clustering results — plot_cluster","text":"Generate ggplot plotly object.","code":""},{"path":[]},{"path":"https://www.camplab.net/musicatk/reference/plot_cluster.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize clustering results — plot_cluster","text":"","code":"set.seed(123) data(res_annot) # Get clustering result clust_out <- cluster_exposure(   musica = res_annot, model_name = \"res_annot\",   nclust = 2, iter.max = 15 ) #> Metric: 'euclidean'; comparing: 7 vectors. # UMAP create_umap(musica = res_annot, model_name = \"res_annot\") #> The parameter 'n_neighbors' cannot be bigger than the total number of samples. Setting 'n_neighbors' to 7. # generate cluster X signature plot plot_cluster(   musica = res_annot, model_name = \"res_annot\",   clusters = clust_out, group = \"signature\" )  {\"x\":{\"data\":[{\"x\":[-0.58989838191441102,-1.3179400307791571,-1.3290961129324774,0.11680194309779601,0.074249948774065544],\"y\":[1.5144674437386652,-1.1456973893301825,0.29282638004847961,-1.4169805390494208,-0.00011471339634461231],\"text\":[\"UMAP_1: -0.58989838<br />UMAP_2:  1.5144674437<br />exposure: 0.0004719222\",\"UMAP_1: -1.31794003<br />UMAP_2: -1.1456973893<br />exposure: 0.6404166332\",\"UMAP_1: -1.32909611<br />UMAP_2:  0.2928263800<br />exposure: 0.5511866885\",\"UMAP_1:  0.11680194<br />UMAP_2: -1.4169805390<br />exposure: 0.9984525331\",\"UMAP_1:  0.07424995<br />UMAP_2: -0.0001147134<br />exposure: 0.6265784227\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":[\"rgba(1,1,255,1)\",\"rgba(255,205,0,1)\",\"rgba(255,237,0,1)\",\"rgba(255,2,0,1)\",\"rgba(255,210,0,1)\"],\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":[\"rgba(1,1,255,1)\",\"rgba(255,205,0,1)\",\"rgba(255,237,0,1)\",\"rgba(255,2,0,1)\",\"rgba(255,210,0,1)\"]}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-0.58989838191441102,-1.3179400307791571,-1.3290961129324774,0.11680194309779601,0.074249948774065544],\"y\":[1.5144674437386652,-1.1456973893301825,0.29282638004847961,-1.4169805390494208,-0.00011471339634461231],\"text\":[\"UMAP_1: -0.58989838<br />UMAP_2:  1.5144674437<br />exposure: 0.9990561510\",\"UMAP_1: -1.31794003<br />UMAP_2: -1.1456973893<br />exposure: 0.3592525283\",\"UMAP_1: -1.32909611<br />UMAP_2:  0.2928263800<br />exposure: 0.3283152875\",\"UMAP_1:  0.11680194<br />UMAP_2: -1.4169805390<br />exposure: 0.0007737313\",\"UMAP_1:  0.07424995<br />UMAP_2: -0.0001147134<br />exposure: 0.3653711660\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":[\"rgba(255,0,0,1)\",\"rgba(162,255,0,1)\",\"rgba(136,255,0,1)\",\"rgba(5,2,255,1)\",\"rgba(167,255,0,1)\"],\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":[\"rgba(255,0,0,1)\",\"rgba(162,255,0,1)\",\"rgba(136,255,0,1)\",\"rgba(5,2,255,1)\",\"rgba(167,255,0,1)\"]}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-0.58989838191441102,-1.3179400307791571,-1.3290961129324774,0.11680194309779601,0.074249948774065544],\"y\":[1.5144674437386652,-1.1456973893301825,0.29282638004847961,-1.4169805390494208,-0.00011471339634461231],\"text\":[\"UMAP_1: -0.58989838<br />UMAP_2:  1.5144674437<br />exposure: 0.0004719267\",\"UMAP_1: -1.31794003<br />UMAP_2: -1.1456973893<br />exposure: 0.0003308385\",\"UMAP_1: -1.32909611<br />UMAP_2:  0.2928263800<br />exposure: 0.1204980240\",\"UMAP_1:  0.11680194<br />UMAP_2: -1.4169805390<br />exposure: 0.0007737356\",\"UMAP_1:  0.07424995<br />UMAP_2: -0.0001147134<br />exposure: 0.0080504112\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":[\"rgba(1,1,255,1)\",\"rgba(0,0,255,1)\",\"rgba(125,143,170,1)\",\"rgba(5,2,255,1)\",\"rgba(42,24,250,1)\"],\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":[\"rgba(1,1,255,1)\",\"rgba(0,0,255,1)\",\"rgba(125,143,170,1)\",\"rgba(5,2,255,1)\",\"rgba(42,24,250,1)\"]}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x3\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.7485348837716241,1.2973477499825616],\"y\":[-0.24260929652622742,0.99810811451503234],\"text\":[\"UMAP_1:  1.74853488<br />UMAP_2: -0.2426092965<br />exposure: 0.0007420557\",\"UMAP_1:  1.29734775<br />UMAP_2:  0.9981081145<br />exposure: 0.0017696348\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":[\"rgba(4,1,255,1)\",\"rgba(14,5,254,1)\"],\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":[\"rgba(4,1,255,1)\",\"rgba(14,5,254,1)\"]}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.7485348837716241,1.2973477499825616],\"y\":[-0.24260929652622742,0.99810811451503234],\"text\":[\"UMAP_1:  1.74853488<br />UMAP_2: -0.2426092965<br />exposure: 0.0007420697\",\"UMAP_1:  1.29734775<br />UMAP_2:  0.9981081145<br />exposure: 0.0017696628\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":[\"rgba(4,1,255,1)\",\"rgba(14,5,254,1)\"],\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":[\"rgba(4,1,255,1)\",\"rgba(14,5,254,1)\"]}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.7485348837716241,1.2973477499825616],\"y\":[-0.24260929652622742,0.99810811451503234],\"text\":[\"UMAP_1:  1.74853488<br />UMAP_2: -0.2426092965<br />exposure: 0.9985158746\",\"UMAP_1:  1.29734775<br />UMAP_2:  0.9981081145<br />exposure: 0.9964607024\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":[\"rgba(255,2,0,1)\",\"rgba(255,9,0,1)\"],\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":[\"rgba(255,2,0,1)\",\"rgba(255,9,0,1)\"]}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x3\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-1],\"y\":[-1],\"name\":\"4573121733fba8854b6a4897e9d9951b\",\"type\":\"scatter\",\"mode\":\"markers\",\"opacity\":0,\"hoverinfo\":\"skip\",\"showlegend\":false,\"marker\":{\"color\":[0,1],\"colorscale\":[[0,\"#0000FF\"],[0.0033444816053511705,\"#1A0CFD\"],[0.006688963210702341,\"#2715FA\"],[0.010033444816053514,\"#301CF8\"],[0.013377926421404682,\"#3822F6\"],[0.016722408026755852,\"#3E27F3\"],[0.020066889632107027,\"#442CF1\"],[0.023411371237458196,\"#4931EF\"],[0.026755852842809364,\"#4E35EC\"],[0.030100334448160536,\"#5239EA\"],[0.033444816053511704,\"#553DE8\"],[0.036789297658862873,\"#5941E5\"],[0.040133779264214055,\"#5C44E3\"],[0.043478260869565223,\"#5F48E1\"],[0.046822742474916391,\"#624BDE\"],[0.05016722408026756,\"#644FDC\"],[0.053511705685618728,\"#6752DA\"],[0.056856187290969903,\"#6955D7\"],[0.060200668896321072,\"#6B59D5\"],[0.063545150501672254,\"#6D5CD3\"],[0.066889632107023408,\"#6F5FD0\"],[0.070234113712374591,\"#7062CE\"],[0.073578595317725745,\"#7265CC\"],[0.076923076923076927,\"#7369C9\"],[0.08026755852842811,\"#756CC7\"],[0.083612040133779264,\"#766FC4\"],[0.086956521739130446,\"#7772C2\"],[0.090301003344481601,\"#7875C0\"],[0.093645484949832783,\"#7978BD\"],[0.096989966555183951,\"#7A7BBB\"],[0.10033444816053512,\"#7A7EB8\"],[0.10367892976588629,\"#7B81B6\"],[0.10702341137123746,\"#7C84B3\"],[0.11036789297658864,\"#7C87B1\"],[0.11371237458193981,\"#7D8AAE\"],[0.11705685618729098,\"#7D8CAC\"],[0.12040133779264214,\"#7D8FA9\"],[0.12374581939799333,\"#7D92A7\"],[0.12709030100334451,\"#7D95A4\"],[0.13043478260869565,\"#7D98A2\"],[0.13377926421404682,\"#7D9B9F\"],[0.13712374581939799,\"#7D9E9D\"],[0.14046822742474918,\"#7DA19A\"],[0.14381270903010035,\"#7DA497\"],[0.14715719063545149,\"#7CA795\"],[0.15050167224080269,\"#7CA992\"],[0.15384615384615385,\"#7BAC8F\"],[0.15719063545150502,\"#7AAF8D\"],[0.16053511705685622,\"#7AB28A\"],[0.16387959866220736,\"#79B587\"],[0.16722408026755853,\"#78B884\"],[0.17056856187290972,\"#77BB81\"],[0.17391304347826089,\"#75BE7E\"],[0.17725752508361203,\"#74C07B\"],[0.1806020066889632,\"#73C378\"],[0.1839464882943144,\"#71C675\"],[0.18729096989966557,\"#6FC972\"],[0.19063545150501673,\"#6DCC6F\"],[0.1939799331103679,\"#6BCF6C\"],[0.19732441471571907,\"#69D268\"],[0.20066889632107024,\"#67D565\"],[0.20401337792642144,\"#64D761\"],[0.20735785953177258,\"#62DA5D\"],[0.21070234113712374,\"#5FDD59\"],[0.21404682274247491,\"#5CE055\"],[0.21739130434782611,\"#58E351\"],[0.22073578595317728,\"#54E64D\"],[0.22408026755852842,\"#50E948\"],[0.22742474916387961,\"#4BEC43\"],[0.23076923076923078,\"#46EE3E\"],[0.23411371237458195,\"#40F138\"],[0.23745819397993312,\"#39F431\"],[0.24080267558528429,\"#31F729\"],[0.24414715719063546,\"#27FA20\"],[0.24749163879598665,\"#17FD12\"],[0.25083612040133779,\"#08FF00\"],[0.25418060200668902,\"#1CFF00\"],[0.25752508361204013,\"#28FF00\"],[0.2608695652173913,\"#31FF00\"],[0.26421404682274252,\"#39FF00\"],[0.26755852842809363,\"#40FF00\"],[0.27090301003344486,\"#46FF00\"],[0.27424749163879597,\"#4BFF00\"],[0.27759197324414714,\"#50FF00\"],[0.28093645484949836,\"#55FF00\"],[0.28428093645484948,\"#5AFF00\"],[0.2876254180602007,\"#5EFF00\"],[0.29096989966555187,\"#62FF00\"],[0.29431438127090298,\"#66FF00\"],[0.2976588628762542,\"#6AFF00\"],[0.30100334448160537,\"#6EFF00\"],[0.30434782608695654,\"#71FF00\"],[0.30769230769230771,\"#75FF00\"],[0.31103678929765888,\"#78FF00\"],[0.31438127090301005,\"#7BFF00\"],[0.31772575250836121,\"#7FFF00\"],[0.32107023411371244,\"#82FF00\"],[0.32441471571906355,\"#85FF00\"],[0.32775919732441472,\"#88FF00\"],[0.33110367892976594,\"#8BFF00\"],[0.33444816053511706,\"#8EFF00\"],[0.33779264214046822,\"#91FF00\"],[0.34113712374581945,\"#93FF00\"],[0.34448160535117056,\"#96FF00\"],[0.34782608695652178,\"#99FF00\"],[0.3511705685618729,\"#9CFF00\"],[0.35451505016722407,\"#9EFF00\"],[0.35785953177257529,\"#A1FF00\"],[0.3612040133779264,\"#A4FF00\"],[0.36454849498327763,\"#A6FF00\"],[0.3678929765886288,\"#A9FF00\"],[0.37123745819397991,\"#ABFF00\"],[0.37458193979933113,\"#AEFF00\"],[0.3779264214046823,\"#B0FF00\"],[0.38127090301003347,\"#B2FF00\"],[0.38461538461538464,\"#B5FF00\"],[0.38795986622073581,\"#B7FF00\"],[0.39130434782608697,\"#BAFF00\"],[0.39464882943143814,\"#BCFF00\"],[0.39799331103678931,\"#BEFF00\"],[0.40133779264214048,\"#C1FF00\"],[0.40468227424749165,\"#C3FF00\"],[0.40802675585284287,\"#C5FF00\"],[0.41137123745819398,\"#C7FF00\"],[0.41471571906354515,\"#CAFF00\"],[0.41806020066889638,\"#CCFF00\"],[0.42140468227424749,\"#CEFF00\"],[0.42474916387959871,\"#D0FF00\"],[0.42809364548494983,\"#D2FF00\"],[0.43143812709030099,\"#D5FF00\"],[0.43478260869565222,\"#D7FF00\"],[0.43812709030100333,\"#D9FF00\"],[0.44147157190635455,\"#DBFF00\"],[0.44481605351170572,\"#DDFF00\"],[0.44816053511705684,\"#DFFF00\"],[0.45150501672240806,\"#E1FF00\"],[0.45484949832775923,\"#E4FF00\"],[0.4581939799331104,\"#E6FF00\"],[0.46153846153846156,\"#E8FF00\"],[0.46488294314381273,\"#EAFF00\"],[0.4682274247491639,\"#ECFF00\"],[0.47157190635451507,\"#EEFF00\"],[0.47491638795986624,\"#F0FF00\"],[0.47826086956521741,\"#F2FF00\"],[0.48160535117056857,\"#F4FF00\"],[0.4849498327759198,\"#F6FF00\"],[0.48829431438127091,\"#F8FF00\"],[0.49163879598662208,\"#FAFF00\"],[0.4949832775919733,\"#FCFF00\"],[0.49832775919732442,\"#FEFF00\"],[0.50167224080267558,\"#FFFE00\"],[0.50501672240802675,\"#FFFD00\"],[0.50836120401337803,\"#FFFC00\"],[0.51170568561872909,\"#FFFB00\"],[0.51505016722408026,\"#FFFA00\"],[0.51839464882943143,\"#FFF900\"],[0.52173913043478259,\"#FFF700\"],[0.52508361204013387,\"#FFF600\"],[0.52842809364548504,\"#FFF500\"],[0.5317725752508361,\"#FFF400\"],[0.53511705685618727,\"#FFF300\"],[0.53846153846153844,\"#FFF100\"],[0.54180602006688972,\"#FFF000\"],[0.54515050167224088,\"#FFEF00\"],[0.54849498327759194,\"#FFEE00\"],[0.55183946488294311,\"#FFED00\"],[0.55518394648829428,\"#FFEB00\"],[0.55852842809364556,\"#FFEA00\"],[0.56187290969899673,\"#FFE900\"],[0.56521739130434789,\"#FFE800\"],[0.56856187290969895,\"#FFE700\"],[0.57190635451505012,\"#FFE600\"],[0.5752508361204014,\"#FFE400\"],[0.57859531772575257,\"#FFE300\"],[0.58193979933110374,\"#FFE200\"],[0.5852842809364549,\"#FFE100\"],[0.58862876254180596,\"#FFE000\"],[0.59197324414715724,\"#FFDE00\"],[0.59531772575250841,\"#FFDD00\"],[0.59866220735785958,\"#FFDC00\"],[0.60200668896321075,\"#FFDB00\"],[0.60535117056856191,\"#FFDA00\"],[0.60869565217391308,\"#FFD800\"],[0.61204013377926425,\"#FFD700\"],[0.61538461538461542,\"#FFD600\"],[0.61872909698996659,\"#FFD500\"],[0.62207357859531776,\"#FFD400\"],[0.62541806020066892,\"#FFD200\"],[0.62876254180602009,\"#FFD100\"],[0.63210702341137126,\"#FFD000\"],[0.63545150501672243,\"#FFCF00\"],[0.6387959866220736,\"#FFCE00\"],[0.64214046822742488,\"#FFCC00\"],[0.64548494983277593,\"#FFCB00\"],[0.6488294314381271,\"#FFCA00\"],[0.65217391304347827,\"#FFC900\"],[0.65551839464882944,\"#FFC800\"],[0.65886287625418061,\"#FFC600\"],[0.66220735785953189,\"#FFC500\"],[0.66555183946488294,\"#FFC400\"],[0.66889632107023411,\"#FFC300\"],[0.67224080267558528,\"#FFC200\"],[0.67558528428093645,\"#FFC000\"],[0.67892976588628773,\"#FFBF00\"],[0.6822742474916389,\"#FFBE00\"],[0.68561872909698995,\"#FFBD00\"],[0.68896321070234112,\"#FFBC00\"],[0.69230769230769229,\"#FFBA00\"],[0.69565217391304357,\"#FFB900\"],[0.69899665551839474,\"#FFB800\"],[0.7023411371237458,\"#FFB700\"],[0.70568561872909696,\"#FFB500\"],[0.70903010033444813,\"#FFB400\"],[0.71237458193979941,\"#FFB300\"],[0.71571906354515058,\"#FFB200\"],[0.71906354515050175,\"#FFB000\"],[0.72240802675585281,\"#FFAF00\"],[0.72575250836120397,\"#FFAE00\"],[0.72909698996655525,\"#FFAD00\"],[0.73244147157190642,\"#FFAC00\"],[0.73578595317725759,\"#FFAA00\"],[0.73913043478260876,\"#FFA900\"],[0.74247491638795982,\"#FFA800\"],[0.7458193979933111,\"#FFA700\"],[0.74916387959866226,\"#FFA500\"],[0.75250836120401343,\"#FFA400\"],[0.7558528428093646,\"#FFA300\"],[0.75919732441471577,\"#FFA100\"],[0.76254180602006694,\"#FFA000\"],[0.76588628762541811,\"#FF9F00\"],[0.76923076923076927,\"#FF9D00\"],[0.77257525083612044,\"#FF9C00\"],[0.77591973244147161,\"#FF9A00\"],[0.77926421404682278,\"#FF9900\"],[0.78260869565217395,\"#FF9800\"],[0.78595317725752512,\"#FF9600\"],[0.78929765886287628,\"#FF9500\"],[0.79264214046822745,\"#FF9300\"],[0.79598662207357862,\"#FF9200\"],[0.79933110367892979,\"#FF9100\"],[0.80267558528428096,\"#FF8F00\"],[0.80602006688963213,\"#FF8E00\"],[0.80936454849498329,\"#FF8C00\"],[0.81270903010033446,\"#FF8B00\"],[0.81605351170568574,\"#FF8900\"],[0.8193979933110368,\"#FF8800\"],[0.82274247491638797,\"#FF8700\"],[0.82608695652173914,\"#FF8500\"],[0.8294314381270903,\"#FF8400\"],[0.83277591973244158,\"#FF8200\"],[0.83612040133779275,\"#FF8100\"],[0.83946488294314381,\"#FF7F00\"],[0.84280936454849498,\"#FF7E00\"],[0.84615384615384615,\"#FF7C00\"],[0.84949832775919742,\"#FF7B00\"],[0.85284280936454859,\"#FF7900\"],[0.85618729096989965,\"#FF7700\"],[0.85953177257525082,\"#FF7600\"],[0.86287625418060199,\"#FF7400\"],[0.86622073578595327,\"#FF7300\"],[0.86956521739130443,\"#FF7100\"],[0.8729096989966556,\"#FF6F00\"],[0.87625418060200666,\"#FF6E00\"],[0.87959866220735783,\"#FF6C00\"],[0.88294314381270911,\"#FF6A00\"],[0.88628762541806028,\"#FF6900\"],[0.88963210702341144,\"#FF6700\"],[0.89297658862876261,\"#FF6500\"],[0.89632107023411367,\"#FF6300\"],[0.89966555183946495,\"#FF6200\"],[0.90301003344481612,\"#FF6000\"],[0.90635451505016729,\"#FF5E00\"],[0.90969899665551845,\"#FF5C00\"],[0.91304347826086962,\"#FF5A00\"],[0.91638795986622079,\"#FF5800\"],[0.91973244147157196,\"#FF5600\"],[0.92307692307692313,\"#FF5500\"],[0.9264214046822743,\"#FF5200\"],[0.92976588628762546,\"#FF5000\"],[0.93311036789297652,\"#FF4E00\"],[0.9364548494983278,\"#FF4C00\"],[0.93979933110367897,\"#FF4A00\"],[0.94314381270903014,\"#FF4800\"],[0.94648829431438131,\"#FF4500\"],[0.94983277591973247,\"#FF4300\"],[0.95317725752508364,\"#FF4100\"],[0.95652173913043481,\"#FF3E00\"],[0.95986622073578598,\"#FF3B00\"],[0.96321070234113715,\"#FF3900\"],[0.96655518394648832,\"#FF3600\"],[0.9698996655518396,\"#FF3300\"],[0.97324414715719065,\"#FF2F00\"],[0.97658862876254182,\"#FF2C00\"],[0.97993311036789299,\"#FF2800\"],[0.98327759197324416,\"#FF2400\"],[0.98662207357859544,\"#FF2000\"],[0.98996655518394661,\"#FF1A00\"],[0.99331103678929766,\"#FF1400\"],[0.99665551839464883,\"#FF0B00\"],[1,\"#FF0000\"]],\"colorbar\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"thickness\":23.039999999999996,\"title\":\"Fraction\",\"titlefont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"tickmode\":\"array\",\"ticktext\":[\"0.25\",\"0.50\",\"0.75\"],\"tickvals\":[0.25082119181069279,0.50030587346743638,0.7497905551241798],\"tickfont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"ticklen\":2,\"len\":0.5}},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":34.995433789954348,\"r\":18.99543378995434,\"b\":37.260273972602747,\"l\":37.260273972602747},\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xaxis\":{\"domain\":[0,0.32191780821917804],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1.4829776627676825,1.9024164336068292],\"tickmode\":\"array\",\"ticktext\":[\"-1\",\"0\",\"1\"],\"tickvals\":[-1,0,1],\"categoryorder\":\"array\",\"categoryarray\":[\"-1\",\"0\",\"1\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"annotations\":[{\"text\":\"UMAP_1\",\"x\":0.5,\"y\":0,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"top\",\"annotationType\":\"axis\",\"yshift\":-21.917808219178088},{\"text\":\"UMAP_2\",\"x\":0,\"y\":0.5,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-90,\"xanchor\":\"right\",\"yanchor\":\"center\",\"annotationType\":\"axis\",\"xshift\":-21.917808219178088},{\"text\":\"Signature1\",\"x\":0.16095890410958902,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Signature2\",\"x\":0.5,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Signature3\",\"x\":0.83904109589041087,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"1\",\"x\":1,\"y\":0.75570776255707761,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":90,\"xanchor\":\"left\",\"yanchor\":\"middle\"},{\"text\":\"2\",\"x\":1,\"y\":0.24429223744292236,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":90,\"xanchor\":\"left\",\"yanchor\":\"middle\"}],\"yaxis\":{\"domain\":[0.51141552511415522,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1.5635529381888251,1.6610398428780695],\"tickmode\":\"array\",\"ticktext\":[\"-1\",\"0\",\"1\"],\"tickvals\":[-1,0,0.99999999999999978],\"categoryorder\":\"array\",\"categoryarray\":[\"-1\",\"0\",\"1\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32191780821917804,\"y0\":0.51141552511415522,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32191780821917804,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.34474885844748859,\"x1\":0.65525114155251141,\"y0\":0.51141552511415522,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.34474885844748859,\"x1\":0.65525114155251141,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67808219178082185,\"x1\":1,\"y0\":0.51141552511415522,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67808219178082185,\"x1\":1,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"y0\":0.51141552511415522,\"y1\":1,\"x0\":0,\"x1\":23.37899543378996,\"xanchor\":1,\"xsizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32191780821917804,\"y0\":0,\"y1\":0.48858447488584472},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.34474885844748859,\"x1\":0.65525114155251141,\"y0\":0,\"y1\":0.48858447488584472},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67808219178082185,\"x1\":1,\"y0\":0,\"y1\":0.48858447488584472},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"y0\":0,\"y1\":0.48858447488584472,\"x0\":0,\"x1\":23.37899543378996,\"xanchor\":1,\"xsizemode\":\"pixel\"}],\"xaxis2\":{\"type\":\"linear\",\"autorange\":false,\"range\":[-1.4829776627676825,1.9024164336068292],\"tickmode\":\"array\",\"ticktext\":[\"-1\",\"0\",\"1\"],\"tickvals\":[-1,0,1],\"categoryorder\":\"array\",\"categoryarray\":[\"-1\",\"0\",\"1\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"domain\":[0.34474885844748859,0.65525114155251141],\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"xaxis3\":{\"type\":\"linear\",\"autorange\":false,\"range\":[-1.4829776627676825,1.9024164336068292],\"tickmode\":\"array\",\"ticktext\":[\"-1\",\"0\",\"1\"],\"tickvals\":[-1,0,1],\"categoryorder\":\"array\",\"categoryarray\":[\"-1\",\"0\",\"1\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"domain\":[0.67808219178082185,1],\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"yaxis2\":{\"type\":\"linear\",\"autorange\":false,\"range\":[-1.5635529381888251,1.6610398428780695],\"tickmode\":\"array\",\"ticktext\":[\"-1\",\"0\",\"1\"],\"tickvals\":[-1,0,0.99999999999999978],\"categoryorder\":\"array\",\"categoryarray\":[\"-1\",\"0\",\"1\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"domain\":[0,0.48858447488584472],\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Fraction\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"10c2636ba4d\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"}},\"cur_data\":\"10c2636ba4d\",\"visdat\":{\"10c2636ba4d\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}# generate cluster X annotation plot plot_cluster(   musica = res_annot, model_name = \"res_annot\",   clusters = clust_out, group = \"annotation\",   annotation = \"Tumor_Subtypes\" )  {\"x\":{\"data\":[{\"x\":[0.074249948774065544],\"y\":[-0.00011471339634461231],\"text\":\"cluster: 1<br />UMAP_1:  0.07424995<br />UMAP_2: -0.0001147134\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\"}},\"hoveron\":\"points\",\"name\":\"1\",\"legendgroup\":\"1\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-0.58989838191441102,-1.3179400307791571,-1.3290961129324774,0.11680194309779601],\"y\":[1.5144674437386652,-1.1456973893301825,0.29282638004847961,-1.4169805390494208],\"text\":[\"cluster: 1<br />UMAP_1: -0.58989838<br />UMAP_2:  1.5144674437\",\"cluster: 1<br />UMAP_1: -1.31794003<br />UMAP_2: -1.1456973893\",\"cluster: 1<br />UMAP_1: -1.32909611<br />UMAP_2:  0.2928263800\",\"cluster: 1<br />UMAP_1:  0.11680194<br />UMAP_2: -1.4169805390\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\"}},\"hoveron\":\"points\",\"name\":\"1\",\"legendgroup\":\"1\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.7485348837716241,1.2973477499825616],\"y\":[-0.24260929652622742,0.99810811451503234],\"text\":[\"cluster: 2<br />UMAP_1:  1.74853488<br />UMAP_2: -0.2426092965\",\"cluster: 2<br />UMAP_1:  1.29734775<br />UMAP_2:  0.9981081145\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,191,196,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,191,196,1)\"}},\"hoveron\":\"points\",\"name\":\"2\",\"legendgroup\":\"2\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":34.995433789954348,\"r\":18.99543378995434,\"b\":37.260273972602747,\"l\":37.260273972602747},\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xaxis\":{\"domain\":[0,0.48858447488584472],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1.4829776627676825,1.9024164336068292],\"tickmode\":\"array\",\"ticktext\":[\"-1\",\"0\",\"1\"],\"tickvals\":[-1,0,1],\"categoryorder\":\"array\",\"categoryarray\":[\"-1\",\"0\",\"1\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"annotations\":[{\"text\":\"UMAP_1\",\"x\":0.5,\"y\":0,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"top\",\"annotationType\":\"axis\",\"yshift\":-21.917808219178088},{\"text\":\"UMAP_2\",\"x\":0,\"y\":0.5,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-90,\"xanchor\":\"right\",\"yanchor\":\"center\",\"annotationType\":\"axis\",\"xshift\":-21.917808219178088},{\"text\":\"Breast\",\"x\":0.24429223744292236,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Lung\",\"x\":0.75570776255707761,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"1\",\"x\":1,\"y\":0.75570776255707761,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":90,\"xanchor\":\"left\",\"yanchor\":\"middle\"},{\"text\":\"2\",\"x\":1,\"y\":0.24429223744292236,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":90,\"xanchor\":\"left\",\"yanchor\":\"middle\"}],\"yaxis\":{\"domain\":[0.51141552511415522,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1.5635529381888251,1.6610398428780695],\"tickmode\":\"array\",\"ticktext\":[\"-1\",\"0\",\"1\"],\"tickvals\":[-1,0,0.99999999999999978],\"categoryorder\":\"array\",\"categoryarray\":[\"-1\",\"0\",\"1\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.48858447488584472,\"y0\":0.51141552511415522,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.48858447488584472,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.51141552511415522,\"x1\":1,\"y0\":0.51141552511415522,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.51141552511415522,\"x1\":1,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"y0\":0.51141552511415522,\"y1\":1,\"x0\":0,\"x1\":23.37899543378996,\"xanchor\":1,\"xsizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.48858447488584472,\"y0\":0,\"y1\":0.48858447488584472},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.51141552511415522,\"x1\":1,\"y0\":0,\"y1\":0.48858447488584472},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"y0\":0,\"y1\":0.48858447488584472,\"x0\":0,\"x1\":23.37899543378996,\"xanchor\":1,\"xsizemode\":\"pixel\"}],\"xaxis2\":{\"type\":\"linear\",\"autorange\":false,\"range\":[-1.4829776627676825,1.9024164336068292],\"tickmode\":\"array\",\"ticktext\":[\"-1\",\"0\",\"1\"],\"tickvals\":[-1,0,1],\"categoryorder\":\"array\",\"categoryarray\":[\"-1\",\"0\",\"1\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"domain\":[0.51141552511415522,1],\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"yaxis2\":{\"type\":\"linear\",\"autorange\":false,\"range\":[-1.5635529381888251,1.6610398428780695],\"tickmode\":\"array\",\"ticktext\":[\"-1\",\"0\",\"1\"],\"tickvals\":[-1,0,0.99999999999999978],\"categoryorder\":\"array\",\"categoryarray\":[\"-1\",\"0\",\"1\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"domain\":[0,0.48858447488584472],\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"cluster\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"10c26c40187\":{\"colour\":{},\"x\":{},\"y\":{},\"type\":\"scatter\"}},\"cur_data\":\"10c26c40187\",\"visdat\":{\"10c26c40187\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}# generate a single UMAP plot plot_cluster(   musica = res_annot, model_name = \"res_annot\",   clusters = clust_out, group = \"none\" )  {\"x\":{\"data\":[{\"x\":[-0.58989838191441102,-1.3179400307791571,-1.3290961129324774,0.11680194309779601,0.074249948774065544],\"y\":[1.5144674437386652,-1.1456973893301825,0.29282638004847961,-1.4169805390494208,-0.00011471339634461231],\"text\":[\"cluster: 1<br />UMAP_1: -0.58989838<br />UMAP_2:  1.5144674437\",\"cluster: 1<br />UMAP_1: -1.31794003<br />UMAP_2: -1.1456973893\",\"cluster: 1<br />UMAP_1: -1.32909611<br />UMAP_2:  0.2928263800\",\"cluster: 1<br />UMAP_1:  0.11680194<br />UMAP_2: -1.4169805390\",\"cluster: 1<br />UMAP_1:  0.07424995<br />UMAP_2: -0.0001147134\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\"}},\"hoveron\":\"points\",\"name\":\"1\",\"legendgroup\":\"1\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.7485348837716241,1.2973477499825616],\"y\":[-0.24260929652622742,0.99810811451503234],\"text\":[\"cluster: 2<br />UMAP_1:  1.74853488<br />UMAP_2: -0.2426092965\",\"cluster: 2<br />UMAP_1:  1.29734775<br />UMAP_2:  0.9981081145\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,191,196,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,191,196,1)\"}},\"hoveron\":\"points\",\"name\":\"2\",\"legendgroup\":\"2\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":23.305936073059364,\"r\":7.3059360730593621,\"b\":37.260273972602747,\"l\":37.260273972602747},\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1.4829776627676825,1.9024164336068292],\"tickmode\":\"array\",\"ticktext\":[\"-1\",\"0\",\"1\"],\"tickvals\":[-1,0,1],\"categoryorder\":\"array\",\"categoryarray\":[\"-1\",\"0\",\"1\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"UMAP_1\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1.5635529381888251,1.6610398428780695],\"tickmode\":\"array\",\"ticktext\":[\"-1\",\"0\",\"1\"],\"tickvals\":[-1,0,0.99999999999999978],\"categoryorder\":\"array\",\"categoryarray\":[\"-1\",\"0\",\"1\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"UMAP_2\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"cluster\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"10c26f4119d7\":{\"colour\":{},\"x\":{},\"y\":{},\"type\":\"scatter\"}},\"cur_data\":\"10c26f4119d7\",\"visdat\":{\"10c26f4119d7\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}"},{"path":"https://www.camplab.net/musicatk/reference/plot_differential_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare exposures of annotated samples — plot_differential_analysis","title":"Compare exposures of annotated samples — plot_differential_analysis","text":"plot_differential_analysis used plot differential analysis created exposure_differential_analysis.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_differential_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare exposures of annotated samples — plot_differential_analysis","text":"","code":"plot_differential_analysis(analysis, analysis_type, samp_num)"},{"path":"https://www.camplab.net/musicatk/reference/plot_differential_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare exposures of annotated samples — plot_differential_analysis","text":"analysis Analysis created exposure_differential_analysis analysis_type Currently \"glm\" supported samp_num Number samples went analysis","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_differential_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare exposures of annotated samples — plot_differential_analysis","text":"Generates ggplot object","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_differential_analysis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare exposures of annotated samples — plot_differential_analysis","text":"","code":"data(\"res_annot\") analysis <- exposure_differential_analysis(res_annot,   model_name = \"res_annot\",   annotation = \"Tumor_Subtypes\", method = \"wilcox\" ) plot_differential_analysis(analysis, \"glm\", 2)"},{"path":"https://www.camplab.net/musicatk/reference/plot_exposures.html","id":null,"dir":"Reference","previous_headings":"","what":"Display sample exposures with bar, box, or violin plots — plot_exposures","title":"Display sample exposures with bar, box, or violin plots — plot_exposures","text":"distributions mutational signatures can viewed barplots box/violin plots. Barplots useful viewing proportion signatures within across samples. box/violin plots useful viewing distributions signatures respect sample annotations. Samples can grouped using group_by parameter. barplots, various methods sorting samples left right can chosen using sort_samples parameter.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_exposures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Display sample exposures with bar, box, or violin plots — plot_exposures","text":"","code":"plot_exposures(   musica,   model_name,   modality = \"SBS96\",   result_name = \"result\",   plot_type = c(\"bar\", \"box\", \"violin\"),   proportional = FALSE,   group_by = \"none\",   color_by = c(\"signature\", \"annotation\"),   annotation = NULL,   num_samples = NULL,   sort_samples = \"total\",   threshold = NULL,   same_scale = FALSE,   add_points = FALSE,   point_size = 2,   label_x_axis = FALSE,   legend = TRUE,   plotly = FALSE )"},{"path":"https://www.camplab.net/musicatk/reference/plot_exposures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Display sample exposures with bar, box, or violin plots — plot_exposures","text":"musica musica object containing mutational discovery prediction. model_name name desired model. modality modality model. Must \"SBS96\", \"DBS78\", \"IND83\". Default \"SBS96\". result_name Name result list entry containing desired model. Default \"result\". plot_type One \"bar\", \"box\", \"violin\". Default \"bar\". proportional TRUE, exposures normalized 0 1 dividing total number counts sample. Default FALSE. group_by Determines group samples subplots (.e. facets). One \"none\", \"signature\" \"annotation\". set \"annotation\", sample annotation must supplied via annotation parameter. Default \"none\". color_by Determines color bars box/violins. One \"signature\" \"annotation\". set \"annotation\", sample annotation must supplied via annotation parameter. Default \"signature\". annotation Sample annotation used group subplots /color bars, boxes, violins. Default NULL. num_samples top number sorted samples display. NULL, samples displayed. group_by set, top samples shown within group. Default NULL. sort_samples used change samples sorted barplot left right. set \"total\", samples sorted highest number mutation counts lowest (regardless parameter \"proportional\" set). set \"name\", samples sorted name mixedsort function. set one signature names (e.g. \"Signature1\"), samples sorted highest level signature lowest. multiple signatures supplied , samples sorted signature sequentially. Default \"total\". threshold Exposures less threshold set 0. useful one signature supplied sort_samples samples set zero first exposure sorted levels second exposure. Default NULL. same_scale TRUE, subplots scale. used group_by set. Default FALSE. add_points TRUE, points individual sample exposures plotted top violin/box plots. used plot_type set \"violin\" \"box\". Default TRUE. point_size Size points plotted top violin/box plots. used plot_type set \"violin\" \"box\" add_points set TRUE. Default 2. label_x_axis TRUE, x-axis labels displayed bottom plot. Default FALSE. legend TRUE, legend displayed. Default TRUE. plotly TRUE, plot made interactive using plotly. Default FALSE.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_exposures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Display sample exposures with bar, box, or violin plots — plot_exposures","text":"Generates ggplot plotly object","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_exposures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Display sample exposures with bar, box, or violin plots — plot_exposures","text":"","code":"data(res_annot) plot_exposures(res_annot,   model_name = \"res_annot\", plot_type = \"bar\",   annotation = \"Tumor_Subtypes\" )"},{"path":"https://www.camplab.net/musicatk/reference/plot_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot heatmaps using the exposures matrix — plot_heatmap","title":"Plot heatmaps using the exposures matrix — plot_heatmap","text":"exposures different signatures can visualized using heatmap function. Heatmaps make easier visualize data representing magnitude exposure values color 2-dimensions. variation color intensity can help see exposures clustered vary space. Exposures can normalized providing proportional argument. Column annotations can also seen passing col_annot argument.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot heatmaps using the exposures matrix — plot_heatmap","text":"","code":"plot_heatmap(   musica,   model_name,   modality = \"SBS96\",   result_name = \"result\",   proportional = FALSE,   show_column_names = FALSE,   show_row_names = TRUE,   scale = TRUE,   subset_tumor = NULL,   subset_signatures = NULL,   annotation = NULL,   ... )"},{"path":"https://www.camplab.net/musicatk/reference/plot_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot heatmaps using the exposures matrix — plot_heatmap","text":"musica musica object containing mutational discovery prediction. model_name name desired model. modality modality model. Must \"SBS96\", \"DBS78\", \"IND83\". Default \"SBS96\". result_name Name result list entry containing desired model. Default \"result\". proportional TRUE, exposures normalized 0 1 dividing total number counts sample. Default FALSE. show_column_names Boolean check. True, column names shown. Otherwise, . Default FALSE show_row_names Boolean check. True, row names shown. Otherwise, . Default FALSE scale Boolean check. True, values scaled z-score. Otherwise, . Default TRUE subset_tumor Users can specify certain tumor types want subset exposure matrix plotting heatmap. subset_signatures Users can specify certain signatures  want subset exposure matrix plotting heatmap. annotation Users option plotting exposure matrix based given annotation like Tumor_Subtypes age. Error given user given annotation exist res_annot annotation object. ... Ellipsis used passing arguments directly ComplexHeatmap's heatmap function.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot heatmaps using the exposures matrix — plot_heatmap","text":"Generates heatmap using exposure matrix.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot heatmaps using the exposures matrix — plot_heatmap","text":"","code":"data(res_annot) plot_heatmap(   musica = res_annot, model_name = \"res_annot\",   proportional = TRUE, scale = TRUE, annotation = \"Tumor_Subtypes\" )"},{"path":"https://www.camplab.net/musicatk/reference/plot_k_comparison.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot k comparison — plot_k_comparison","title":"Plot k comparison — plot_k_comparison","text":"Plot results comparing k values","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_k_comparison.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot k comparison — plot_k_comparison","text":"","code":"plot_k_comparison(k_comparison)"},{"path":"https://www.camplab.net/musicatk/reference/plot_k_comparison.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot k comparison — plot_k_comparison","text":"k_comparison data.frame k value comparisons returned compare_k_vals function.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_k_comparison.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot k comparison — plot_k_comparison","text":"ggplot figure","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_k_comparison.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot k comparison — plot_k_comparison","text":"","code":"data(musica) k_comparison <- compare_k_vals(musica, \"SBS96\",   reps = 3, min_k = 1,   max_k = 5 ) #>  #> k = 1: #> Calculating signatures on original count table... #>  #> Replicate 1 of 3... #> Replicate 2 of 3... #> Replicate 3 of 3... #>  #> k = 2: #> Calculating signatures on original count table... #>  #> Replicate 1 of 3... #> Replicate 2 of 3... #> Replicate 3 of 3... #>  #> k = 3: #> Calculating signatures on original count table... #>  #> Replicate 1 of 3... #> Replicate 2 of 3... #> Replicate 3 of 3... #>  #> k = 4: #> Calculating signatures on original count table... #>  #> Replicate 1 of 3... #> Replicate 2 of 3... #> Replicate 3 of 3... #>  #> k = 5: #> Calculating signatures on original count table... #>  #> Replicate 1 of 3... #> Replicate 2 of 3... #> Replicate 3 of 3... #> Warning: Removed 1 row containing missing values or values outside the scale range #> (`geom_line()`). #> Warning: Removed 1 row containing missing values or values outside the scale range #> (`geom_point()`).  plot_k_comparison(k_comparison) #> Warning: Removed 1 row containing missing values or values outside the scale range #> (`geom_line()`). #> Warning: Removed 1 row containing missing values or values outside the scale range #> (`geom_point()`)."},{"path":"https://www.camplab.net/musicatk/reference/plot_sample_counts.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot distribution of sample counts — plot_sample_counts","title":"Plot distribution of sample counts — plot_sample_counts","text":"Displays proportion counts mutation type across one samples.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_sample_counts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot distribution of sample counts — plot_sample_counts","text":"","code":"plot_sample_counts(   musica,   sample_names,   modality = \"SBS96\",   text_size = 10,   show_x_labels = TRUE,   show_y_labels = TRUE,   same_scale = TRUE,   annotation = NULL,   table_name = NULL )"},{"path":"https://www.camplab.net/musicatk/reference/plot_sample_counts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot distribution of sample counts — plot_sample_counts","text":"musica musica object. sample_names Names samples plot. modality Name table used plotting counts. Default \"SBS96\". text_size Size axis text. Default 10. show_x_labels TRUE, labels mutation types x-axis shown. Default TRUE. show_y_labels TRUE, y-axis ticks labels shown. Default TRUE. same_scale TRUE, scale y-axis sample . FALSE, scale y-axis adjusted sample. Default TRUE. annotation Vector annotations displayed top right corner sample. Vector length must equivalent number samples. Default NULL. table_name Use modality instead","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_sample_counts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot distribution of sample counts — plot_sample_counts","text":"Generates ggplot object","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_sample_counts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot distribution of sample counts — plot_sample_counts","text":"","code":"data(musica_sbs96) plot_sample_counts(musica_sbs96,   sample_names =     sample_names(musica_sbs96)[1] )"},{"path":"https://www.camplab.net/musicatk/reference/plot_sample_reconstruction_error.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot reconstruction error for a sample — plot_sample_reconstruction_error","title":"Plot reconstruction error for a sample — plot_sample_reconstruction_error","text":"Displays observed distribution counts mutation type, distribution reconstructed counts mutation type using inferred mutational signatures, difference two distributions.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_sample_reconstruction_error.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot reconstruction error for a sample — plot_sample_reconstruction_error","text":"","code":"plot_sample_reconstruction_error(   musica,   sample,   model_id,   modality = \"SBS96\",   result_name = \"result\",   plotly = FALSE )"},{"path":"https://www.camplab.net/musicatk/reference/plot_sample_reconstruction_error.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot reconstruction error for a sample — plot_sample_reconstruction_error","text":"musica musica object. sample Name sample within musica object. model_id name desired model. modality modality model. Must \"SBS96\", \"DBS78\", \"IND83\". Default \"SBS96\". result_name Name result list entry containing desired model. Default \"result\". plotly TRUE, plot made interactive using plotly. Default FALSE.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_sample_reconstruction_error.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot reconstruction error for a sample — plot_sample_reconstruction_error","text":"Generates ggplot plotly object","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_sample_reconstruction_error.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot reconstruction error for a sample — plot_sample_reconstruction_error","text":"","code":"data(res) plot_sample_reconstruction_error(res, \"TCGA-ER-A197-06A-32D-A197-08\", model_id = \"res\") #> Warning: Removed 85 rows containing missing values or values outside the scale range #> (`geom_bar()`)."},{"path":"https://www.camplab.net/musicatk/reference/plot_signatures.html","id":null,"dir":"Reference","previous_headings":"","what":"Plots the mutational signatures — plot_signatures","title":"Plots the mutational signatures — plot_signatures","text":"mutational signature discovery performed, function can used display distribution mutational signature. color_variable color_mapping parameters can used change default color scheme bars.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_signatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plots the mutational signatures — plot_signatures","text":"","code":"plot_signatures(   musica,   model_id,   modality = \"SBS96\",   result_name = \"result\",   color_variable = NULL,   color_mapping = NULL,   text_size = 10,   show_x_labels = TRUE,   show_y_labels = TRUE,   same_scale = FALSE,   y_max = NULL,   annotation = NULL,   percent = TRUE,   plotly = FALSE )"},{"path":"https://www.camplab.net/musicatk/reference/plot_signatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plots the mutational signatures — plot_signatures","text":"musica musica object containing mutational discovery prediction. model_id name model plot. modality modality signatures plot. Must \"SBS96\", \"DBS78\", \"IND83\". Default \"SBS96\". result_name Name result list entry containing signatures plot. Default \"result\". color_variable Name column variant annotation data.frame use coloring mutation type bars. variant annotation data.frame can found within count table musica object. NULL, default column specified count table used. Default NULL. color_mapping character vector used map items color_variable color. items color_mapping correspond colors. names items color_mapping correspond unique items color_variable. NULL, default color_mapping specified count table used. Default NULL. text_size Size axis text. Default 10. show_x_labels TRUE, labels mutation types x-axis shown. Default TRUE. show_y_labels TRUE, y-axis ticks labels shown. Default TRUE. same_scale TRUE, scale probability signature . FALSE, scale y-axis adjusted signature. Default FALE. y_max Vector maximum y-axis limits signature. One value may also provided specify constant y-axis limit signatures. Vector length must 1 equivalent number signatures. Default NULL. annotation Vector annotations displayed top right corner signature. Vector length must equivalent number signatures. Default NULL. percent TRUE, y-axis represented percent format instead mutation counts. Default TRUE. plotly TRUE, plot made interactive using plotly. Default FALSE.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_signatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plots the mutational signatures — plot_signatures","text":"Generates ggplot plotly object","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_signatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plots the mutational signatures — plot_signatures","text":"","code":"data(res) plot_signatures(res, model_id = \"res\")"},{"path":"https://www.camplab.net/musicatk/reference/plot_umap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a UMAP from a musica result — plot_umap","title":"Plot a UMAP from a musica result — plot_umap","text":"Plots samples UMAP scatterplot. Samples can colored levels mutational signatures annotation variable.","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_umap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a UMAP from a musica result — plot_umap","text":"","code":"plot_umap(   musica,   model_name,   modality = \"SBS96\",   result_name = \"result\",   color_by = c(\"signatures\", \"annotation\", \"cluster\", \"none\"),   proportional = TRUE,   annotation = NULL,   point_size = 0.7,   same_scale = TRUE,   add_annotation_labels = FALSE,   annotation_label_size = 3,   annotation_text_box = TRUE,   plotly = FALSE,   clust = NULL,   legend = TRUE,   strip_axes = FALSE )"},{"path":"https://www.camplab.net/musicatk/reference/plot_umap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a UMAP from a musica result — plot_umap","text":"musica musica object containing mutational signature discovery prediction. model_name name desired model. modality modality model. Must \"SBS96\", \"DBS78\", \"IND83\". Default \"SBS96\". result_name Name result list entry containing model.Default \"result\". color_by One \"signatures\", \"annotation\", \"none\". \"signatures\", one UMAP scatterplot generated signature points colored level signature sample. annotation, single UMAP generated colored annotation selected using parameter annotation. \"none\", single UMAP scatterplot generated coloring. Default \"signature\". proportional TRUE, exposures normalized 0 1 dividing total number counts sample. Default TRUE. annotation Sample annotation used color points. One used color_by = \"annotation\". Default NULL. point_size Scatter plot point size. Default 0.7. same_scale TRUE, points share color scale signature subplot. FALSE, signature subplot colored different scale different maximum values. used color_by = \"signature\". Setting FALSE useful maximum value various signatures vastly different one another. Default TRUE. add_annotation_labels TRUE, labels group annotation variable displayed. used color_by = \"annotation\". recommended annotation continuous variable. label plotting using centriod group within annotation variable. Default FALSE. annotation_label_size Size annotation labels. used color_by = \"annotation\" add_annotation_labels = TRUE. Default 3. annotation_text_box Place white box around annotation labels improve readability. used color_by = \"annotation\" add_annotation_labels = TRUE. Default TRUE. plotly TRUE, plot made interactive using plotly. used color_by = \"signature\" same_scale = FALSE. Default FALSE. clust Add cluster labels annotation legend Plot legend strip_axes Remove axes labels cleaner looking plots","code":""},{"path":"https://www.camplab.net/musicatk/reference/plot_umap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a UMAP from a musica result — plot_umap","text":"Generates ggplot plotly object","code":""},{"path":[]},{"path":"https://www.camplab.net/musicatk/reference/plot_umap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot a UMAP from a musica result — plot_umap","text":"","code":"data(res_annot) create_umap(res_annot, \"res_annot\") #> The parameter 'n_neighbors' cannot be bigger than the total number of samples. Setting 'n_neighbors' to 7. plot_umap(res_annot, \"res_annot\", color_by = \"none\")"},{"path":"https://www.camplab.net/musicatk/reference/predict_exposure.html","id":null,"dir":"Reference","previous_headings":"","what":"Prediction of exposures in new samples using pre-existing signatures — predict_exposure","title":"Prediction of exposures in new samples using pre-existing signatures — predict_exposure","text":"Exposures samples predicted using existing set signatures stored result_model object. Algorithms available prediction include modify version \"lda\", \"decompTumor2Sig\".","code":""},{"path":"https://www.camplab.net/musicatk/reference/predict_exposure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prediction of exposures in new samples using pre-existing signatures — predict_exposure","text":"","code":"predict_exposure(   musica,   modality,   signature_res,   algorithm = c(\"lda\", \"decompTumor2Sig\"),   result_name = \"result\",   model_id = NULL,   signatures_to_use = seq_len(ncol(signatures(signature_res))),   verbose = FALSE,   make_copy = FALSE,   table_name = NULL )"},{"path":"https://www.camplab.net/musicatk/reference/predict_exposure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prediction of exposures in new samples using pre-existing signatures — predict_exposure","text":"musica musica object. modality Modality posterior prediction. Must match table type used generate prediction signatures signature_res Signatures used predict exposures samples musica object. Existing signatures need stored result_model object. algorithm Algorithm use prediction exposures. One \"lda\" \"decompTumor2Sig\". result_name Name result_list entry save results . Default \"result\". model_id Identifier result. NULL, automatically set algorithm number signatures. Default NULL. signatures_to_use signatures signature_res result object use. Default use signatures. verbose TRUE, progress printing. used algorithm = \"lda\". Default FALSE. make_copy FALSE, inputted musica object updated nothing returned. TRUE, new musica object created returned. Default FALSE. table_name Use modality instead","code":""},{"path":"https://www.camplab.net/musicatk/reference/predict_exposure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prediction of exposures in new samples using pre-existing signatures — predict_exposure","text":"Returns nothing new musica object, depending make_copy parameter.","code":""},{"path":"https://www.camplab.net/musicatk/reference/predict_exposure.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prediction of exposures in new samples using pre-existing signatures — predict_exposure","text":"","code":"data(musica) data(cosmic_v2_sigs) g <- select_genome(\"19\") build_standard_table(musica, g, \"SBS96\", overwrite = TRUE) #> Building count table from SBS with SBS96 schema #> Warning: Overwriting counts table: SBS96 result <- predict_exposure(   musica = musica, modality = \"SBS96\",   signature_res = cosmic_v2_sigs, algorithm = \"lda\" )  # Predict using LDA-like algorithm with seed set to 1 set.seed(1) predict_exposure(   musica = musica, modality = \"SBS96\",   signature_res = cosmic_v2_sigs, algorithm = \"lda\" ) #> model_id lda30_exp_pred already exists. model_id updated to lda30_exp_pred.1"},{"path":"https://www.camplab.net/musicatk/reference/rc.html","id":null,"dir":"Reference","previous_headings":"","what":"Reverse complement of a string using biostrings — rc","title":"Reverse complement of a string using biostrings — rc","text":"Reverse complement string using biostrings","code":""},{"path":"https://www.camplab.net/musicatk/reference/rc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reverse complement of a string using biostrings — rc","text":"","code":"rc(dna)"},{"path":"https://www.camplab.net/musicatk/reference/rc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reverse complement of a string using biostrings — rc","text":"dna Input DNA string","code":""},{"path":"https://www.camplab.net/musicatk/reference/rc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reverse complement of a string using biostrings — rc","text":"Returns reverse compliment input DNA string","code":""},{"path":"https://www.camplab.net/musicatk/reference/rc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reverse complement of a string using biostrings — rc","text":"","code":"rc(\"ATGC\") #> [1] \"GCAT\""},{"path":"https://www.camplab.net/musicatk/reference/rep_range.html","id":null,"dir":"Reference","previous_headings":"","what":"Replication Timing Data as GRanges Object — rep_range","title":"Replication Timing Data as GRanges Object — rep_range","text":"Supplementary data converted bigWig bedgraph GRanges, low RFD indicating leading strand high RFD indicating lagging strand removing uninformative zero RFD intervals. Timing data 10kb bins colon cancer sample.","code":""},{"path":"https://www.camplab.net/musicatk/reference/rep_range.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Replication Timing Data as GRanges Object — rep_range","text":"","code":"data(rep_range)"},{"path":"https://www.camplab.net/musicatk/reference/rep_range.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Replication Timing Data as GRanges Object — rep_range","text":"object class \"GRanges\"; see [annotate_replication_strand()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/rep_range.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Replication Timing Data as GRanges Object — rep_range","text":"GEO, <https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE134225>","code":""},{"path":"https://www.camplab.net/musicatk/reference/rep_range.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Replication Timing Data as GRanges Object — rep_range","text":"Sriramachandran, . M. et al. (2020) Genome-wide Nucleotide-Resolution Mapping DNA Replication Patterns, Single-Strand Breaks, Lesions GLOE-Seq. ([Molecular Cell] (doi:10.1016/j.molcel.2020.03.027))","code":""},{"path":"https://www.camplab.net/musicatk/reference/res.html","id":null,"dir":"Reference","previous_headings":"","what":"res — res","title":"res — res","text":"musica created testing includes SBS variants discovered exposures signatures","code":""},{"path":"https://www.camplab.net/musicatk/reference/res.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"res — res","text":"","code":"data(res)"},{"path":"https://www.camplab.net/musicatk/reference/res.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"res — res","text":"object class musica See [discover_signatures()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/res_annot.html","id":null,"dir":"Reference","previous_headings":"","what":"res_annot — res_annot","title":"res_annot — res_annot","text":"musica created testing includes SBS variants annotations discovered exposures signatures","code":""},{"path":"https://www.camplab.net/musicatk/reference/res_annot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"res_annot — res_annot","text":"","code":"data(res_annot)"},{"path":"https://www.camplab.net/musicatk/reference/res_annot.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"res_annot — res_annot","text":"object class musica See [discover_signatures()].","code":""},{"path":"https://www.camplab.net/musicatk/reference/result_collection-class.html","id":null,"dir":"Reference","previous_headings":"","what":"The Result Collection object that contains modality, input parameters, prior hyperparameters — result_collection-class","title":"The Result Collection object that contains modality, input parameters, prior hyperparameters — result_collection-class","text":"Result Collection object contains modality, input parameters, prior hyperparameters","code":""},{"path":"https://www.camplab.net/musicatk/reference/result_collection-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"The Result Collection object that contains modality, input parameters, prior hyperparameters — result_collection-class","text":"modality list contains model results different modality parameter list contains input parameters hyperparameter list contains prior tuning parameters","code":""},{"path":"https://www.camplab.net/musicatk/reference/result_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve result_list from a musica object — result_list","title":"Retrieve result_list from a musica object — result_list","text":"result_list contains results various runs","code":""},{"path":"https://www.camplab.net/musicatk/reference/result_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve result_list from a musica object — result_list","text":"","code":"result_list(object)  # S4 method for class 'musica' result_list(object)  result_list(musica) <- value  # S4 method for class 'musica,SimpleList' result_list(musica) <- value"},{"path":"https://www.camplab.net/musicatk/reference/result_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve result_list from a musica object — result_list","text":"object musica object generated create_musica_from_variants create_musica_from_counts function. musica musica object generated create_musica_from_variants create_musica_from_counts function value list results","code":""},{"path":"https://www.camplab.net/musicatk/reference/result_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve result_list from a musica object — result_list","text":"list results","code":""},{"path":"https://www.camplab.net/musicatk/reference/result_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve result_list from a musica object — result_list","text":"","code":"data(res) result_list(res) #> List of length 1 #> names(1): result"},{"path":"https://www.camplab.net/musicatk/reference/result_model-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Object that contains results for a single model — result_model-class","title":"Object that contains results for a single model — result_model-class","text":"Object contains results single model","code":""},{"path":"https://www.camplab.net/musicatk/reference/result_model-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Object that contains results for a single model — result_model-class","text":"signatures matrix signatures mutational motifs exposures matrix samples signature weights num_signatures Number signatures model other_parameters Parameters relevant model credible_intervals Credible intervals parameters metrics Performance metrics model umap List umap data.frames plotting analysis model_id Model identifier modality Modality result (SBS96, DBS78, IND83)","code":""},{"path":"https://www.camplab.net/musicatk/reference/samp_annot.html","id":null,"dir":"Reference","previous_headings":"","what":"Get or set sample annotations from a musica object — samp_annot","title":"Get or set sample annotations from a musica object — samp_annot","text":"Sample annotations can used store information sample tumor type treatment status. used downstream plotting functions plot_exposures plot_umap group color samples particular annotation.","code":""},{"path":"https://www.camplab.net/musicatk/reference/samp_annot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get or set sample annotations from a musica object — samp_annot","text":"","code":"samp_annot(object)  # S4 method for class 'musica' samp_annot(object)  samp_annot(object, name) <- value  # S4 method for class 'musica,character,vector' samp_annot(object, name) <- value"},{"path":"https://www.camplab.net/musicatk/reference/samp_annot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get or set sample annotations from a musica object — samp_annot","text":"object musica object generated create_musica_from_variants create_musica_from_counts function. name name new annotation add. value vector containing new sample annotations. Needs length number samples object.","code":""},{"path":"https://www.camplab.net/musicatk/reference/samp_annot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get or set sample annotations from a musica object — samp_annot","text":"new object sample annotations added table sample_annotations slot.","code":""},{"path":[]},{"path":"https://www.camplab.net/musicatk/reference/samp_annot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get or set sample annotations from a musica object — samp_annot","text":"","code":"data(res_annot) samp_annot(res_annot) #>                        Samples Tumor_Subtypes #> 1 TCGA-94-7557-01A-11D-2122-08           Lung #> 2 TCGA-56-7582-01A-11D-2042-08           Lung #> 3 TCGA-77-7335-01A-11D-2042-08           Lung #> 4 TCGA-97-7938-01A-11D-2167-08           Lung #> 5 TCGA-EE-A3J5-06A-11D-A20D-08         Breast #> 6 TCGA-ER-A197-06A-32D-A197-08         Breast #> 7 TCGA-ER-A19O-06A-11D-A197-08         Breast  # Add new annotation samp_annot(res_annot, \"New_Annotation\") <- rep(c(\"A\", \"B\"), c(3, 4)) samp_annot(res_annot) #>                        Samples Tumor_Subtypes New_Annotation #> 1 TCGA-94-7557-01A-11D-2122-08           Lung              A #> 2 TCGA-56-7582-01A-11D-2042-08           Lung              A #> 3 TCGA-77-7335-01A-11D-2042-08           Lung              A #> 4 TCGA-97-7938-01A-11D-2167-08           Lung              B #> 5 TCGA-EE-A3J5-06A-11D-A20D-08         Breast              B #> 6 TCGA-ER-A197-06A-32D-A197-08         Breast              B #> 7 TCGA-ER-A19O-06A-11D-A197-08         Breast              B data(musica) samp_annot(musica, \"example\") <- rep(\"ex\", 7)"},{"path":"https://www.camplab.net/musicatk/reference/sample_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve sample names from a musica object — sample_names","title":"Retrieve sample names from a musica object — sample_names","text":"Sample names included sample column variant object passed create_musica_from_variants, colnames count table object passed create_musica_from_counts. returns unique list samples names order inside musica object.","code":""},{"path":"https://www.camplab.net/musicatk/reference/sample_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve sample names from a musica object — sample_names","text":"","code":"sample_names(object)  # S4 method for class 'musica' sample_names(object)"},{"path":"https://www.camplab.net/musicatk/reference/sample_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve sample names from a musica object — sample_names","text":"object musica object generated create_musica_from_variants create_musica_from_counts function.","code":""},{"path":"https://www.camplab.net/musicatk/reference/sample_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve sample names from a musica object — sample_names","text":"character vector sample names","code":""},{"path":"https://www.camplab.net/musicatk/reference/sample_names.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve sample names from a musica object — sample_names","text":"","code":"data(res) sample_names(res) #> [1] TCGA-56-7582-01A-11D-2042-08 TCGA-77-7335-01A-11D-2042-08 #> [3] TCGA-94-7557-01A-11D-2122-08 TCGA-97-7938-01A-11D-2167-08 #> [5] TCGA-EE-A3J5-06A-11D-A20D-08 TCGA-ER-A197-06A-32D-A197-08 #> [7] TCGA-ER-A19O-06A-11D-A197-08 #> 7 Levels: TCGA-56-7582-01A-11D-2042-08 ... TCGA-ER-A19O-06A-11D-A197-08"},{"path":"https://www.camplab.net/musicatk/reference/select_genome.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to load common human or mouse genomes — select_genome","title":"Helper function to load common human or mouse genomes — select_genome","text":"Helper function load common human mouse genomes","code":""},{"path":"https://www.camplab.net/musicatk/reference/select_genome.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to load common human or mouse genomes — select_genome","text":"","code":"select_genome(x)"},{"path":"https://www.camplab.net/musicatk/reference/select_genome.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to load common human or mouse genomes — select_genome","text":"x Select hg19 hg38 human genome mm9 mm10 mouse genome UCSC format","code":""},{"path":"https://www.camplab.net/musicatk/reference/select_genome.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function to load common human or mouse genomes — select_genome","text":"Returns BSgenome given version","code":""},{"path":"https://www.camplab.net/musicatk/reference/select_genome.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Helper function to load common human or mouse genomes — select_genome","text":"","code":"g <- select_genome(x = \"hg38\")"},{"path":"https://www.camplab.net/musicatk/reference/signatures.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve signatures from a result_model, result_collection, or musica object — signatures","title":"Retrieve signatures from a result_model, result_collection, or musica object — signatures","text":"signatures matrix contains probability mutation motif sample. Rows correspond motif columns correspond signature.","code":""},{"path":"https://www.camplab.net/musicatk/reference/signatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve signatures from a result_model, result_collection, or musica object — signatures","text":"","code":"signatures(x, ...)  # S4 method for class 'musica' signatures(x, result, modality, model_id)  # S4 method for class 'result_collection' signatures(x, modality, model_id)  # S4 method for class 'result_model' signatures(x)  signatures(x, ...) <- value  # S4 method for class 'musica,matrix' signatures(x, result, modality, model_id) <- value  # S4 method for class 'result_collection,matrix' signatures(x, modality, model_id) <- value  # S4 method for class 'result_model,matrix' signatures(x) <- value"},{"path":"https://www.camplab.net/musicatk/reference/signatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve signatures from a result_model, result_collection, or musica object — signatures","text":"x musica, result_collection, result_model object generated mutational discovery prediction tool. ... inputs result Name result result_list assign signatures. Used result musica object. modality Modality assign signatures. Used result musica result_collection object. model_id Model identifier assign signatures. Used result musica result_collection object. value matrix motifs counts samples","code":""},{"path":"https://www.camplab.net/musicatk/reference/signatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve signatures from a result_model, result_collection, or musica object — signatures","text":"matrix mutational signatures","code":""},{"path":"https://www.camplab.net/musicatk/reference/signatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve signatures from a result_model, result_collection, or musica object — signatures","text":"","code":"data(res) signatures(res, \"result\", \"SBS96\", \"res\") #>           Signature1   Signature2   Signature3 #> C>A_ACA 8.666532e-04 2.613711e-02 4.448169e-14 #> C>A_ACC 1.222204e-02 1.367763e-02 3.861026e-17 #> C>A_ACG 8.228520e-03 7.525241e-07 1.181972e-34 #> C>A_ACT 6.922897e-03 1.046267e-02 4.705594e-16 #> C>A_CCA 2.268506e-02 2.627552e-02 5.342028e-03 #> C>A_CCC 3.453916e-02 1.326883e-02 8.573563e-19 #> C>A_CCG 3.017375e-02 4.968338e-12 4.942740e-34 #> C>A_CCT 2.347529e-02 7.349768e-03 7.630364e-34 #> C>A_GCA 1.767337e-02 3.157788e-02 5.691025e-03 #> C>A_GCC 1.424257e-02 1.748020e-02 1.014869e-34 #> C>A_GCG 1.285337e-64 1.203912e-02 9.483122e-67 #> C>A_GCT 8.555769e-03 1.168081e-02 1.683258e-17 #> C>A_TCA 2.488531e-02 1.182221e-02 3.015327e-13 #> C>A_TCC 2.466496e-02 1.507377e-02 4.714786e-34 #> C>A_TCG 1.126220e-02 8.711230e-03 1.727722e-33 #> C>A_TCT 2.454132e-02 1.520943e-02 4.301613e-17 #> C>G_ACA 3.720076e-44 3.720076e-44 3.720076e-44 #> C>G_ACC 2.595663e-05 1.502043e-02 5.342027e-03 #> C>G_ACG 2.038874e-03 6.792227e-03 1.193386e-33 #> C>G_ACT 2.742966e-03 1.119504e-07 1.264509e-34 #> C>G_CCA 9.639451e-03 1.049176e-02 1.171358e-33 #> C>G_CCC 1.371533e-02 1.498665e-08 2.995019e-16 #> C>G_CCG 4.105876e-64 6.019562e-03 5.360183e-66 #> C>G_CCT 4.107476e-03 7.532273e-03 1.634147e-34 #> C>G_GCA 1.891476e-03 1.297352e-02 1.814603e-33 #> C>G_GCC 3.726155e-04 1.163028e-02 3.489254e-35 #> C>G_GCG 8.229101e-03 1.150110e-07 3.013128e-13 #> C>G_GCT 1.097217e-02 1.085797e-07 1.720778e-13 #> C>G_TCA 7.467141e-02 2.040074e-02 1.606676e-13 #> C>G_TCC 3.057653e-02 5.577622e-03 2.153462e-12 #> C>G_TCG 1.097205e-02 2.506732e-07 5.295908e-34 #> C>G_TCT 7.448028e-02 1.760067e-02 8.285057e-13 #> C>T_ACA 6.403196e-03 2.307202e-02 1.793321e-35 #> C>T_ACC 3.020069e-03 1.670874e-02 1.254062e-02 #> C>T_ACG 1.491455e-02 3.459969e-02 5.700336e-03 #> C>T_ACT 6.830307e-03 7.554477e-03 4.916733e-15 #> C>T_CCA 2.419367e-02 3.456344e-02 6.248236e-02 #> C>T_CCC 2.118356e-02 1.286786e-02 1.335619e-01 #> C>T_CCG 2.102095e-02 5.086909e-02 2.903630e-02 #> C>T_CCT 6.045208e-03 3.811245e-02 8.084269e-02 #> C>T_GCA 1.574014e-03 3.439032e-02 3.551824e-15 #> C>T_GCC 1.777753e-02 2.723358e-02 2.922491e-02 #> C>T_GCG 2.774451e-02 2.034235e-02 6.019646e-03 #> C>T_GCT 4.098337e-04 3.431291e-02 7.746617e-03 #> C>T_TCA 3.189400e-02 3.519934e-02 9.443587e-02 #> C>T_TCC 2.449972e-02 2.107020e-02 2.354123e-01 #> C>T_TCG 2.219426e-02 3.989305e-02 1.049950e-01 #> C>T_TCT 4.067045e-02 2.032979e-02 3.963147e-02 #> T>A_ATA 2.373571e-03 4.050712e-04 6.268995e-07 #> T>A_ATC 4.600210e-03 3.981849e-03 5.342031e-03 #> T>A_ATG 5.030936e-03 1.253859e-02 4.563086e-26 #> T>A_ATT 5.486136e-03 3.009781e-03 5.342034e-03 #> T>A_CTA 9.013459e-03 5.159054e-03 4.092394e-33 #> T>A_CTC 1.097227e-02 1.058355e-09 3.709747e-10 #> T>A_CTG 2.386812e-02 9.928521e-03 5.342028e-03 #> T>A_CTT 5.172173e-04 1.749118e-02 8.753248e-34 #> T>A_GTA 1.483420e-73 6.598148e-70 1.068406e-02 #> T>A_GTC 2.743066e-03 3.026769e-09 3.172478e-35 #> T>A_GTG 5.485563e-03 6.290277e-07 5.342033e-03 #> T>A_GTT 8.953417e-04 1.406651e-02 7.645306e-15 #> T>A_TTA 7.830455e-03 1.726050e-08 6.118554e-03 #> T>A_TTC 3.825787e-65 3.009781e-03 4.022010e-67 #> T>A_TTG 8.229205e-03 2.408105e-13 4.092867e-33 #> T>A_TTT 1.097650e-04 5.899124e-03 5.342033e-03 #> T>C_ATA 1.369925e-02 1.766050e-05 5.069676e-10 #> T>C_ATC 5.486137e-03 3.762914e-62 5.342032e-03 #> T>C_ATG 8.925114e-03 2.632446e-02 7.800215e-16 #> T>C_ATT 2.433390e-03 9.728480e-03 1.538829e-02 #> T>C_CTA 4.600669e-03 3.981344e-03 2.719501e-34 #> T>C_CTC 2.561366e-06 9.026533e-03 2.172342e-35 #> T>C_CTG 1.378588e-02 1.196173e-02 2.980716e-14 #> T>C_CTT 2.722357e-65 6.019562e-03 4.772865e-67 #> T>C_GTA 1.096049e-02 1.292396e-05 8.337786e-10 #> T>C_GTC 1.097207e-02 2.201382e-07 5.033614e-10 #> T>C_GTG 7.807325e-03 2.401830e-05 6.121000e-03 #> T>C_GTT 4.598791e-03 3.983399e-03 2.136814e-02 #> T>C_TTA 1.877293e-05 1.152941e-02 6.210160e-03 #> T>C_TTC 2.666685e-04 1.744657e-02 5.909145e-03 #> T>C_TTG 3.362178e-03 7.928723e-03 6.089818e-03 #> T>C_TTT 7.719903e-05 5.934856e-03 1.068407e-02 #> T>G_ATA 5.485846e-03 3.193990e-07 4.766222e-34 #> T>G_ATC 2.742837e-03 2.539378e-07 5.342032e-03 #> T>G_ATG 2.209459e-71 1.284586e-67 5.342032e-03 #> T>G_ATT 6.715116e-03 4.671088e-03 1.217154e-33 #> T>G_CTA 2.206821e-79 7.231800e-78 5.342032e-03 #> T>G_CTC 6.752989e-03 7.639313e-03 8.133268e-15 #> T>G_CTG 2.742934e-03 1.470164e-07 5.342033e-03 #> T>G_CTT 5.485469e-03 7.326000e-07 3.062070e-34 #> T>G_GTA 1.855451e-04 5.815976e-03 2.779645e-34 #> T>G_GTC 3.720076e-44 3.720076e-44 3.720076e-44 #> T>G_GTG 5.486137e-03 1.452622e-12 6.501419e-35 #> T>G_GTT 2.497966e-65 3.009781e-03 1.177083e-67 #> T>G_TTA 1.975414e-65 3.009781e-03 2.176097e-67 #> T>G_TTC 3.720076e-44 3.720076e-44 3.720076e-44 #> T>G_TTG 8.141805e-03 9.589828e-05 1.232222e-12 #> T>G_TTT 2.359148e-03 4.208018e-04 7.955750e-07 data(res) signatures(res, \"result\", \"SBS96\", \"res\") <- matrix()"},{"path":"https://www.camplab.net/musicatk/reference/subset_musica_by_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"Creates a new musica object subsetted to only one value of a sample annotation — subset_musica_by_annotation","title":"Creates a new musica object subsetted to only one value of a sample annotation — subset_musica_by_annotation","text":"Creates new musica object subsetted one value sample annotation","code":""},{"path":"https://www.camplab.net/musicatk/reference/subset_musica_by_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creates a new musica object subsetted to only one value of a sample annotation — subset_musica_by_annotation","text":"","code":"subset_musica_by_annotation(musica, annot_col, annot_names)"},{"path":"https://www.camplab.net/musicatk/reference/subset_musica_by_annotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creates a new musica object subsetted to only one value of a sample annotation — subset_musica_by_annotation","text":"musica musica object. annot_col Annotation class use subsetting annot_names Annotational value subset ","code":""},{"path":"https://www.camplab.net/musicatk/reference/subset_musica_by_annotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Creates a new musica object subsetted to only one value of a sample annotation — subset_musica_by_annotation","text":"Returns new musica object sample annotations, count tables, variants subsetted contains samples specified annotation type","code":""},{"path":"https://www.camplab.net/musicatk/reference/subset_musica_by_annotation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Creates a new musica object subsetted to only one value of a sample annotation — subset_musica_by_annotation","text":"","code":"data(musica_sbs96) annot <- read.table(system.file(\"extdata\", \"sample_annotations.txt\",   package = \"musicatk\" ), sep = \"\\t\", header = TRUE)  samp_annot(musica_sbs96, \"Tumor_Subtypes\") <- annot$Tumor_Subtypes  musica_sbs96 <- subset_musica_by_annotation(   musica_sbs96, \"Tumor_Subtypes\",   \"Lung\" )"},{"path":"https://www.camplab.net/musicatk/reference/subset_musica_by_counts.html","id":null,"dir":"Reference","previous_headings":"","what":"Creates a new musica subsetted to only samples with enough variants — subset_musica_by_counts","title":"Creates a new musica subsetted to only samples with enough variants — subset_musica_by_counts","text":"Creates new musica subsetted samples enough variants","code":""},{"path":"https://www.camplab.net/musicatk/reference/subset_musica_by_counts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creates a new musica subsetted to only samples with enough variants — subset_musica_by_counts","text":"","code":"subset_musica_by_counts(musica, table_name, num_counts)"},{"path":"https://www.camplab.net/musicatk/reference/subset_musica_by_counts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creates a new musica subsetted to only samples with enough variants — subset_musica_by_counts","text":"musica musica object. table_name Name table used subsetting num_counts Minimum sum count value drop samples","code":""},{"path":"https://www.camplab.net/musicatk/reference/subset_musica_by_counts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Creates a new musica subsetted to only samples with enough variants — subset_musica_by_counts","text":"Returns new musica object sample annotations, count tables, variants subsetted contains samples specified minimum number counts (column sums) specified table","code":""},{"path":"https://www.camplab.net/musicatk/reference/subset_musica_by_counts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Creates a new musica subsetted to only samples with enough variants — subset_musica_by_counts","text":"","code":"data(musica_sbs96) subset_musica_by_counts(musica_sbs96, \"SBS96\", 20) #> An object of class \"musica\" #> Slot \"variants\": #>         chr     start       end    ref    alt                       sample #>      <fctr>     <num>     <num> <char> <char>                       <fctr> #>   1:   chr1  11020563  11020563      C      A TCGA-94-7557-01A-11D-2122-08 #>   2:   chr1  43430030  43430030      G      T TCGA-94-7557-01A-11D-2122-08 #>   3:   chr1  58682403  58682403      A      G TCGA-94-7557-01A-11D-2122-08 #>   4:   chr1 109508295 109508295      C      G TCGA-94-7557-01A-11D-2122-08 #>   5:   chr1 156384826 156384826      A      C TCGA-94-7557-01A-11D-2122-08 #>  ---                                                                       #> 869:  chr19  54885292  54885292      G      A TCGA-ER-A19O-06A-11D-A197-08 #> 870:  chr20  49374328  49374328      A      T TCGA-ER-A19O-06A-11D-A197-08 #> 871:   chrX  73213768  73213768      T      G TCGA-ER-A19O-06A-11D-A197-08 #> 872:   chrX 101292834 101292834      G      A TCGA-ER-A19O-06A-11D-A197-08 #> 873:   chrX 107526690 107526690      C      T TCGA-ER-A19O-06A-11D-A197-08 #>      Variant_Type #>            <char> #>   1:          SBS #>   2:          SBS #>   3:          SBS #>   4:          SBS #>   5:          SBS #>  ---              #> 869:          SBS #> 870:          SBS #> 871:          SBS #> 872:          SBS #> 873:          SBS #>  #> Slot \"count_tables\": #> $SBS96 #> Count_Table:  SBS96  #> Motifs: 96  #> Samples: 6  #>   #> **Annotations:  #>            motif mutation context #> C>A_ACA C>A_ACA      C>A     ACA #> C>A_ACC C>A_ACC      C>A     ACC #> C>A_ACG C>A_ACG      C>A     ACG #> C>A_ACT C>A_ACT      C>A     ACT #> C>A_CCA C>A_CCA      C>A     CCA #> C>A_CCC C>A_CCC      C>A     CCC #> 7           ...      ...     ...  #>  #> **Features:  #>    mutation #> 1  C>A_TCA #> 2  C>A_ACT #> 3  T>C_ATT #> 4  C>G_TCT #> 5  T>G_CTC #> 6  C>G_CCC #> 7      ...  #>  #> **Types:  #>  SBS #>   #> **Color Variable:  #>  mutation #>   #> **Color Mapping:  #>  #5ABCEBFF #>  #050708FF #>  #D33C32FF #>  #CBCACBFF #>  #ABCD72FF #>  #E7C9C6FF #>   #> **Descriptions:  #>  Single Base Substitution table with one base upstream and downstream #>  #>  #> Slot \"sample_annotations\": #> data frame with 0 columns and 0 rows #>  #> Slot \"result_list\": #> List of length 0 #>"},{"path":"https://www.camplab.net/musicatk/reference/subset_variant_by_type.html","id":null,"dir":"Reference","previous_headings":"","what":"Subsets a variant table based on Variant Type — subset_variant_by_type","title":"Subsets a variant table based on Variant Type — subset_variant_by_type","text":"Subsets variant table based Variant Type","code":""},{"path":"https://www.camplab.net/musicatk/reference/subset_variant_by_type.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subsets a variant table based on Variant Type — subset_variant_by_type","text":"","code":"subset_variant_by_type(tab, type)"},{"path":"https://www.camplab.net/musicatk/reference/subset_variant_by_type.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subsets a variant table based on Variant Type — subset_variant_by_type","text":"tab Input variant table type Variant type return e.g. \"SBS\", \"INS\", \"DEL\", \"DBS\"","code":""},{"path":"https://www.camplab.net/musicatk/reference/subset_variant_by_type.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subsets a variant table based on Variant Type — subset_variant_by_type","text":"Returns input variant table subsetted contain variants specified variant type","code":""},{"path":"https://www.camplab.net/musicatk/reference/subset_variant_by_type.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subsets a variant table based on Variant Type — subset_variant_by_type","text":"","code":"data(musica) annotate_variant_type(musica) subset_variant_by_type(variants(musica), \"SBS\") #>         chr     start       end    ref    alt                       sample #>      <fctr>     <num>     <num> <char> <char>                       <fctr> #>   1:   chr1  11020563  11020563      C      A TCGA-94-7557-01A-11D-2122-08 #>   2:   chr1  43430030  43430030      G      T TCGA-94-7557-01A-11D-2122-08 #>   3:   chr1  58682403  58682403      A      G TCGA-94-7557-01A-11D-2122-08 #>   4:   chr1 109508295 109508295      C      G TCGA-94-7557-01A-11D-2122-08 #>   5:   chr1 156384826 156384826      A      C TCGA-94-7557-01A-11D-2122-08 #>  ---                                                                       #> 880:  chr19  54885292  54885292      G      A TCGA-ER-A19O-06A-11D-A197-08 #> 881:  chr20  49374328  49374328      A      T TCGA-ER-A19O-06A-11D-A197-08 #> 882:   chrX  73213768  73213768      T      G TCGA-ER-A19O-06A-11D-A197-08 #> 883:   chrX 101292834 101292834      G      A TCGA-ER-A19O-06A-11D-A197-08 #> 884:   chrX 107526690 107526690      C      T TCGA-ER-A19O-06A-11D-A197-08 #>      Variant_Type #>            <char> #>   1:          SBS #>   2:          SBS #>   3:          SBS #>   4:          SBS #>   5:          SBS #>  ---              #> 880:          SBS #> 881:          SBS #> 882:          SBS #> 883:          SBS #> 884:          SBS"},{"path":"https://www.camplab.net/musicatk/reference/subset_variants_by_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Return sample from musica_variant object — subset_variants_by_samples","title":"Return sample from musica_variant object — subset_variants_by_samples","text":"Return sample musica_variant object","code":""},{"path":"https://www.camplab.net/musicatk/reference/subset_variants_by_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return sample from musica_variant object — subset_variants_by_samples","text":"","code":"subset_variants_by_samples(musica, sample_name)"},{"path":"https://www.camplab.net/musicatk/reference/subset_variants_by_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return sample from musica_variant object — subset_variants_by_samples","text":"musica musica object. sample_name Sample name subset ","code":""},{"path":"https://www.camplab.net/musicatk/reference/subset_variants_by_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return sample from musica_variant object — subset_variants_by_samples","text":"Returns sample data.frame subset single sample","code":""},{"path":"https://www.camplab.net/musicatk/reference/subset_variants_by_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return sample from musica_variant object — subset_variants_by_samples","text":"","code":"data(musica) subset_variants_by_samples(musica, \"TCGA-94-7557-01A-11D-2122-08\") #>         chr     start       end    ref    alt                       sample #>      <fctr>     <num>     <num> <char> <char>                       <fctr> #>   1:   chr1  11020563  11020563      C      A TCGA-94-7557-01A-11D-2122-08 #>   2:   chr1  43430030  43430030      G      T TCGA-94-7557-01A-11D-2122-08 #>   3:   chr1  58682403  58682403      A      G TCGA-94-7557-01A-11D-2122-08 #>   4:   chr1 109508295 109508295      C      G TCGA-94-7557-01A-11D-2122-08 #>   5:   chr1 156384826 156384826      A      C TCGA-94-7557-01A-11D-2122-08 #>  ---                                                                       #> 116:  chr19  54255365  54255365      G      A TCGA-94-7557-01A-11D-2122-08 #> 117:  chr20  49028576  49028576      C      T TCGA-94-7557-01A-11D-2122-08 #> 118:  chr21  25881519  25881519      C      G TCGA-94-7557-01A-11D-2122-08 #> 119:   chrX  12886189  12886189      A      G TCGA-94-7557-01A-11D-2122-08 #> 120:   chrX 153950810 153950810      C      T TCGA-94-7557-01A-11D-2122-08 #>      Variant_Type #>            <char> #>   1:          SBS #>   2:          SBS #>   3:          SBS #>   4:          SBS #>   5:          SBS #>  ---              #> 116:          SBS #> 117:          SBS #> 118:          SBS #> 119:          SBS #> 120:          SBS"},{"path":"https://www.camplab.net/musicatk/reference/table_96.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates a 96 motif table based on input counts for plotting — table_96","title":"Generates a 96 motif table based on input counts for plotting — table_96","text":"Generates 96 motif table based input counts plotting","code":""},{"path":"https://www.camplab.net/musicatk/reference/table_96.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates a 96 motif table based on input counts for plotting — table_96","text":"","code":"table_96(sample_df)"},{"path":"https://www.camplab.net/musicatk/reference/table_96.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates a 96 motif table based on input counts for plotting — table_96","text":"sample_df Input counts table","code":""},{"path":"https://www.camplab.net/musicatk/reference/table_96.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generates a 96 motif table based on input counts for plotting — table_96","text":"Returns 96 motif summary table","code":""},{"path":"https://www.camplab.net/musicatk/reference/table_selected.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve table name used for plotting from a result_model object — table_selected","title":"Retrieve table name used for plotting from a result_model object — table_selected","text":"table name","code":""},{"path":"https://www.camplab.net/musicatk/reference/table_selected.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve table name used for plotting from a result_model object — table_selected","text":"","code":"table_selected(result)  # S4 method for class 'result_model' table_selected(result)"},{"path":"https://www.camplab.net/musicatk/reference/table_selected.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve table name used for plotting from a result_model object — table_selected","text":"result result_model object generated mutational discovery prediction tool.","code":""},{"path":"https://www.camplab.net/musicatk/reference/table_selected.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve table name used for plotting from a result_model object — table_selected","text":"Table name used plotting","code":""},{"path":"https://www.camplab.net/musicatk/reference/table_selected.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve table name used for plotting from a result_model object — table_selected","text":"","code":"data(res) model <- get_model(res, \"result\", \"SBS96\", \"res\") table_selected(model) #> [1] \"SBS96\""},{"path":"https://www.camplab.net/musicatk/reference/tables.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve the list of count_tables from a musica object — tables","title":"Retrieve the list of count_tables from a musica object — tables","text":"count_tables contains standard /custom count tables created variants","code":""},{"path":"https://www.camplab.net/musicatk/reference/tables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve the list of count_tables from a musica object — tables","text":"","code":"tables(object)  # S4 method for class 'musica' tables(object)  tables(musica) <- value  # S4 method for class 'musica,list' tables(musica) <- value"},{"path":"https://www.camplab.net/musicatk/reference/tables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve the list of count_tables from a musica object — tables","text":"object musica object generated create_musica_from_variants create_musica_from_counts function. musica musica object generated create_musica_from_variants create_musica_from_counts function. value list count_table objects representing counts motifs samples","code":""},{"path":"https://www.camplab.net/musicatk/reference/tables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve the list of count_tables from a musica object — tables","text":"list count_tables","code":""},{"path":"https://www.camplab.net/musicatk/reference/tables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve the list of count_tables from a musica object — tables","text":"","code":"data(res) tables(res) #> $SBS96 #> Count_Table:  SBS96  #> Motifs: 96  #> Samples: 7  #>   #> **Annotations:  #>            motif mutation context #> C>A_ACA C>A_ACA      C>A     ACA #> C>A_ACC C>A_ACC      C>A     ACC #> C>A_ACG C>A_ACG      C>A     ACG #> C>A_ACT C>A_ACT      C>A     ACT #> C>A_CCA C>A_CCA      C>A     CCA #> C>A_CCC C>A_CCC      C>A     CCC #> 7           ...      ...     ...  #>  #> **Features:  #>    mutation #> 1  C>A_TCA #> 2  C>A_ACT #> 3  T>C_ATT #> 4  C>G_TCT #> 5  T>G_CTC #> 6  C>G_CCC #> 7      ...  #>  #> **Types:  #>  SBS #>   #> **Color Variable:  #>  mutation #>   #> **Color Mapping:  #>  #5ABCEBFF #>  #050708FF #>  #D33C32FF #>  #CBCACBFF #>  #ABCD72FF #>  #E7C9C6FF #>   #> **Descriptions:  #>  Single Base Substitution table with one base upstream and downstream #>"},{"path":"https://www.camplab.net/musicatk/reference/umap.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve umap list from a result_model, result_collection, or musica object — umap","title":"Retrieve umap list from a result_model, result_collection, or musica object — umap","text":"umap dataframes model","code":""},{"path":"https://www.camplab.net/musicatk/reference/umap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve umap list from a result_model, result_collection, or musica object — umap","text":"","code":"umap(x, ...)  # S4 method for class 'musica' umap(x, result, modality, model_id)  # S4 method for class 'result_collection' umap(x, modality, model_id)  # S4 method for class 'result_model' umap(x)  umap(x, ...) <- value  # S4 method for class 'musica,matrix' umap(x, result, modality, model_id) <- value  # S4 method for class 'result_collection,matrix' umap(x, modality, model_id) <- value  # S4 method for class 'result_model,matrix' umap(x) <- value"},{"path":"https://www.camplab.net/musicatk/reference/umap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve umap list from a result_model, result_collection, or musica object — umap","text":"x musica, result_collection, result_model object generated mutational discovery prediction tool. ... inputs result Name result result_list assign umap. Used result musica object. modality Modality assign umap. Used result musica result_collection object. model_id Model identifier assign umap. Used result musica result_collection object. value list umap dataframes","code":""},{"path":"https://www.camplab.net/musicatk/reference/umap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve umap list from a result_model, result_collection, or musica object — umap","text":"list umap dataframes","code":""},{"path":"https://www.camplab.net/musicatk/reference/umap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve umap list from a result_model, result_collection, or musica object — umap","text":"","code":"data(res) umap(res, \"result\", \"SBS96\", \"res\") #> <0 x 0 matrix>"},{"path":"https://www.camplab.net/musicatk/reference/variants.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve variants from a musica object — variants","title":"Retrieve variants from a musica object — variants","text":"variants data.table contains variants variant-level annotations","code":""},{"path":"https://www.camplab.net/musicatk/reference/variants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve variants from a musica object — variants","text":"","code":"variants(object)  # S4 method for class 'musica' variants(object)  variants(musica) <- value  # S4 method for class 'musica,data.table' variants(musica) <- value"},{"path":"https://www.camplab.net/musicatk/reference/variants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve variants from a musica object — variants","text":"object musica object generated create_musica_from_variants create_musica_from_counts function. musica musica object generated create_musica_from_variants create_musica_from_counts function value data.table mutational variants variant-level annotations","code":""},{"path":"https://www.camplab.net/musicatk/reference/variants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve variants from a musica object — variants","text":"data.table variants","code":""},{"path":"https://www.camplab.net/musicatk/reference/variants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve variants from a musica object — variants","text":"","code":"data(res) variants(res) #>         chr     start       end    ref    alt                       sample #>      <fctr>     <num>     <num> <char> <char>                       <fctr> #>   1:   chr1  11020563  11020563      C      A TCGA-94-7557-01A-11D-2122-08 #>   2:   chr1  43430030  43430030      G      T TCGA-94-7557-01A-11D-2122-08 #>   3:   chr1  58682403  58682403      A      G TCGA-94-7557-01A-11D-2122-08 #>   4:   chr1 109508295 109508295      C      G TCGA-94-7557-01A-11D-2122-08 #>   5:   chr1 156384826 156384826      A      C TCGA-94-7557-01A-11D-2122-08 #>  ---                                                                       #> 880:  chr19  54885292  54885292      G      A TCGA-ER-A19O-06A-11D-A197-08 #> 881:  chr20  49374328  49374328      A      T TCGA-ER-A19O-06A-11D-A197-08 #> 882:   chrX  73213768  73213768      T      G TCGA-ER-A19O-06A-11D-A197-08 #> 883:   chrX 101292834 101292834      G      A TCGA-ER-A19O-06A-11D-A197-08 #> 884:   chrX 107526690 107526690      C      T TCGA-ER-A19O-06A-11D-A197-08 #>      Variant_Type #>            <char> #>   1:          SBS #>   2:          SBS #>   3:          SBS #>   4:          SBS #>   5:          SBS #>  ---              #> 880:          SBS #> 881:          SBS #> 882:          SBS #> 883:          SBS #> 884:          SBS"},{"path":"https://www.camplab.net/musicatk/news/index.html","id":"musicatk-200-2023-10-30","dir":"Changelog","previous_headings":"","what":"musicatk 2.0.0 (2023-10-30)","title":"musicatk 2.0.0 (2023-10-30)","text":"Restructure musica class contain mutational signature discovery prediction results, thus eliminating need musica_result class. Added new functionality help determine correct number signatures predict (k-value). Musica objects can created variants directly count tables.","code":""},{"path":"https://www.camplab.net/musicatk/news/index.html","id":"musicatk-1141-2024-07-13","dir":"Changelog","previous_headings":"","what":"musicatk 1.14.1 (2024-07-13)","title":"musicatk 1.14.1 (2024-07-13)","text":"Removed deconstructSigs","code":""},{"path":"https://www.camplab.net/musicatk/news/index.html","id":"musicatk-1140-2024-05-03","dir":"Changelog","previous_headings":"","what":"musicatk 1.14.0 (2024-05-03)","title":"musicatk 1.14.0 (2024-05-03)","text":"Updated version number match Bioconductor Fixed minor bugs dependencies","code":""},{"path":"https://www.camplab.net/musicatk/news/index.html","id":"musicatk-1100-2023-10-16","dir":"Changelog","previous_headings":"","what":"musicatk 1.10.0 (2023-10-16)","title":"musicatk 1.10.0 (2023-10-16)","text":"Updated version number match Bioconductor","code":""},{"path":"https://www.camplab.net/musicatk/news/index.html","id":"musicatk-180-2023-04-11","dir":"Changelog","previous_headings":"","what":"musicatk 1.8.0 (2023-04-11)","title":"musicatk 1.8.0 (2023-04-11)","text":"Updated version number match Bioconductor","code":""},{"path":"https://www.camplab.net/musicatk/news/index.html","id":"musicatk-131-2021-10-10","dir":"Changelog","previous_headings":"","what":"musicatk 1.3.1 (2021-10-10)","title":"musicatk 1.3.1 (2021-10-10)","text":"Updated version number match Bioconductor","code":""},{"path":"https://www.camplab.net/musicatk/news/index.html","id":"musicatk-121-2021-08-08","dir":"Changelog","previous_headings":"","what":"musicatk 1.2.1 (2021-08-08)","title":"musicatk 1.2.1 (2021-08-08)","text":"Fixed bug fonts plots Added documentation site generated pkgdown Added Shiny UI interactive analysis mutational signatures","code":""},{"path":"https://www.camplab.net/musicatk/news/index.html","id":"musicatk-120-2021-08-08","dir":"Changelog","previous_headings":"","what":"musicatk 1.2.0 (2021-08-08)","title":"musicatk 1.2.0 (2021-08-08)","text":"Generated new release Bioconductor 3.13","code":""},{"path":"https://www.camplab.net/musicatk/news/index.html","id":"musicatk-112-2021-02-03","dir":"Changelog","previous_headings":"","what":"musicatk 1.1.2 (2021-02-03)","title":"musicatk 1.1.2 (2021-02-03)","text":"Added new functionality analysis including clustering sample exposures using variety methods (e.g. k-means), differential exposure using variety methods (e.g., Wilcoxon rank-sum, Kruskal Wallis, GLM), heatmap creation. Fixed bug causing incorrect counting mutations creation indel tables.","code":""}]
