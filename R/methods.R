#' @title Retrieve musica from a musica_result object
#' @description  The \code{\linkS4class{musica}} musica contains variants,
#' count tables, and sample annotations
#' @param result A \code{\linkS4class{musica_result}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname get_musica
#' @return A \code{\linkS4class{musica}} musica object
#' @export
#' @examples
#' data(res)
#' get_musica(res)
setGeneric(
  name = "get_musica",
  def = function(result)
  {
    standardGeneric("get_musica")
  }
)

#' @rdname get_musica
setMethod(
  f = "get_musica",
  signature = "musica_result",
  definition = function(result) {
    return(result@musica)
  }
)

#' @title Retrieve table name used for plotting from a musica_result object
#' @description  The table name
#' @param result A \code{\linkS4class{musica_result}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname table_selected
#' @return Table name used for plotting
#' @export
#' @examples
#' data(res)
#' table_selected(res)
setGeneric(
  name = "table_selected",
  def = function(result)
  {
    standardGeneric("table_selected")
  }
)

#' @rdname table_selected
setMethod(
  f = "table_selected",
  signature = "musica_result",
  definition = function(result) {
    return(result@table_name)
  }
)

#' @title Retrieve exposures from a musica_result object
#' @description  The \code{exposure} matrix contains estimated amount of
#' each signature for each sample. Rows correspond to each signature and
#' columns correspond to each sample.
#' @param result A \code{\linkS4class{musica_result}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname exposures
#' @return A matrix of exposures
#' @export
#' @examples
#' data(res)
#' exposures(res)
setGeneric(
  name = "exposures",
  def = function(result)
  {
    standardGeneric("exposures")
  }
)

#' @rdname exposures
setMethod(
  f = "exposures",
  signature = "musica_result",
  definition = function(result) {
    return(result@exposures)
  }
)

#' @rdname exposures
#' @param result A \code{\linkS4class{musica_result}} object generated by
#' a mutational discovery or prediction tool.
#' @param value A matrix of samples by signature exposures
#' @export
#' @examples
#' data(res)
#' exposures(res) <- matrix()
setGeneric(
  name = "exposures<-",
  def = function(result, value)
  {
    standardGeneric("exposures<-")
  }
)

#' @rdname exposures
setReplaceMethod(
  f = "exposures",
  signature = c("musica_result", "matrix"),
  definition = function(result, value)
  {
    result@exposures <- value
    return(result)
  }
) 

#' @title Retrieve signatures from a musica_result object
#' @description  The \code{signature} matrix contains the probability of
#' mutation motif in each sample. Rows correspond to each motif and
#' columns correspond to each signature.
#' @param result A \code{\linkS4class{musica_result}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname signatures
#' @return A matrix of mutational signatures
#' @export
#' @examples
#' data(res)
#' signatures(res)
setGeneric(
  name = "signatures",
  def = function(result)
  {
    standardGeneric("signatures")
  }
)

#' @rdname signatures
setMethod(
  f = "signatures",
  signature = "musica_result",
  definition = function(result) {
    return(result@signatures)
  }
)

#' @rdname signatures
#' @param result A \code{\linkS4class{musica_result}} object generated by
#' a mutational discovery or prediction tool.
#' @param value A matrix of motifs counts by samples
#' @export
#' @examples
#' data(res)
#' signatures(res) <- matrix()
setGeneric(
  name = "signatures<-",
  def = function(result, value)
  {
    standardGeneric("signatures<-")
  }
)

#' @rdname signatures
setReplaceMethod(
  f = "signatures",
  signature = c("musica_result", "matrix"),
  definition = function(result, value)
  {
    result@signatures <- value
    return(result)
  }
) 

#' @title Retrieve umap list from a musica_result object
#' @description  The \code{signature} matrix contains the probability of
#' mutation motif in each sample. Rows correspond to each motif and
#' columns correspond to each signature.
#' @param result A \code{\linkS4class{musica_result}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname umap
#' @return A list of umap dataframes
#' @export
#' @examples
#' data(res)
#' umap(res)
setGeneric(
  name = "umap",
  def = function(result)
  {
    standardGeneric("umap")
  }
)

#' @rdname umap
setMethod(
  f = "umap",
  signature = "musica_result",
  definition = function(result) {
    return(result@umap)
  }
)

#' @rdname umap
#' @param result A \code{\linkS4class{musica_result}} object generated by
#' a mutational discovery or prediction tool.
#' @param value A list of umap dataframes
#' @export
#' @examples
#' data(res)
#' umap(res) <- matrix()
setGeneric(
  name = "umap<-",
  def = function(result, value)
  {
    standardGeneric("umap<-")
  }
)

#' @rdname umap
setReplaceMethod(
  f = "umap",
  signature = c("musica_result", "matrix"),
  definition = function(result, value)
  {
    result@umap <- value
    return(result)
  }
) 

#' @title Retrieve variants from a musica or musica_result object
#' @description The \code{variants} \code{data.table} contains the variants
#' and variant-level annotations
#' @param object A \code{\linkS4class{musica}} object generated by
#' the \link{create_musica_from_variants} or \link{create_musica_from_counts} function,
#' or a \code{\linkS4class{musica_result}}
#' object generated by a mutational discovery or prediction tool.
#' @rdname variants
#' @return A data.table of variants
#' @export
#' @examples
#' data(res)
#' variants(res)
setGeneric(
  name = "variants",
  def = function(object)
  {
    standardGeneric("variants")
  }
)

#' @rdname variants
setMethod(
  f = "variants",
  signature = "musica",
  definition = function(object) {
    return(object@variants)
  }
)

#' @rdname variants
setMethod(
  f = "variants",
  signature = "musica_result",
  definition = function(object) {
    return(object@musica@variants)
  }
)

#' @rdname variants
#' @param musica A \code{\linkS4class{musica}} object generated by
#' the \link{create_musica_from_variants} or \link{create_musica_from_counts} function
#' @param value A \code{\linkS4class{data.table}} of mutational variants and
#' variant-level annotations
#' @export
#' @examples
#' data(musica)
#' variants(musica)
setGeneric(
  name = "variants<-",
  def = function(musica, value)
  {
    standardGeneric("variants<-")
  }
)

#' @rdname variants
setReplaceMethod(
  f = "variants",
  signature = c("musica", "data.table"),
  definition = function(musica, value)
  {
    musica@variants <- value
    return(musica)
  }
) 

#' @title Retrieve the list of count_tables from a musica or musica_result
#' object
#' @description The \code{count_tables} contains standard and/or custom
#' count tables created from variants
#' @param object A \code{\linkS4class{musica}} object generated by
#' the \link{create_musica_from_variants} or \link{create_musica_from_counts} function,
#' or a \code{\linkS4class{musica_result}}
#' object generated by a mutational discovery or prediction tool.
#' @rdname tables
#' @return A list of count_tables
#' @export
#' @examples
#' data(res)
#' tables(res)
setGeneric(
  name = "tables",
  def = function(object)
  {
    standardGeneric("tables")
  }
)

#' @rdname tables
setMethod(
  f = "tables",
  signature = "musica",
  definition = function(object) {
    return(object@count_tables)
  }
)

#' @rdname tables
setMethod(
  f = "tables",
  signature = "musica_result",
  definition = function(object) {
    return(object@musica@count_tables)
  }
)

#' @rdname tables
#' @param musica A \code{\linkS4class{musica}} object generated by
#' the \link{create_musica_from_variants} or \link{create_musica_from_counts} function,
#' or a \code{\linkS4class{musica_result}}
#' object generated by a mutational discovery or prediction tool.
#' @param value A list of \code{\linkS4class{count_table}} objects representing
#' counts of motifs in samples
#' @examples
#' data(musica)
#' tables(musica)
#' @export
setGeneric(
  name = "tables<-",
  def = function(musica, value)
  {
    standardGeneric("tables<-")
  }
)

#' @rdname tables
setReplaceMethod(
  f = "tables",
  signature = c("musica", "list"),
  definition = function(musica, value)
  {
    if (length(value) > 0) {
      if(!all(unlist(lapply(value, is, "count_table")))) {
        stop("All objects in the list must be count tables.")
      }
    }
    musica@count_tables <- value
    return(musica)
  }
) 

#' @title Get or set sample annotations from a musica or musica_result object
#' @description  Sample annotations can be used to store information about
#' each sample such as tumor type or treatment status. These are used in
#' downstream plotting functions such as \code{\link{plot_exposures}} or
#' \code{\link{plot_umap}} to group or color samples by a particular annotation.
#' @param object A \code{\linkS4class{musica}} object generated by
#' the \link{create_musica_from_variants} or \link{create_musica_from_counts} function,
#' or a \code{\linkS4class{musica_result}}
#' object generated by a mutational discovery or prediction tool.
#' @param name The name of the new annotation to add.
#' @param value A vector containing the new sample annotations. Needs to be
#' the same length as the number of samples in the object.
#' @rdname samp_annot
#' @return A new object with the sample annotations added to the table in the
#' \code{sample_annotations} slot.
#' @seealso See \code{\link{sample_names}} to get a vector of sample names in
#' the \code{\linkS4class{musica}} or \code{\linkS4class{musica_result}} object.
#' @export
#' @examples
#' data(res_annot)
#' samp_annot(res_annot)
#' 
#' # Add new annotation
#' samp_annot(res_annot, "New_Annotation") <- rep(c("A", "B"), c(3, 4))
#' samp_annot(res_annot)
setGeneric(
  name = "samp_annot",
  def = function(object)
  {
    standardGeneric("samp_annot")
  }
)

#' @rdname samp_annot
setMethod(
  f = "samp_annot",
  signature = "musica",
  definition = function(object) {
    return(object@sample_annotations)
  }
)

#' @rdname samp_annot
setMethod(
  f = "samp_annot",
  signature = "musica_result",
  definition = function(object) {
    return(object@musica@sample_annotations)
  }
)

#' @rdname samp_annot
#' @examples
#' data(musica)
#' samp_annot(musica, "example") <- rep("ex", 7)
#' @export
setGeneric(
  name = "samp_annot<-",
  def = function(object, name, value)
  {
    standardGeneric("samp_annot<-")
  }
)

#' @rdname samp_annot
setReplaceMethod(
  f = "samp_annot",
  signature = c("musica", "character", "vector"),
  definition = function(object, name, value)
  {
    # Initialize sample annotations in musica object
    if(nrow(samp_annot(object)) == 0) {
      samples <- unique(object@variants$sample)
      sample_dt <- data.table::data.table(Samples = samples)
      object@sample_annotations <- sample_dt
    }
    
    if(length(name) != 1 || !is.character(name)) {
      stop("The 'name' parameter must be a character of length 1.")
    }
    if(length(value) != nrow(object@sample_annotations)) {
      stop("The new sample annotation vector in 'value' must have the ",
           "length as the number of samples in the 'musica' object. Number ",
           "of samples in 'musica' object: ", nrow(object@sample_annotations),
           ". Length of new sample annotation: ",
           length(value), ".")
    }
    object@sample_annotations[[name]] <- value
    return(object)
  }
)  

#' @rdname samp_annot
setReplaceMethod(
  f = "samp_annot",
  signature = c("musica_result", "character", "vector"),
  definition = function(object, name, value)
  {
    samp_annot(object@musica, name) <- value
    return(object)
  }
) 


#' @title Retrieve sample names from a musica or musica_result object
#' @description Sample names were included in the \code{sample} column
#' in the variant object passed to \code{\link{create_musica_from_variants}}, or in
#' the colnames of the count table object passed to
#' \code{\link{create_musica_from_counts}}. This returns
#' a unique list of samples names in the order they are inside the
#' \code{\linkS4class{musica}} object.
#' @param object A \code{\linkS4class{musica}} object generated by
#' the \link{create_musica_from_variants} or \link{create_musica_from_counts} function,
#' or a \code{\linkS4class{musica_result}}
#' object generated by a mutational discovery or prediction tool.
#' @rdname sample_names
#' @return A character vector of sample names
#' @export
#' @examples
#' data(res)
#' sample_names(res)
setGeneric(
  name = "sample_names",
  def = function(object)
  {
    standardGeneric("sample_names")
  }
)

#' @rdname sample_names
setMethod(
  f = "sample_names",
  signature = "musica",
  definition = function(object) {
    
    if(is.null(object@sample_annotations) ||
       nrow(object@sample_annotations) == 0 ||
       is.null(object@sample_annotations$Sample)) {
      s <- gtools::mixedsort(unique(object@variants$sample))
    } else {
      s <- object@sample_annotations$Sample
    }
    return(s)
  }
)

#' @rdname sample_names
setMethod(
  f = "sample_names",
  signature = "musica_result",
  definition = function(object) {
    return(sample_names(object@musica))
  }
)

################################################33

#' @title Retrieve the names of count_tables from a musica or musica_result
#' object
#' @description The \code{count_tables} contains standard and/or custom
#' count tables created from variants
#' @param object A \code{\linkS4class{musica}} object generated by
#' the \link{create_musica_from_variants} or \link{create_musica_from_counts} function,
#' or a \code{\linkS4class{musica_result}}
#' object generated by a mutational discovery or prediction tool.
#' @rdname built_tables
#' @return The names of created count_tables
#' @export
#' @examples
#' data(res)
#' built_tables(res)
setGeneric(
  name = "built_tables",
  def = function(object)
  {
    standardGeneric("built_tables")
  }
)

#' @rdname built_tables
setMethod(
  f = "built_tables",
  signature = "musica",
  definition = function(object) {
    return(names(object@count_tables))
  }
)

#' @rdname built_tables
setMethod(
  f = "built_tables",
  signature = "musica_result",
  definition = function(object) {
    return(names(object@musica@count_tables))
  }
)

################################################

#' @title Retrieve ground_truth musica_result object from a full_benchmark object
#' @description  The \code{ground_truth} musica_result object contains true
#' signatures and exposures for the benchmarking analysis.
#' @param result A \code{\linkS4class{full_benchmark}} object generated by
#' the \link{create_benchmark} function.
#' @rdname ground_truth
#' @return A \code{\linkS4class{musica_result}} object with the ground truth
#' signatures and exposures
#' @export
setGeneric(
  name = "ground_truth",
  def = function(result)
  {
    standardGeneric("ground_truth")
  }
)

#' @rdname ground_truth
setMethod(
  f = "ground_truth",
  signature = "full_benchmark",
  definition = function(result) {
    return(result@ground_truth)
  }
)

#' @rdname ground_truth
#' @param result A \code{\linkS4class{full_benchmark}} object generated by
#' the \link{create_benchmark} function.
#' @param value A \code{\linkS4class{musica_result}} object with the ground truth
#' signatures and exposures
#' @export
setGeneric(
  name = "ground_truth<-",
  def = function(result, value)
  {
    standardGeneric("ground_truth<-")
  }
)

#' @rdname ground_truth
setReplaceMethod(
  f = "ground_truth",
  signature = c("full_benchmark", "musica_result"),
  definition = function(result, value)
  {
    result@ground_truth <- value
    return(result)
  }
) 

#' @title Retrieve method_view_summary matrix from a full_benchmark object
#' @description  The \code{method_view_summary} matrix contains a summary of all
#' the individual benchmarks completed in the analysis.
#' @param result A \code{\linkS4class{full_benchmark}} object generated by
#' the \link{create_benchmark} function.
#' @rdname method_view_summary
#' @return A matrix containing the summary of all individual benchmarks
#' @export
setGeneric(
  name = "method_view_summary",
  def = function(result)
  {
    standardGeneric("method_view_summary")
  }
)

#' @rdname method_view_summary
setMethod(
  f = "method_view_summary",
  signature = "full_benchmark",
  definition = function(result) {
    return(result@method_view_summary)
  }
)

#' @rdname method_view_summary
#' @param result A \code{\linkS4class{full_benchmark}} object generated by
#' the \link{create_benchmark} function.
#' @param value A matrix containing summary information for all individual
#' benchmarks run in the analysis
#' @export
setGeneric(
  name = "method_view_summary<-",
  def = function(result, value)
  {
    standardGeneric("method_view_summary<-")
  }
)

#' @rdname method_view_summary
setReplaceMethod(
  f = "method_view_summary",
  signature = c("full_benchmark", "matrix"),
  definition = function(result, value)
  {
    result@method_view_summary <- value
    return(result)
  }
)

#' @title Retrieve sig_view_summary matrix from a full_benchmark object
#' @description  The \code{sig_view_summary} matrix contains a summary of all
#' the individual benchmarks completed in the analysis, organized by signature
#' @param result A \code{\linkS4class{full_benchmark}} object generated by
#' the \link{create_benchmark} function.
#' @rdname sig_view_summary
#' @return A matrix containing the summary of all individual benchmarks,
#' organized by signature
#' @export
setGeneric(
  name = "sig_view_summary",
  def = function(result)
  {
    standardGeneric("sig_view_summary")
  }
)

#' @rdname sig_view_summary
setMethod(
  f = "sig_view_summary",
  signature = "full_benchmark",
  definition = function(result) {
    return(result@sig_view_summary)
  }
)

#' @rdname sig_view_summary
#' @param result A \code{\linkS4class{full_benchmark}} object generated by
#' the \link{create_benchmark} function.
#' @param value A matrix containing summary information for all individual
#' benchmarks run in the analysis, organized by signature
#' @export
setGeneric(
  name = "sig_view_summary<-",
  def = function(result, value)
  {
    standardGeneric("sig_view_summary<-")
  }
)

#' @rdname sig_view_summary
setReplaceMethod(
  f = "sig_view_summary",
  signature = c("full_benchmark", "matrix"),
  definition = function(result, value)
  {
    result@sig_view_summary <- value
    return(result)
  }
)

#' @title Retrieve indv_benchmarks list from a full_benchmark object
#' @description  The \code{indv_benchmarks} list contains
#' \code{\linkS4class{single_benchmark}} objects that each contain the benchmarking
#' information from a single benchmark run.
#' @param result A \code{\linkS4class{full_benchmark}} object generated by
#' the \link{create_benchmark} function.
#' @rdname indv_benchmarks
#' @return A list of \code{\linkS4class{single_benchmark}} objects
#' @export
setGeneric(
  name = "indv_benchmarks",
  def = function(result)
  {
    standardGeneric("indv_benchmarks")
  }
)

#' @rdname indv_benchmarks
setMethod(
  f = "indv_benchmarks",
  signature = "full_benchmark",
  definition = function(result) {
    return(result@indv_benchmarks)
  }
)

#' @rdname indv_benchmarks
#' @param result A \code{\linkS4class{full_benchmark}} object generated by
#' the \link{create_benchmark} function.
#' @param value A list of \code{\linkS4class{single_benchmark}} objects, each
#' containing information from a single benchmark run
#' @export
setGeneric(
  name = "indv_benchmarks<-",
  def = function(result, value)
  {
    standardGeneric("indv_benchmarks<-")
  }
)

#' @rdname indv_benchmarks
setReplaceMethod(
  f = "indv_benchmarks",
  signature = c("full_benchmark", "list"),
  definition = function(result, value)
  {
    result@indv_benchmarks <- value
    return(result)
  }
)

######################################

#' @title Retrieve the initial prediction from a single_benchmark object
#' @description  The \code{initial_pred} object is a
#' \code{\linkS4class{musica_result}} object containing the initial signature
#' and exposure predictions inputted for benchmarking
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @rdname initial_pred
#' @return A \code{\linkS4class{musica_result}} object containing the initial
#' predictions
#' @export
setGeneric(
  name = "initial_pred",
  def = function(result)
  {
    standardGeneric("initial_pred")
  }
)

#' @rdname initial_pred
setMethod(
  f = "initial_pred",
  signature = "single_benchmark",
  definition = function(result) {
    return(result@initial_pred)
  }
)

#' @rdname initial_pred
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @param value A \code{\linkS4class{musica_result}} object containing the
#' initial signature and exposure predictions 
#' @export
setGeneric(
  name = "initial_pred<-",
  def = function(result, value)
  {
    standardGeneric("initial_pred<-")
  }
)

#' @rdname initial_pred
setReplaceMethod(
  f = "initial_pred",
  signature = c("single_benchmark", "musica_result"),
  definition = function(result, value)
  {
    result@initial_pred <- value
    return(result)
  }
)

#' @title Retrieve the intermediate prediction from a single_benchmark object
#' @description  The \code{intermediate_pred} object is a
#' \code{\linkS4class{musica_result}} object containing the signature and
#' exposure predictions after duplicate signatures are adjusted but before
#' composite sigantures are adjusted
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @rdname intermediate_pred
#' @return A \code{\linkS4class{musica_result}} object containing the intermediate
#' predictions
#' @export
setGeneric(
  name = "intermediate_pred",
  def = function(result)
  {
    standardGeneric("intermediate_pred")
  }
)

#' @rdname intermediate_pred
setMethod(
  f = "intermediate_pred",
  signature = "single_benchmark",
  definition = function(result) {
    return(result@intermediate_pred)
  }
)

#' @rdname intermediate_pred
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @param value A \code{\linkS4class{musica_result}} object containing the
#' intermediate signature and exposure predictions 
#' @export
setGeneric(
  name = "intermediate_pred<-",
  def = function(result, value)
  {
    standardGeneric("intermediate_pred<-")
  }
)

#' @rdname intermediate_pred
setReplaceMethod(
  f = "intermediate_pred",
  signature = c("single_benchmark", "musica_result"),
  definition = function(result, value)
  {
    result@intermediate_pred <- value
    return(result)
  }
)

#' @title Retrieve the final prediction from a single_benchmark object
#' @description  The \code{final_pred} object is a
#' \code{\linkS4class{musica_result}} object containing the signature and
#' exposure predictions after benchmarking is complete
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @rdname final_pred
#' @return A \code{\linkS4class{musica_result}} object containing the final
#' predictions
#' @export
setGeneric(
  name = "final_pred",
  def = function(result)
  {
    standardGeneric("final_pred")
  }
)

#' @rdname final_pred
setMethod(
  f = "final_pred",
  signature = "single_benchmark",
  definition = function(result) {
    return(result@final_pred)
  }
)

#' @rdname final_pred
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @param value A \code{\linkS4class{musica_result}} object containing the
#' final signature and exposure predictions 
#' @export
setGeneric(
  name = "final_pred<-",
  def = function(result, value)
  {
    standardGeneric("final_pred<-")
  }
)

#' @rdname final_pred
setReplaceMethod(
  f = "final_pred",
  signature = c("single_benchmark", "musica_result"),
  definition = function(result, value)
  {
    result@final_pred <- value
    return(result)
  }
)

#' @title Retrieve the intial comparison data.frame from a single_benchmark object
#' @description  The \code{initial_comparison} data.frame contains the comparison
#' between the initial predicted signatures and the true signatures.
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @rdname initial_comparison
#' @return A data.frame object containing the initial comparison between predicted
#' and true signatures
#' @export
setGeneric(
  name = "initial_comparison",
  def = function(result)
  {
    standardGeneric("initial_comparison")
  }
)

#' @rdname initial_comparison
setMethod(
  f = "initial_comparison",
  signature = "single_benchmark",
  definition = function(result) {
    return(result@initial_comparison)
  }
)

#' @rdname initial_comparison
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @param value A data.frame containing the initial comparison between predicted
#' and true signatures, generated by the \link{benchmark_compare_results} function
#' @export
setGeneric(
  name = "initial_comparison<-",
  def = function(result, value)
  {
    standardGeneric("initial_comparison<-")
  }
)

#' @rdname initial_comparison
setReplaceMethod(
  f = "initial_comparison",
  signature = c("single_benchmark", "data.frame"),
  definition = function(result, value)
  {
    result@initial_comparison <- value
    return(result)
  }
)

#' @title Retrieve the initial comparison data.frame from a single_benchmark object
#' @description  The \code{intermediate_comparison} data.frame contains the comparison
#' between the predicted signatures and the true signatures after duplicate
#' signatures have been adjusted but before composite signatures have been
#' adjusted.
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @rdname intermediate_comparison
#' @return A data.frame object containing the intermediate comparison between
#' predicted and true signatures
#' @export
setGeneric(
  name = "intermediate_comparison",
  def = function(result)
  {
    standardGeneric("intermediate_comparison")
  }
)

#' @rdname intermediate_comparison
setMethod(
  f = "intermediate_comparison",
  signature = "single_benchmark",
  definition = function(result) {
    return(result@intermediate_comparison)
  }
)

#' @rdname intermediate_comparison
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @param value A data.frame containing the intermediate comparison between
#' predicted and true signatures, generated by the 
#' \link{benchmark_compare_results} function
#' @export
setGeneric(
  name = "intermediate_comparison<-",
  def = function(result, value)
  {
    standardGeneric("intermediate_comparison<-")
  }
)

#' @rdname intermediate_comparison
setReplaceMethod(
  f = "intermediate_comparison",
  signature = c("single_benchmark", "data.frame"),
  definition = function(result, value)
  {
    result@intermediate_comparison <- value
    return(result)
  }
)

#' @title Retrieve the final comparison data.frame from a single_benchmark object
#' @description  The \code{final_comparison} data.frame contains the comparison
#' between the predicted signatures and the true signatures after benchmarking
#' is complete.
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @rdname final_comparison
#' @return A data.frame object containing the final comparison between predicted
#' and true signatures
#' @export
setGeneric(
  name = "final_comparison",
  def = function(result)
  {
    standardGeneric("final_comparison")
  }
)

#' @rdname final_comparison
setMethod(
  f = "final_comparison",
  signature = "single_benchmark",
  definition = function(result) {
    return(result@final_comparison)
  }
)

#' @rdname final_comparison
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @param value A data.frame containing the final comparison between predicted
#' and true signatures, generated by the \link{benchmark_compare_results}
#' function
#' @export
setGeneric(
  name = "final_comparison<-",
  def = function(result, value)
  {
    standardGeneric("final_comparison<-")
  }
)

#' @rdname final_comparison
setReplaceMethod(
  f = "final_comparison",
  signature = c("single_benchmark", "data.frame"),
  definition = function(result, value)
  {
    result@final_comparison <- value
    return(result)
  }
)

#' @title Retrieve the method_id from a single_benchmark object
#' @description  The \code{method_id} is the identifier for a single
#' benchmark run.
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @rdname method_id
#' @return The identifier for the single benchmark run
#' @export
setGeneric(
  name = "method_id",
  def = function(result)
  {
    standardGeneric("method_id")
  }
)

#' @rdname method_id
setMethod(
  f = "method_id",
  signature = "single_benchmark",
  definition = function(result) {
    return(result@method_id)
  }
)

#' @rdname method_id
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @param value A character containing the identifier for the single benchmark
#' run
#' @export
setGeneric(
  name = "method_id<-",
  def = function(result, value)
  {
    standardGeneric("method_id<-")
  }
)

#' @rdname method_id
setReplaceMethod(
  f = "method_id",
  signature = c("single_benchmark", "character"),
  definition = function(result, value)
  {
    result@method_id <- value
    return(result)
  }
)

#' @title Retrieve the threshold from a single_benchmark object
#' @description  The \code{threshold} is the cosine similarity cutoff for
#' comparisons between predicted and true signatures
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @rdname threshold
#' @return The threshold for the single benchmark run
#' @export
setGeneric(
  name = "threshold",
  def = function(result)
  {
    standardGeneric("threshold")
  }
)

#' @rdname threshold
setMethod(
  f = "threshold",
  signature = "single_benchmark",
  definition = function(result) {
    return(result@threshold)
  }
)

#' @rdname threshold
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @param value The threshold for the single benchmark run
#' @export
setGeneric(
  name = "threshold<-",
  def = function(result, value)
  {
    standardGeneric("threshold<-")
  }
)

#' @rdname threshold
setReplaceMethod(
  f = "threshold",
  signature = c("single_benchmark", "numeric"),
  definition = function(result, value)
  {
    result@threshold <- value
    return(result)
  }
)

#' @title Retrieve the adjustment_threshold from a single_benchmark object
#' @description  The \code{adjustment_threshold} is the cosine similarity value
#' of high confidence. Comparisons that meet this cutoff are assumed to be likely,
#' while those that fall below the cutoff will be disregarded if the predicted
#' signature is already captured above the threshold.
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @rdname adjustment_threshold
#' @return The adjustment_threshold for the single benchmark run
#' @export
setGeneric(
  name = "adjustment_threshold",
  def = function(result)
  {
    standardGeneric("adjustment_threshold")
  }
)

#' @rdname adjustment_threshold
setMethod(
  f = "adjustment_threshold",
  signature = "single_benchmark",
  definition = function(result) {
    return(result@adjustment_threshold)
  }
)

#' @rdname adjustment_threshold
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @param value The adjustment_threshold for the single benchmark run
#' @export
setGeneric(
  name = "adjustment_threshold<-",
  def = function(result, value)
  {
    standardGeneric("adjustment_threshold<-")
  }
)

#' @rdname adjustment_threshold
setReplaceMethod(
  f = "adjustment_threshold",
  signature = c("single_benchmark", "numeric"),
  definition = function(result, value)
  {
    result@adjustment_threshold <- value
    return(result)
  }
)

#' @title Retrieve the description from a single_benchmark object
#' @description  The \code{description} contains details about the prediction
#' that is benchmarked.
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @rdname description
#' @return The description for the single benchmark run
#' @export
setGeneric(
  name = "description",
  def = function(result)
  {
    standardGeneric("description")
  }
)

#' @rdname description
setMethod(
  f = "description",
  signature = "single_benchmark",
  definition = function(result) {
    return(result@description)
  }
)

#' @rdname description
#' @param result A \code{\linkS4class{single_benchmark}} object extracted from
#' a \code{\linkS4class{full_benchmark}} object
#' @param value The description for the single benchmark run
#' @export
setGeneric(
  name = "description<-",
  def = function(result, value)
  {
    standardGeneric("description<-")
  }
)

#' @rdname description
setReplaceMethod(
  f = "description",
  signature = c("single_benchmark", "character"),
  definition = function(result, value)
  {
    result@description <- value
    return(result)
  }
)
